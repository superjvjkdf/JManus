{"version":3,"file":"index-Q43Dys17.js","sources":["../../src/components/chat/RecursiveSubPlan.vue","../../src/components/chat/ExecutionDetails.vue","../../src/components/chat/composables/useMessageFormatting.ts","../../src/api/common-api-service.ts","../../src/components/chat/UserInputForm.vue","../../src/components/chat/ResponseSection.vue","../../src/composables/usePlanExecution.ts","../../src/composables/useMessageDialog.ts","../../src/components/chat/composables/useScrollBehavior.ts","../../src/components/chat/ChatContainer.vue","../../src/api/file-upload-api-service.ts","../../src/components/file-upload/FileUploadComponent.vue","../../src/components/input/InputArea.vue","../../src/api/memory-api-service.ts","../../src/components/memory/Memory.vue","../../src/api/file-browser-api-service.ts","../../src/components/file-browser/FileTreeNode.vue","../../src/components/file-browser/index.vue","../../src/api/plan-parameter-api-service.ts","../../src/api/tool-api-service.ts","../../src/composables/useAvailableTools.ts","../../src/components/publish-service-modal/PublishServiceModal.vue","../../src/components/sidebar/SaveConfirmationDialog.vue","../../src/components/sidebar/ExecutionController.vue","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/bind.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/utils.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/AxiosError.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/null.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/toFormData.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/buildURL.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/InterceptorManager.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/defaults/transitional.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/FormData.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/classes/Blob.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/browser/index.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/common/utils.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/platform/index.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/toURLEncodedForm.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/formDataToJSON.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/defaults/index.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/parseHeaders.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/AxiosHeaders.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/transformData.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/cancel/isCancel.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/cancel/CanceledError.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/settle.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/parseProtocol.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/speedometer.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/throttle.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/progressEventReducer.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/isURLSameOrigin.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/cookies.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/isAbsoluteURL.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/combineURLs.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/buildFullPath.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/mergeConfig.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/resolveConfig.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/adapters/xhr.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/composeSignals.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/trackStream.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/adapters/fetch.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/adapters/adapters.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/dispatchRequest.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/env/data.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/validator.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/core/Axios.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/cancel/CancelToken.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/spread.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/isAxiosError.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/helpers/HttpStatusCode.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/lib/axios.js","../../node_modules/.pnpm/axios@1.13.2_debug@4.4.1/node_modules/axios/index.js","../../src/api/config-api-service.ts","../../src/components/shared/AssignedTools.vue","../../src/components/tool-selection-modal/ToolSelectionModal.vue","../../src/components/sidebar/JsonEditorV2.vue","../../src/api/agent-execution.ts","../../src/composables/useRightPanel.ts","../../src/components/right-panel/RightPanel.vue","../../src/components/sidebar/TemplateList.vue","../../src/components/sidebar/Sidebar.vue","../../src/composables/useConversationHistory.ts","../../src/views/direct/index.vue"],"sourcesContent":["<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"recursive-sub-plan\" :class=\"getNestingClass()\">\n    <!-- Sub-plan header -->\n    <div class=\"sub-plan-header\" @click=\"handleSubPlanClick\">\n      <div class=\"sub-plan-info\">\n        <Icon :icon=\"getSubPlanStatusIcon()\" class=\"sub-plan-status-icon\" />\n        <div class=\"sub-plan-details\">\n          <div class=\"sub-plan-title\">\n            {{ subPlan.title || $t('chat.subPlan') }} #{{ subPlanIndex + 1 }}\n            <span v-if=\"(nestingLevel ?? 0) > 0\" class=\"nesting-level\"\n              >(L{{ (nestingLevel ?? 0) + 1 }})</span\n            >\n          </div>\n          <div class=\"sub-plan-id\">{{ subPlan.currentPlanId }}</div>\n        </div>\n      </div>\n      <div class=\"sub-plan-meta\">\n        <div class=\"sub-plan-status-badge\" :class=\"getSubPlanStatusClass()\">\n          {{ getSubPlanStatusText() }}\n        </div>\n        <div v-if=\"subPlan.parentActToolCall\" class=\"trigger-tool\">\n          <Icon icon=\"carbon:function\" class=\"trigger-icon\" />\n          <span class=\"trigger-text\">{{ subPlan.parentActToolCall.name }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan progress -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-progress\">\n      <div class=\"progress-info\">\n        <span class=\"progress-text\">\n          {{ $t('chat.progress') }}: {{ getSubPlanCompletedCount() }} /\n          {{ subPlan.agentExecutionSequence.length }}\n        </span>\n        <div class=\"progress-bar\">\n          <div class=\"progress-fill\" :style=\"{ width: getSubPlanProgress() + '%' }\"></div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Sub-plan agent execution steps -->\n    <div v-if=\"subPlan.agentExecutionSequence?.length\" class=\"sub-plan-agents-steps\">\n      <div class=\"agents-steps-header\">\n        <span class=\"agents-label\">{{ $t('chat.agentExecutions') }}:</span>\n      </div>\n      <div class=\"agents-steps-list\">\n        <div\n          v-for=\"(agent, agentIndex) in subPlan.agentExecutionSequence\"\n          :key=\"agent.id || agentIndex\"\n          class=\"agent-step-item\"\n          :class=\"getAgentPreviewStatusClass(agent.status)\"\n          @click=\"handleSubPlanAgentClick(agentIndex, agent)\"\n        >\n          <div class=\"agent-step-header\">\n            <Icon :icon=\"getAgentPreviewStatusIcon(agent.status)\" class=\"agent-icon\" />\n            <span\n              class=\"agent-name\"\n              :title=\"\n                agent.agentName === 'ConfigurableDynaAgent'\n                  ? $t('chat.clickToViewExecutionDetails')\n                  : ''\n              \"\n            >\n              {{\n                agent.agentName === 'ConfigurableDynaAgent'\n                  ? $t('chat.funcAgentExecutionDetails')\n                  : agent.agentName || $t('chat.unknownAgent')\n              }}\n            </span>\n            <div class=\"agent-status-badge\" :class=\"getAgentPreviewStatusClass(agent.status)\">\n              {{ getAgentStatusText(agent.status) }}\n            </div>\n          </div>\n\n          <!-- Agent execution info for sub-plan agents -->\n          <div class=\"sub-agent-execution-info\">\n            <!-- Agent result -->\n            <div v-if=\"agent.result\" class=\"agent-result\">\n              <div class=\"result-header\">\n                <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n                <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n              </div>\n              <pre class=\"result-content\">{{ agent.result }}</pre>\n            </div>\n\n            <!-- Error message -->\n            <div v-if=\"agent.errorMessage\" class=\"agent-error\">\n              <div class=\"error-header\">\n                <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n                <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n              </div>\n              <pre class=\"error-content\">{{ agent.errorMessage }}</pre>\n            </div>\n\n            <!-- Think-act steps with nested sub-plans -->\n            <div v-if=\"agent.thinkActSteps?.length\" class=\"think-act-preview\">\n              <div class=\"think-act-header\">\n                <Icon icon=\"carbon:thinking\" class=\"think-act-icon\" />\n                <span class=\"think-act-label\"\n                  >{{ $t('chat.thinkActSteps') }} ({{ agent.thinkActSteps.length }})</span\n                >\n              </div>\n              <div class=\"think-act-steps-preview\">\n                <div\n                  v-for=\"(step, stepIndex) in agent.thinkActSteps.slice(0, maxVisibleSteps ?? 2)\"\n                  :key=\"step.id || stepIndex\"\n                  class=\"think-act-step-preview\"\n                  @click.stop=\"handleThinkActStepClick(agentIndex, stepIndex, agent)\"\n                >\n                  <span class=\"step-number\">#{{ stepIndex + 1 }}</span>\n                  <span class=\"step-description\">{{\n                    step.actionDescription || $t('chat.thinking')\n                  }}</span>\n                  <Icon icon=\"carbon:arrow-right\" class=\"step-arrow\" />\n                </div>\n                <div v-if=\"agent.thinkActSteps.length > (maxVisibleSteps ?? 2)\" class=\"more-steps\">\n                  <span class=\"more-steps-text\">\n                    {{\n                      $t('chat.andMoreSteps', {\n                        count: agent.thinkActSteps.length - (maxVisibleSteps ?? 2),\n                      })\n                    }}\n                  </span>\n                </div>\n              </div>\n            </div>\n\n            <!-- Nested sub-plans from think-act steps -->\n            <div v-if=\"hasNestedSubPlans(agent)\" class=\"nested-sub-plans\">\n              <div class=\"nested-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view-alt\" class=\"nested-icon\" />\n                <span class=\"nested-label\">{{ $t('chat.nestedSubPlans') }}</span>\n              </div>\n              <div class=\"nested-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(nestedStep, nestedStepIndex) in getNestedSubPlans(agent)\"\n                  :key=\"nestedStep.id || nestedStepIndex\"\n                  :sub-plan=\"nestedStep.subPlanExecutionRecord!\"\n                  :sub-plan-index=\"nestedStepIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n\n            <!-- Direct sub-plans from agent -->\n            <div v-if=\"agent.subPlanExecutionRecords?.length\" class=\"direct-sub-plans\">\n              <div class=\"direct-sub-plans-header\">\n                <Icon icon=\"carbon:tree-view\" class=\"direct-icon\" />\n                <span class=\"direct-label\">{{ $t('chat.directSubPlans') }}</span>\n              </div>\n              <div class=\"direct-sub-plans-list\">\n                <RecursiveSubPlan\n                  v-for=\"(directSubPlan, directIndex) in agent.subPlanExecutionRecords\"\n                  :key=\"directSubPlan.currentPlanId || directIndex\"\n                  :sub-plan=\"directSubPlan\"\n                  :sub-plan-index=\"directIndex\"\n                  :nesting-level=\"(nestingLevel ?? 0) + 1\"\n                  :max-nesting-depth=\"maxNestingDepth ?? 3\"\n                  :max-visible-steps=\"maxVisibleSteps ?? 2\"\n                  @sub-plan-selected=\"handleNestedSubPlanSelected\"\n                  @step-selected=\"handleNestedStepSelected\"\n                />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type {\n  AgentExecutionRecord,\n  ExecutionStatus,\n  PlanExecutionRecord,\n  ThinkActRecord,\n} from '@/types/plan-execution-record'\nimport { Icon } from '@iconify/vue'\nimport {} from 'vue'\nimport { useI18n } from 'vue-i18n'\n\ninterface Props {\n  subPlan: PlanExecutionRecord\n  subPlanIndex: number\n  nestingLevel?: number\n  maxNestingDepth?: number\n  maxVisibleSteps?: number\n}\n\ninterface Emits {\n  (\n    e: 'sub-plan-selected',\n    agentIndex: number,\n    subPlanIndex: number,\n    subPlan: PlanExecutionRecord\n  ): void\n  (e: 'step-selected', stepId: string): void\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  nestingLevel: 0,\n  maxNestingDepth: 3,\n  maxVisibleSteps: 2,\n})\n\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Helper functions\nconst getNestingClass = (): string => {\n  return `nesting-level-${props.nestingLevel}`\n}\n\n// Sub-plan status methods\nconst getSubPlanStatusClass = (): string => {\n  if (props.subPlan.completed) {\n    return 'completed'\n  }\n\n  const hasRunningAgent = props.subPlan.agentExecutionSequence?.some(\n    agent => agent.status === 'RUNNING'\n  )\n  if (hasRunningAgent) {\n    return 'running'\n  }\n\n  const hasFinishedAgent = props.subPlan.agentExecutionSequence?.some(\n    agent => agent.status === 'FINISHED'\n  )\n  if (hasFinishedAgent) {\n    return 'in-progress'\n  }\n\n  return 'pending'\n}\n\nconst getSubPlanStatusText = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return t('chat.status.completed')\n    case 'running':\n      return t('chat.status.executing')\n    case 'in-progress':\n      return t('chat.status.inProgress')\n    case 'pending':\n      return t('chat.status.pending')\n    default:\n      return t('chat.status.unknown')\n  }\n}\n\nconst getSubPlanStatusIcon = (): string => {\n  const statusClass = getSubPlanStatusClass()\n  switch (statusClass) {\n    case 'completed':\n      return 'carbon:checkmark'\n    case 'running':\n      return 'carbon:play'\n    case 'in-progress':\n      return 'carbon:in-progress'\n    case 'pending':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getSubPlanProgress = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  if (props.subPlan.completed) return 100\n\n  const completedCount = getSubPlanCompletedCount()\n  return Math.min(100, (completedCount / props.subPlan.agentExecutionSequence.length) * 100)\n}\n\nconst getSubPlanCompletedCount = (): number => {\n  if (!props.subPlan.agentExecutionSequence?.length) return 0\n  return props.subPlan.agentExecutionSequence.filter(agent => agent.status === 'FINISHED').length\n}\n\n// Agent preview status methods\nconst getAgentPreviewStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'completed'\n    case 'RUNNING':\n      return 'running'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentPreviewStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\n// Nested sub-plans detection\nconst hasNestedSubPlans = (agent: AgentExecutionRecord): boolean => {\n  return agent.thinkActSteps?.some(step => step.subPlanExecutionRecord) ?? false\n}\n\nconst getNestedSubPlans = (agent: AgentExecutionRecord): ThinkActRecord[] => {\n  return agent.thinkActSteps?.filter(step => step.subPlanExecutionRecord) ?? []\n}\n\n// Event handlers\nconst handleSubPlanClick = () => {\n  emit('sub-plan-selected', -1, props.subPlanIndex, props.subPlan)\n}\n\nconst handleSubPlanAgentClick = (agentIndex: number, agent: AgentExecutionRecord) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleThinkActStepClick = (\n  agentIndex: number,\n  _stepIndex: number,\n  agent: AgentExecutionRecord\n) => {\n  const stepId = agent.stepId ?? `subplan-${props.subPlanIndex}-agent-${agentIndex}`\n  emit('step-selected', stepId)\n}\n\nconst handleNestedSubPlanSelected = (\n  agentIndex: number,\n  subPlanIndex: number,\n  subPlan: PlanExecutionRecord\n) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleNestedStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.recursive-sub-plan {\n  background: rgba(102, 126, 234, 0.05);\n  border: 1px solid rgba(102, 126, 234, 0.1);\n  border-radius: 6px;\n  padding: 12px;\n  margin-bottom: 8px;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    border-color: rgba(102, 126, 234, 0.2);\n  }\n\n  &.running {\n    border-color: rgba(102, 126, 234, 0.3);\n    background: rgba(102, 126, 234, 0.08);\n    box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n  }\n\n  &.completed {\n    border-color: rgba(34, 197, 94, 0.3);\n    background: rgba(34, 197, 94, 0.05);\n  }\n\n  &.pending {\n    opacity: 0.7;\n  }\n\n  // Nesting level styles\n  &.nesting-level-1 {\n    margin-left: 16px;\n    border-left: 3px solid rgba(102, 126, 234, 0.3);\n  }\n\n  &.nesting-level-2 {\n    margin-left: 32px;\n    border-left: 3px solid rgba(251, 191, 36, 0.3);\n  }\n\n  &.nesting-level-3 {\n    margin-left: 48px;\n    border-left: 3px solid rgba(34, 197, 94, 0.3);\n  }\n\n  .sub-plan-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 8px;\n    cursor: pointer;\n\n    .sub-plan-info {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      flex: 1;\n\n      .sub-plan-status-icon {\n        font-size: 16px;\n\n        &.completed {\n          color: #22c55e;\n        }\n\n        &.running {\n          color: #667eea;\n        }\n\n        &.in-progress {\n          color: #fbbf24;\n        }\n\n        &.pending {\n          color: #9ca3af;\n        }\n      }\n\n      .sub-plan-details {\n        .sub-plan-title {\n          font-weight: 600;\n          color: #ffffff;\n          font-size: 13px;\n          margin-bottom: 2px;\n          display: flex;\n          align-items: center;\n          gap: 6px;\n\n          .nesting-level {\n            color: #888888;\n            font-size: 10px;\n            font-weight: 400;\n            background: rgba(136, 136, 136, 0.2);\n            padding: 1px 4px;\n            border-radius: 3px;\n          }\n        }\n\n        .sub-plan-id {\n          color: #aaaaaa;\n          font-size: 11px;\n          font-family: monospace;\n        }\n      }\n    }\n\n    .sub-plan-meta {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n\n      .trigger-tool {\n        display: flex;\n        align-items: center;\n        gap: 4px;\n        padding: 2px 6px;\n        background: rgba(102, 126, 234, 0.1);\n        border-radius: 4px;\n        font-size: 10px;\n\n        .trigger-icon {\n          font-size: 10px;\n          color: #667eea;\n        }\n\n        .trigger-text {\n          color: #cccccc;\n          font-weight: 500;\n        }\n      }\n    }\n\n    .sub-plan-status-badge {\n      padding: 2px 6px;\n      border-radius: 8px;\n      font-size: 10px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(34, 197, 94, 0.2);\n        color: #22c55e;\n      }\n\n      &.running {\n        background: rgba(102, 126, 234, 0.2);\n        color: #667eea;\n      }\n\n      &.in-progress {\n        background: rgba(251, 191, 36, 0.2);\n        color: #fbbf24;\n      }\n\n      &.pending {\n        background: rgba(156, 163, 175, 0.2);\n        color: #9ca3af;\n      }\n    }\n  }\n\n  .sub-plan-progress {\n    margin-bottom: 8px;\n\n    .progress-info {\n      .progress-text {\n        color: #aaaaaa;\n        font-size: 10px;\n        margin-bottom: 4px;\n      }\n\n      .progress-bar {\n        background: rgba(0, 0, 0, 0.2);\n        border-radius: 4px;\n        height: 4px;\n        overflow: hidden;\n\n        .progress-fill {\n          height: 100%;\n          background: linear-gradient(90deg, #667eea, #764ba2);\n          transition: width 0.3s ease;\n          border-radius: 4px;\n        }\n      }\n    }\n  }\n\n  .sub-plan-agents-steps {\n    .agents-steps-header {\n      color: #aaaaaa;\n      font-size: 11px;\n      margin-bottom: 6px;\n      font-weight: 500;\n    }\n\n    .agents-steps-list {\n      display: flex;\n      flex-direction: column;\n      gap: 8px;\n\n      .agent-step-item {\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 6px;\n        padding: 8px;\n        background: rgba(0, 0, 0, 0.05);\n        cursor: pointer;\n        transition: all 0.2s;\n\n        &:hover {\n          background: rgba(0, 0, 0, 0.1);\n          border-color: rgba(255, 255, 255, 0.2);\n        }\n\n        &.completed {\n          border-color: rgba(34, 197, 94, 0.3);\n          background: rgba(34, 197, 94, 0.05);\n        }\n\n        &.running {\n          border-color: rgba(102, 126, 234, 0.3);\n          background: rgba(102, 126, 234, 0.08);\n        }\n\n        &.pending {\n          opacity: 0.7;\n        }\n\n        .agent-step-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 8px;\n\n          .agent-icon {\n            font-size: 14px;\n\n            &.completed {\n              color: #22c55e;\n            }\n\n            &.running {\n              color: #667eea;\n            }\n\n            &.pending {\n              color: #9ca3af;\n            }\n          }\n\n          .agent-name {\n            color: #ffffff;\n            font-size: 13px;\n            font-weight: 500;\n            flex: 1;\n          }\n\n          .agent-status-badge {\n            padding: 2px 6px;\n            border-radius: 3px;\n            font-size: 10px;\n            font-weight: 500;\n\n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n\n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n\n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n        }\n\n        .sub-agent-execution-info {\n          margin-left: 22px;\n\n          .agent-result,\n          .agent-error {\n            margin-bottom: 8px;\n\n            &:last-child {\n              margin-bottom: 0;\n            }\n\n            .result-header,\n            .error-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 4px;\n\n              .result-icon,\n              .error-icon {\n                font-size: 12px;\n              }\n\n              .result-icon {\n                color: #22c55e;\n              }\n\n              .error-icon {\n                color: #ef4444;\n              }\n\n              .result-label,\n              .error-label {\n                color: #ffffff;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .result-content,\n            .error-content {\n              margin: 0;\n              padding: 6px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 3px;\n              font-family: monospace;\n              font-size: 10px;\n              white-space: pre-wrap;\n              max-height: 80px;\n              overflow-y: auto;\n              color: #cccccc;\n              line-height: 1.3;\n            }\n          }\n\n          .think-act-preview {\n            margin-top: 8px;\n\n            .think-act-header {\n              display: flex;\n              align-items: center;\n              gap: 4px;\n              margin-bottom: 6px;\n\n              .think-act-icon {\n                font-size: 12px;\n                color: #667eea;\n              }\n\n              .think-act-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .think-act-steps-preview {\n              display: flex;\n              flex-direction: column;\n              gap: 3px;\n\n              .think-act-step-preview {\n                display: flex;\n                align-items: center;\n                gap: 6px;\n                padding: 4px 6px;\n                background: rgba(0, 0, 0, 0.1);\n                border-radius: 3px;\n                cursor: pointer;\n                transition: all 0.2s;\n                font-size: 10px;\n\n                &:hover {\n                  background: rgba(0, 0, 0, 0.2);\n                }\n\n                .step-number {\n                  color: #667eea;\n                  font-weight: 500;\n                  min-width: 20px;\n                }\n\n                .step-description {\n                  color: #cccccc;\n                  flex: 1;\n                  white-space: nowrap;\n                  overflow: hidden;\n                  text-overflow: ellipsis;\n                }\n\n                .step-arrow {\n                  font-size: 10px;\n                  color: #888888;\n                }\n              }\n\n              .more-steps {\n                padding: 2px 6px;\n                color: #888888;\n                font-size: 9px;\n                font-style: italic;\n              }\n            }\n          }\n\n          .nested-sub-plans,\n          .direct-sub-plans {\n            margin-top: 12px;\n\n            .nested-sub-plans-header,\n            .direct-sub-plans-header {\n              display: flex;\n              align-items: center;\n              gap: 6px;\n              margin-bottom: 8px;\n\n              .nested-icon,\n              .direct-icon {\n                font-size: 12px;\n                color: #fbbf24;\n              }\n\n              .nested-label,\n              .direct-label {\n                color: #aaaaaa;\n                font-size: 11px;\n                font-weight: 500;\n              }\n            }\n\n            .nested-sub-plans-list,\n            .direct-sub-plans-list {\n              display: flex;\n              flex-direction: column;\n              gap: 6px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"execution-details\">\n    <!-- Plan overview -->\n    <div class=\"plan-overview\" v-if=\"planExecution\">\n      <!-- Parent tool call information for sub-plans -->\n      <div v-if=\"planExecution.parentActToolCall\" class=\"parent-tool-call\">\n        <div class=\"parent-tool-header\">\n          <Icon icon=\"carbon:flow\" class=\"tool-icon\" />\n          <span class=\"tool-label\">{{ $t('chat.triggeredByTool') }}:</span>\n          <span class=\"tool-name\">{{ planExecution.parentActToolCall.name }}</span>\n        </div>\n        <div v-if=\"planExecution.parentActToolCall.parameters\" class=\"tool-parameters\">\n          <span class=\"param-label\">{{ $t('common.parameters') }}:</span>\n          <pre class=\"param-content\">{{\n            formatToolParameters(planExecution.parentActToolCall.parameters)\n          }}</pre>\n        </div>\n      </div>\n    </div>\n\n    <!-- Agent execution sequence -->\n    <div\n      class=\"agent-execution-container\"\n      v-if=\"(planExecution?.agentExecutionSequence?.length ?? 0) > 0\"\n    >\n      <h4 class=\"section-title\">{{ $t('chat.agentExecutionSequence') }}</h4>\n\n      <div\n        v-for=\"(agentExecution, agentIndex) in planExecution?.agentExecutionSequence\"\n        :key=\"agentExecution.id || agentIndex\"\n        class=\"agent-execution-item\"\n        :class=\"getAgentStatusClass(agentExecution.status)\"\n      >\n        <!-- Agent execution header -->\n        <div class=\"agent-header\" @click=\"handleAgentClick(agentExecution)\">\n          <div class=\"agent-info\">\n            <Icon :icon=\"getAgentStatusIcon(agentExecution.status)\" class=\"agent-status-icon\" />\n            <div class=\"agent-details\">\n              <div\n                class=\"agent-name\"\n                :title=\"\n                  agentExecution.agentName === 'ConfigurableDynaAgent'\n                    ? $t('chat.clickToViewExecutionDetails')\n                    : ''\n                \"\n              >\n                {{\n                  agentExecution.agentName === 'ConfigurableDynaAgent'\n                    ? $t('chat.funcAgentExecutionDetails')\n                    : agentExecution.agentName || $t('chat.unknownAgent')\n                }}\n              </div>\n              <pre class=\"request-content\">{{ agentExecution.agentRequest }}</pre>\n            </div>\n          </div>\n          <div class=\"agent-controls\">\n            <div class=\"agent-status-badge\" :class=\"getAgentStatusClass(agentExecution.status)\">\n              {{ getAgentStatusText(agentExecution.status) }}\n            </div>\n            <Icon icon=\"carbon:arrow-right\" class=\"step-select-icon\" />\n          </div>\n        </div>\n\n        <!-- Agent execution info -->\n        <div class=\"agent-execution-info\">\n          <!-- Agent result -->\n          <div v-if=\"agentExecution.result\" class=\"agent-result\">\n            <div class=\"result-header\">\n              <Icon icon=\"carbon:checkmark\" class=\"result-icon\" />\n              <span class=\"result-label\">{{ $t('chat.agentResult') }}:</span>\n            </div>\n            <pre class=\"result-content\">{{ agentExecution.result }}</pre>\n          </div>\n\n          <!-- Error message -->\n          <div v-if=\"agentExecution.errorMessage\" class=\"agent-error\">\n            <div class=\"error-header\">\n              <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n              <span class=\"error-label\">{{ $t('chat.errorMessage') }}:</span>\n            </div>\n            <pre class=\"error-content\">{{ agentExecution.errorMessage }}</pre>\n          </div>\n        </div>\n\n        <!-- Sub-plan executions with nested support -->\n        <div v-if=\"agentExecution.subPlanExecutionRecords?.length\" class=\"sub-plans-container\">\n          <div class=\"sub-plans-header\">\n            <Icon icon=\"carbon:tree-view\" class=\"sub-plans-icon\" />\n            <span class=\"sub-plans-title\">\n              {{ $t('chat.subPlanExecutions') }} ({{\n                agentExecution.subPlanExecutionRecords.length\n              }})\n            </span>\n          </div>\n\n          <div class=\"sub-plans-list\">\n            <RecursiveSubPlan\n              v-for=\"(subPlan, subPlanIndex) in agentExecution.subPlanExecutionRecords\"\n              :key=\"subPlan.currentPlanId || subPlanIndex\"\n              :sub-plan=\"subPlan\"\n              :sub-plan-index=\"subPlanIndex\"\n              :nesting-level=\"0\"\n              :max-nesting-depth=\"3\"\n              :max-visible-steps=\"2\"\n              @sub-plan-selected=\"handleSubPlanClick\"\n              @step-selected=\"handleStepSelected\"\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { CompatiblePlanExecutionRecord } from '@/types/message-dialog'\nimport type {\n  AgentExecutionRecord,\n  ExecutionStatus,\n  PlanExecutionRecord,\n} from '@/types/plan-execution-record'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport RecursiveSubPlan from './RecursiveSubPlan.vue'\n\ninterface Props {\n  planExecution: CompatiblePlanExecutionRecord\n}\n\ninterface Emits {\n  (\n    e: 'sub-plan-selected',\n    agentIndex: number,\n    subPlanIndex: number,\n    subPlan: PlanExecutionRecord\n  ): void\n  (e: 'step-selected', stepId: string): void\n}\n\ndefineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nconst { t } = useI18n()\n\n// Agent click handler\nconst handleAgentClick = (agentExecution: AgentExecutionRecord) => {\n  if (agentExecution.stepId) {\n    emit('step-selected', agentExecution.stepId)\n  } else {\n    console.warn('[ExecutionDetails] Agent execution has no stepId:', agentExecution)\n  }\n}\n\n// Agent status methods\nconst getAgentStatusClass = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'running'\n    case 'FINISHED':\n      return 'completed'\n    case 'IDLE':\n    default:\n      return 'pending'\n  }\n}\n\nconst getAgentStatusText = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return t('chat.status.executing')\n    case 'FINISHED':\n      return t('chat.status.completed')\n    case 'IDLE':\n    default:\n      return t('chat.status.pending')\n  }\n}\n\nconst getAgentStatusIcon = (status?: ExecutionStatus): string => {\n  switch (status) {\n    case 'RUNNING':\n      return 'carbon:play'\n    case 'FINISHED':\n      return 'carbon:checkmark'\n    case 'IDLE':\n    default:\n      return 'carbon:dot-mark'\n  }\n}\n\n// Note: Sub-plan status methods are now handled by RecursiveSubPlan component\n\n// Note: Agent preview status methods are now handled by RecursiveSubPlan component\n\n// Event handlers\nconst handleSubPlanClick = (\n  agentIndex: number,\n  subPlanIndex: number,\n  subPlan: PlanExecutionRecord\n) => {\n  emit('sub-plan-selected', agentIndex, subPlanIndex, subPlan)\n}\n\nconst handleStepSelected = (stepId: string) => {\n  emit('step-selected', stepId)\n}\n\n// Note: Sub-plan agent and think-act step handling is now done by RecursiveSubPlan component\n\n// Helper methods\n\nconst formatToolParameters = (parameters?: string): string => {\n  if (!parameters) return ''\n\n  try {\n    const parsed = JSON.parse(parameters)\n    return JSON.stringify(parsed, null, 2)\n  } catch {\n    return parameters\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.execution-details {\n  // Plan overview\n  .plan-overview {\n    margin-bottom: 20px;\n\n    .parent-tool-call {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.2);\n      border-radius: 8px;\n      padding: 12px;\n\n      .parent-tool-header {\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        margin-bottom: 8px;\n\n        .tool-icon {\n          font-size: 16px;\n          color: #667eea;\n        }\n\n        .tool-label {\n          color: #aaaaaa;\n          font-size: 13px;\n        }\n\n        .tool-name {\n          color: #ffffff;\n          font-weight: 600;\n          font-size: 14px;\n        }\n      }\n\n      .tool-parameters {\n        .param-label {\n          color: #aaaaaa;\n          font-size: 12px;\n          margin-bottom: 4px;\n          display: block;\n        }\n\n        .param-content {\n          margin: 0;\n          padding: 8px;\n          background: rgba(0, 0, 0, 0.2);\n          border-radius: 4px;\n          font-family: monospace;\n          font-size: 11px;\n          color: #cccccc;\n          white-space: pre-wrap;\n          max-height: 120px;\n          overflow-y: auto;\n        }\n      }\n    }\n  }\n\n  // Agent execution container\n  .agent-execution-container {\n    .section-title {\n      margin: 0 0 16px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n      padding-bottom: 8px;\n      border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    }\n\n    .agent-execution-item {\n      margin-bottom: 16px;\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 8px;\n      overflow: hidden;\n      transition: all 0.2s ease;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      &.running {\n        border-color: rgba(102, 126, 234, 0.4);\n        box-shadow: 0 0 8px rgba(102, 126, 234, 0.2);\n      }\n\n      &.completed {\n        border-color: rgba(34, 197, 94, 0.3);\n      }\n\n      &.pending {\n        opacity: 0.8;\n      }\n\n      .agent-header {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding: 12px 16px;\n        background: rgba(255, 255, 255, 0.02);\n        cursor: pointer;\n        transition: background 0.2s ease;\n\n        &:hover {\n          background: rgba(255, 255, 255, 0.05);\n        }\n\n        .agent-info {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          flex: 1;\n\n          .agent-status-icon {\n            font-size: 18px;\n\n            &.running {\n              color: #667eea;\n            }\n\n            &.completed {\n              color: #22c55e;\n            }\n\n            &.pending {\n              color: #9ca3af;\n            }\n          }\n\n          .agent-details {\n            .agent-name {\n              font-weight: 600;\n              color: #ffffff;\n              font-size: 14px;\n              margin-bottom: 2px;\n            }\n\n            .request-content {\n              margin: 4px 0 0 0;\n              padding: 8px;\n              background: rgba(0, 0, 0, 0.2);\n              border-radius: 4px;\n              font-family: monospace;\n              font-size: 14px;\n              color: #cccccc;\n              white-space: pre-wrap;\n              word-wrap: break-word;\n              word-break: break-word;\n              overflow-wrap: break-word;\n              max-height: 120px;\n              overflow-y: auto;\n              line-height: 1.4;\n            }\n          }\n        }\n\n        .agent-controls {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n\n          .agent-status-badge {\n            padding: 3px 8px;\n            border-radius: 10px;\n            font-size: 11px;\n            font-weight: 500;\n\n            &.running {\n              background: rgba(102, 126, 234, 0.2);\n              color: #667eea;\n            }\n\n            &.completed {\n              background: rgba(34, 197, 94, 0.2);\n              color: #22c55e;\n            }\n\n            &.pending {\n              background: rgba(156, 163, 175, 0.2);\n              color: #9ca3af;\n            }\n          }\n\n          .step-select-icon {\n            font-size: 16px;\n            color: #667eea;\n            transition: transform 0.2s ease;\n          }\n        }\n      }\n\n      .agent-execution-info {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n        margin-bottom: 16px;\n\n        .agent-result,\n        .agent-error {\n          margin-bottom: 12px;\n\n          &:last-child {\n            margin-bottom: 0;\n          }\n\n          .result-header,\n          .error-header {\n            display: flex;\n            align-items: center;\n            gap: 6px;\n            margin-bottom: 6px;\n\n            .result-icon,\n            .error-icon {\n              font-size: 14px;\n            }\n\n            .result-icon {\n              color: #22c55e;\n            }\n\n            .error-icon {\n              color: #ef4444;\n            }\n\n            .result-label,\n            .error-label {\n              color: #ffffff;\n              font-size: 13px;\n              font-weight: 500;\n            }\n          }\n\n          .result-content,\n          .error-content {\n            margin: 0;\n            padding: 8px;\n            background: rgba(0, 0, 0, 0.2);\n            border-radius: 4px;\n            font-family: monospace;\n            font-size: 12px;\n            white-space: pre-wrap;\n            max-height: 150px;\n            overflow-y: auto;\n            color: #cccccc;\n          }\n\n          .error-content {\n            color: #ff9999;\n            border: 1px solid rgba(239, 68, 68, 0.2);\n          }\n        }\n      }\n\n      .sub-plans-container {\n        padding: 16px;\n        background: rgba(0, 0, 0, 0.1);\n        border-top: 1px solid rgba(255, 255, 255, 0.05);\n\n        .sub-plans-header {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          margin-bottom: 12px;\n\n          .sub-plans-icon {\n            font-size: 16px;\n            color: #667eea;\n          }\n\n          .sub-plans-title {\n            color: #ffffff;\n            font-weight: 600;\n            font-size: 14px;\n          }\n        }\n\n        .sub-plans-list {\n          display: flex;\n          flex-direction: column;\n          gap: 12px;\n\n          .sub-plan-item {\n            background: rgba(102, 126, 234, 0.05);\n            border: 1px solid rgba(102, 126, 234, 0.1);\n            border-radius: 6px;\n            padding: 12px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n\n            &:hover {\n              background: rgba(102, 126, 234, 0.1);\n              border-color: rgba(102, 126, 234, 0.2);\n            }\n\n            &.running {\n              border-color: rgba(102, 126, 234, 0.3);\n              background: rgba(102, 126, 234, 0.08);\n              box-shadow: 0 0 8px rgba(102, 126, 234, 0.15);\n            }\n\n            &.completed {\n              border-color: rgba(34, 197, 94, 0.3);\n              background: rgba(34, 197, 94, 0.05);\n            }\n\n            &.pending {\n              opacity: 0.7;\n            }\n\n            .sub-plan-header {\n              display: flex;\n              align-items: center;\n              justify-content: space-between;\n              margin-bottom: 8px;\n\n              .sub-plan-info {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                flex: 1;\n\n                .sub-plan-status-icon {\n                  font-size: 16px;\n\n                  &.completed {\n                    color: #22c55e;\n                  }\n\n                  &.running {\n                    color: #667eea;\n                  }\n\n                  &.in-progress {\n                    color: #fbbf24;\n                  }\n\n                  &.pending {\n                    color: #9ca3af;\n                  }\n                }\n\n                .sub-plan-details {\n                  .sub-plan-title {\n                    font-weight: 600;\n                    color: #ffffff;\n                    font-size: 13px;\n                    margin-bottom: 2px;\n                  }\n\n                  .sub-plan-id {\n                    color: #aaaaaa;\n                    font-size: 11px;\n                    font-family: monospace;\n                  }\n                }\n              }\n\n              .sub-plan-meta {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n\n                .trigger-tool {\n                  display: flex;\n                  align-items: center;\n                  gap: 4px;\n                  padding: 2px 6px;\n                  background: rgba(102, 126, 234, 0.1);\n                  border-radius: 4px;\n                  font-size: 10px;\n\n                  .trigger-icon {\n                    font-size: 10px;\n                    color: #667eea;\n                  }\n\n                  .trigger-text {\n                    color: #cccccc;\n                    font-weight: 500;\n                  }\n                }\n              }\n\n              .sub-plan-status-badge {\n                padding: 2px 6px;\n                border-radius: 8px;\n                font-size: 10px;\n                font-weight: 500;\n\n                &.completed {\n                  background: rgba(34, 197, 94, 0.2);\n                  color: #22c55e;\n                }\n\n                &.running {\n                  background: rgba(102, 126, 234, 0.2);\n                  color: #667eea;\n                }\n\n                &.in-progress {\n                  background: rgba(251, 191, 36, 0.2);\n                  color: #fbbf24;\n                }\n\n                &.pending {\n                  background: rgba(156, 163, 175, 0.2);\n                  color: #9ca3af;\n                }\n              }\n            }\n\n            .sub-plan-progress {\n              margin-bottom: 8px;\n\n              .progress-info {\n                .progress-text {\n                  color: #aaaaaa;\n                  font-size: 10px;\n                  margin-bottom: 4px;\n                }\n\n                .progress-bar {\n                  background: rgba(0, 0, 0, 0.2);\n                  border-radius: 4px;\n                  height: 4px;\n                  overflow: hidden;\n\n                  .progress-fill {\n                    height: 100%;\n                    background: linear-gradient(90deg, #667eea, #764ba2);\n                    transition: width 0.3s ease;\n                    border-radius: 4px;\n                  }\n                }\n              }\n            }\n\n            .sub-plan-agents-steps {\n              .agents-steps-header {\n                color: #aaaaaa;\n                font-size: 11px;\n                margin-bottom: 6px;\n                font-weight: 500;\n              }\n\n              .agents-steps-list {\n                display: flex;\n                flex-direction: column;\n                gap: 8px;\n\n                .agent-step-item {\n                  border: 1px solid rgba(255, 255, 255, 0.1);\n                  border-radius: 6px;\n                  padding: 8px;\n                  background: rgba(0, 0, 0, 0.05);\n                  cursor: pointer;\n                  transition: all 0.2s;\n\n                  &:hover {\n                    background: rgba(0, 0, 0, 0.1);\n                    border-color: rgba(255, 255, 255, 0.2);\n                  }\n\n                  &.completed {\n                    border-color: rgba(34, 197, 94, 0.3);\n                    background: rgba(34, 197, 94, 0.05);\n                  }\n\n                  &.running {\n                    border-color: rgba(102, 126, 234, 0.3);\n                    background: rgba(102, 126, 234, 0.08);\n                  }\n\n                  &.pending {\n                    opacity: 0.7;\n                  }\n\n                  .agent-step-header {\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                    margin-bottom: 8px;\n\n                    .agent-icon {\n                      font-size: 14px;\n\n                      &.completed {\n                        color: #22c55e;\n                      }\n\n                      &.running {\n                        color: #667eea;\n                      }\n\n                      &.pending {\n                        color: #9ca3af;\n                      }\n                    }\n\n                    .agent-name {\n                      color: #ffffff;\n                      font-size: 13px;\n                      font-weight: 500;\n                      flex: 1;\n                    }\n\n                    .agent-status-badge {\n                      padding: 2px 6px;\n                      border-radius: 3px;\n                      font-size: 10px;\n                      font-weight: 500;\n\n                      &.completed {\n                        background: rgba(34, 197, 94, 0.2);\n                        color: #22c55e;\n                      }\n\n                      &.running {\n                        background: rgba(102, 126, 234, 0.2);\n                        color: #667eea;\n                      }\n\n                      &.pending {\n                        background: rgba(156, 163, 175, 0.2);\n                        color: #9ca3af;\n                      }\n                    }\n                  }\n\n                  .sub-agent-execution-info {\n                    margin-left: 22px;\n\n                    .agent-result,\n                    .agent-error {\n                      margin-bottom: 8px;\n\n                      &:last-child {\n                        margin-bottom: 0;\n                      }\n\n                      .result-header,\n                      .error-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 4px;\n\n                        .result-icon,\n                        .error-icon {\n                          font-size: 12px;\n                        }\n\n                        .result-icon {\n                          color: #22c55e;\n                        }\n\n                        .error-icon {\n                          color: #ef4444;\n                        }\n\n                        .result-label,\n                        .error-label {\n                          color: #ffffff;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n\n                      .result-content,\n                      .error-content {\n                        margin: 0;\n                        padding: 6px;\n                        background: rgba(0, 0, 0, 0.2);\n                        border-radius: 3px;\n                        font-family: monospace;\n                        font-size: 10px;\n                        white-space: pre-wrap;\n                        max-height: 80px;\n                        overflow-y: auto;\n                        color: #cccccc;\n                        line-height: 1.3;\n                      }\n                    }\n\n                    .think-act-preview {\n                      margin-top: 8px;\n\n                      .think-act-header {\n                        display: flex;\n                        align-items: center;\n                        gap: 4px;\n                        margin-bottom: 6px;\n\n                        .think-act-icon {\n                          font-size: 12px;\n                          color: #667eea;\n                        }\n\n                        .think-act-label {\n                          color: #aaaaaa;\n                          font-size: 11px;\n                          font-weight: 500;\n                        }\n                      }\n\n                      .think-act-steps-preview {\n                        display: flex;\n                        flex-direction: column;\n                        gap: 3px;\n\n                        .think-act-step-preview {\n                          display: flex;\n                          align-items: center;\n                          gap: 6px;\n                          padding: 4px 6px;\n                          background: rgba(0, 0, 0, 0.1);\n                          border-radius: 3px;\n                          cursor: pointer;\n                          transition: all 0.2s;\n                          font-size: 10px;\n\n                          &:hover {\n                            background: rgba(0, 0, 0, 0.2);\n                          }\n\n                          .step-number {\n                            color: #667eea;\n                            font-weight: 500;\n                            min-width: 20px;\n                          }\n\n                          .step-description {\n                            color: #cccccc;\n                            flex: 1;\n                            white-space: nowrap;\n                            overflow: hidden;\n                            text-overflow: ellipsis;\n                          }\n\n                          .step-arrow {\n                            font-size: 10px;\n                            color: #888888;\n                          }\n                        }\n\n                        .more-steps {\n                          padding: 2px 6px;\n                          color: #888888;\n                          font-size: 9px;\n                          font-style: italic;\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { computed } from 'vue'\nimport type { ChatMessage } from '@/types/message-dialog'\n\n/**\n * Message formatting utilities\n */\nexport function useMessageFormatting() {\n  /**\n   * Format response text with markdown and code highlighting\n   */\n  const formatResponseText = (text: string): string => {\n    if (!text) return ''\n\n    return text\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`([^`]+)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>')\n      .replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>')\n  }\n\n  /**\n   * Format timestamp for display\n   */\n  const formatTimestamp = (timestamp: Date): string => {\n    // Handle invalid dates\n    if (!timestamp || isNaN(timestamp.getTime())) {\n      return ''\n    }\n\n    const now = new Date()\n    const diff = now.getTime() - timestamp.getTime()\n\n    // Less than 1 minute\n    if (diff < 60000) {\n      return 'Just now'\n    }\n\n    // Less than 1 hour\n    if (diff < 3600000) {\n      const minutes = Math.floor(diff / 60000)\n      return `${minutes} minutes ago`\n    }\n\n    // Less than 1 day\n    if (diff < 86400000) {\n      const hours = Math.floor(diff / 3600000)\n      return `${hours} hours ago`\n    }\n\n    // More than 1 day\n    try {\n      return timestamp.toLocaleDateString('zh-CN', {\n        month: 'short',\n        day: 'numeric',\n        hour: '2-digit',\n        minute: '2-digit',\n      })\n    } catch (error) {\n      console.warn('[useMessageFormatting] Error formatting timestamp:', timestamp, error)\n      return ''\n    }\n  }\n\n  /**\n   * Get message CSS classes\n   */\n  const getMessageClasses = (message: ChatMessage) => {\n    return computed(() => ({\n      user: message.type === 'user',\n      assistant: message.type === 'assistant',\n      streaming: message.isStreaming,\n      'has-error': !!message.error,\n      'has-thinking': !!message.thinking,\n      'has-execution': !!message.planExecution,\n    }))\n  }\n\n  /**\n   * Format file size for attachments\n   */\n  const formatFileSize = (bytes: number): string => {\n    if (bytes === 0) return '0 B'\n\n    const k = 1024\n    const sizes = ['B', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n  }\n\n  /**\n   * Truncate long text with ellipsis\n   */\n  const truncateText = (text: string, maxLength: number = 100): string => {\n    if (!text || text.length <= maxLength) return text\n    return text.substring(0, maxLength) + '...'\n  }\n\n  /**\n   * Extract plain text from HTML\n   */\n  const stripHtml = (html: string): string => {\n    return html.replace(/<[^>]*>/g, '')\n  }\n\n  /**\n   * Check if message has content to display\n   */\n  const hasDisplayableContent = (message: ChatMessage): boolean => {\n    return !!(\n      message.content ||\n      (message.thinking ?? false) ||\n      (message.planExecution ?? false) ||\n      message.error\n    )\n  }\n\n  /**\n   * Get message status text\n   */\n  const getMessageStatus = (message: ChatMessage): string => {\n    if (message.error) return 'Send failed'\n    if (message.isStreaming) return 'Typing...'\n    if (message.type === 'assistant' && !message.content && !message.thinking)\n      return 'Waiting for response'\n    return ''\n  }\n\n  return {\n    formatResponseText,\n    formatTimestamp,\n    getMessageClasses,\n    formatFileSize,\n    truncateText,\n    stripHtml,\n    hasDisplayableContent,\n    getMessageStatus,\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Common request methods (TypeScript version, suitable for Vue projects)\n\nimport type { PlanExecutionRecordResponse } from '@/types/plan-execution-record'\n\nexport class CommonApiService {\n  private static readonly BASE_URL = '/api/executor'\n\n  // Get detailed execution records\n  public static async getDetails(planId: string): Promise<PlanExecutionRecordResponse> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/details/${planId}`)\n      if (response.status === 404) {\n        // 404 returns null\n        return null\n      }\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`Failed to get detailed information: ${response.status} - ${errorText}`)\n      }\n      const rawText = await response.text()\n      const data = JSON.parse(rawText)\n\n      // Type validation - ensure the response contains required currentPlanId\n      if (data && typeof data === 'object' && !data.currentPlanId) {\n        // If currentPlanId is missing from response, add it from the parameter\n        data.currentPlanId = planId\n      }\n\n      return data\n    } catch (error: unknown) {\n      // Log error but don't throw exception\n      console.error('[CommonApiService] Failed to get plan details:', error)\n      // Don't return failed status for network errors - let polling continue\n      // Only return null to indicate no data available\n      return null\n    }\n  }\n\n  // Delete execution details\n  public static async deleteExecutionDetails(planId: string): Promise<Record<string, string>> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/details/${planId}`, {\n        method: 'DELETE',\n      })\n      if (!response.ok) {\n        const errorText = await response.text()\n        throw new Error(`Failed to delete execution details: ${response.status} - ${errorText}`)\n      }\n      return await response.json()\n    } catch (error: unknown) {\n      console.error('[CommonApiService] Failed to delete execution details:', error)\n      throw error\n    }\n  }\n\n  // Submit user form input\n  public static async submitFormInput(\n    planId: string,\n    formData: Record<string, unknown>\n  ): Promise<Record<string, unknown>> {\n    const response = await fetch(`${this.BASE_URL}/submit-input/${planId}`, {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify(formData),\n    })\n    if (!response.ok) {\n      let errorData\n      try {\n        errorData = await response.json()\n      } catch {\n        errorData = { message: `Failed to submit form input: ${response.status}` }\n      }\n      throw new Error(errorData.message || `Failed to submit form input: ${response.status}`)\n    }\n    const contentType = response.headers.get('content-type')\n    if (contentType && contentType.indexOf('application/json') !== -1) {\n      return await response.json()\n    }\n    return { success: true }\n  }\n\n  /**\n   * Get all Prompt list\n   */\n  static async getAllPrompts(): Promise<unknown[]> {\n    try {\n      const response = await fetch(this.BASE_URL)\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get Prompt list:', error)\n      throw error\n    }\n  }\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"user-input-form-container\">\n    <div class=\"user-input-header\">\n      <Icon icon=\"carbon:user\" class=\"user-icon\" />\n      <h4 class=\"user-input-title\">{{ $t('chat.userInputRequired') }}</h4>\n    </div>\n\n    <p class=\"user-input-message\">\n      {{ userInputWaitState?.title ?? $t('chat.userInput.message') }}\n    </p>\n\n    <p v-if=\"userInputWaitState?.formDescription\" class=\"form-description\">\n      {{ userInputWaitState?.formDescription }}\n    </p>\n\n    <form @submit.prevent=\"handleUserInputSubmit\" class=\"user-input-form\">\n      <template v-if=\"userInputWaitState?.formInputs && userInputWaitState.formInputs.length > 0\">\n        <div class=\"form-grid\">\n          <div\n            v-for=\"(input, inputIndex) in userInputWaitState?.formInputs\"\n            :key=\"inputIndex\"\n            class=\"form-group\"\n          >\n            <label :for=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\">\n              {{ input.label }}{{ isRequired(input.required) ? ' *' : '' }}:\n            </label>\n\n            <!-- Form input types -->\n            <input\n              v-if=\"!input.type || input.type === 'text'\"\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'email'\"\n              type=\"email\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'number'\"\n              type=\"number\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <input\n              v-else-if=\"input.type === 'password'\"\n              type=\"password\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n\n            <textarea\n              v-else-if=\"input.type === 'textarea'\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-textarea\"\n              rows=\"4\"\n            ></textarea>\n\n            <select\n              v-else-if=\"input.type === 'select' && input.options\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input form-select\"\n            >\n              <option value=\"\">{{ $t('selectCommon.pleaseSelect') }}</option>\n              <option\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                :value=\"option\"\n              >\n                {{ option }}\n              </option>\n            </select>\n\n            <div v-else-if=\"input.type === 'checkbox' && input.options\" class=\"checkbox-group\">\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"checkbox-item\"\n              >\n                <input\n                  type=\"checkbox\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-checkbox\"\n                />\n                <span class=\"checkbox-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <div v-else-if=\"input.type === 'radio' && input.options\" class=\"radio-group\">\n              <label\n                v-for=\"option in getOptionsArray(input.options)\"\n                :key=\"option\"\n                class=\"radio-item\"\n              >\n                <input\n                  type=\"radio\"\n                  :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}-${option.replace(/\\W+/g, '_')}`\"\n                  :name=\"input.label\"\n                  :value=\"option\"\n                  v-model=\"formInputsStore[inputIndex]\"\n                  class=\"form-radio\"\n                />\n                <span class=\"radio-label\">{{ option }}</span>\n              </label>\n            </div>\n\n            <input\n              v-else\n              type=\"text\"\n              :id=\"`form-input-${input.label.replace(/\\W+/g, '_')}`\"\n              :name=\"input.label\"\n              :placeholder=\"input.placeholder || ''\"\n              :required=\"isRequired(input.required)\"\n              v-model=\"formInputsStore[inputIndex]\"\n              class=\"form-input\"\n            />\n          </div>\n        </div>\n      </template>\n\n      <template v-else>\n        <div class=\"form-group\">\n          <label for=\"form-input-genericInput\">{{ $t('common.input') }}:</label>\n          <input\n            type=\"text\"\n            id=\"form-input-genericInput\"\n            name=\"genericInput\"\n            v-model=\"genericInput\"\n            class=\"form-input\"\n          />\n        </div>\n      </template>\n\n      <button type=\"submit\" class=\"submit-user-input-btn\">\n        {{ $t('chat.userInput.submit') }}\n      </button>\n    </form>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, reactive, watch, onMounted, onUnmounted } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport { CommonApiService } from '@/api/common-api-service'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'user-input-submitted', inputData: Record<string, unknown>): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Initialize i18n\nuseI18n()\n\n// Local state\nconst formInputsStore = reactive<Record<number, string | string[]>>({})\nconst genericInput = ref(props.genericInput ?? '')\nconst isInitialized = ref(false)\nconst initializationTimeout = ref<ReturnType<typeof setTimeout> | null>(null)\n\n// Initialize form inputs based on type\nconst initializeFormInputs = () => {\n  const formInputs = props.userInputWaitState?.formInputs\n  if (formInputs && formInputs.length > 0) {\n    // Only initialize if not already initialized or if form structure changed\n    const needsInitialization =\n      !isInitialized.value || Object.keys(formInputsStore).length !== formInputs.length\n\n    if (needsInitialization) {\n      formInputs.forEach((input, index) => {\n        // Only initialize if this field doesn't exist or is empty\n        if (\n          !(index in formInputsStore) ||\n          (input.type === 'checkbox' && !Array.isArray(formInputsStore[index])) ||\n          (input.type !== 'checkbox' && formInputsStore[index] === '')\n        ) {\n          if (input.type === 'checkbox') {\n            formInputsStore[index] = []\n          } else {\n            formInputsStore[index] = ''\n          }\n        }\n      })\n      isInitialized.value = true\n    }\n  }\n}\n\n// Initialize on mount and when formInputs change\nonMounted(() => {\n  initializeFormInputs()\n})\n\nwatch(\n  () => props.userInputWaitState?.formInputs,\n  () => {\n    // Clear any existing timeout\n    if (initializationTimeout.value) {\n      clearTimeout(initializationTimeout.value)\n    }\n\n    // Debounce initialization to avoid frequent resets\n    initializationTimeout.value = setTimeout(() => {\n      // Reset initialization flag when form structure changes\n      isInitialized.value = false\n      initializeFormInputs()\n    }, 100) // 100ms debounce\n  },\n  { deep: true }\n)\n\n// Event handlers\nconst handleUserInputSubmit = async () => {\n  try {\n    const inputData: Record<string, unknown> = {}\n\n    const formInputs = props.userInputWaitState?.formInputs\n    if (formInputs && formInputs.length > 0) {\n      Object.entries(formInputsStore).forEach(([index, value]) => {\n        const numIndex = parseInt(index, 10)\n        const input = formInputs[numIndex]\n        const label = input.label || `input_${index}`\n        // Handle checkbox arrays - convert to string if it's an array\n        if (Array.isArray(value)) {\n          inputData[label] = value.join(', ')\n        } else {\n          inputData[label] = value\n        }\n      })\n    } else {\n      inputData.genericInput = genericInput.value\n    }\n\n    console.log('[UserInputForm] Submitting user input:', inputData, 'for planId:', props.planId)\n\n    // Submit user input to backend API\n    if (props.planId) {\n      await CommonApiService.submitFormInput(props.planId, inputData)\n      console.log('[UserInputForm] User input submitted successfully')\n    } else {\n      console.error('[UserInputForm] No planId available for user input submission')\n    }\n\n    emit('user-input-submitted', inputData)\n  } catch (error: unknown) {\n    console.error('[UserInputForm] User input submission failed:', error)\n  }\n}\n\n// Helper methods\nconst getOptionsArray = (options: string | string[] | undefined): string[] => {\n  if (!options) return []\n  if (Array.isArray(options)) return options\n  if (typeof options === 'string') {\n    return options\n      .split(',')\n      .map(opt => opt.trim())\n      .filter(opt => opt.length > 0)\n  }\n  return []\n}\n\nconst isRequired = (required: boolean | string | undefined): boolean => {\n  if (typeof required === 'boolean') return required\n  if (typeof required === 'string') return required === 'true'\n  return false\n}\n\n// Cleanup on unmount\nonUnmounted(() => {\n  if (initializationTimeout.value) {\n    clearTimeout(initializationTimeout.value)\n  }\n})\n</script>\n\n<style lang=\"less\" scoped>\n.user-input-form-container {\n  margin-top: 20px;\n  padding: 16px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 8px;\n\n  .user-input-header {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    margin-bottom: 12px;\n\n    .user-icon {\n      font-size: 16px;\n      color: #667eea;\n    }\n\n    .user-input-title {\n      margin: 0;\n      color: #ffffff;\n      font-size: 14px;\n      font-weight: 600;\n    }\n  }\n\n  .user-input-message {\n    margin-bottom: 12px;\n    font-weight: 500;\n    color: #ffffff;\n    font-size: 14px;\n  }\n\n  .form-description {\n    margin-bottom: 16px;\n    color: #aaaaaa;\n    font-size: 13px;\n    line-height: 1.4;\n  }\n\n  .user-input-form {\n    .form-grid {\n      display: flex;\n      flex-direction: column;\n      gap: 16px;\n      margin-bottom: 16px;\n\n      @media (max-width: 768px) {\n        gap: 12px;\n      }\n    }\n\n    .form-group {\n      display: flex;\n      flex-direction: column;\n      gap: 4px;\n\n      label {\n        font-size: 13px;\n        font-weight: 500;\n        color: #ffffff;\n      }\n\n      .form-input {\n        padding: 8px 12px;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 6px;\n        color: #ffffff;\n        font-size: 14px;\n        transition: border-color 0.2s ease;\n\n        &:focus {\n          outline: none;\n          border-color: #667eea;\n          box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n        }\n\n        &::placeholder {\n          color: #888888;\n        }\n      }\n\n      .form-textarea {\n        resize: vertical;\n        min-height: 60px;\n        font-family: inherit;\n      }\n\n      .form-select {\n        cursor: pointer;\n\n        option {\n          background: #2d3748;\n          color: #ffffff;\n        }\n      }\n\n      .checkbox-group,\n      .radio-group {\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n\n        .checkbox-item,\n        .radio-item {\n          display: flex;\n          align-items: center;\n          gap: 8px;\n          cursor: pointer;\n          padding: 4px 0;\n\n          .form-checkbox,\n          .form-radio {\n            width: 16px;\n            height: 16px;\n            margin: 0;\n            cursor: pointer;\n            accent-color: #667eea;\n          }\n\n          .checkbox-label,\n          .radio-label {\n            color: #ffffff;\n            font-size: 14px;\n            user-select: none;\n          }\n        }\n      }\n    }\n\n    .submit-user-input-btn {\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n      border: none;\n      padding: 10px 20px;\n      border-radius: 6px;\n      font-size: 14px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.2s ease;\n\n      &:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n      }\n\n      &:active {\n        transform: translateY(0);\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"response-section\">\n    <div class=\"response-header\">\n      <div class=\"response-avatar\">\n        <Icon icon=\"carbon:bot\" class=\"bot-icon\" />\n      </div>\n      <div class=\"response-name\">{{ $t('chat.botName') }}</div>\n\n      <!-- Response timestamp -->\n      <div v-if=\"timestamp\" class=\"response-timestamp\">\n        {{ formatTimestamp(timestamp) }}\n      </div>\n    </div>\n\n    <div class=\"response-content\">\n      <!-- User input form -->\n      <UserInputForm\n        v-if=\"userInputWaitState?.waiting\"\n        :user-input-wait-state=\"userInputWaitState\"\n        v-bind=\"planId ? { 'plan-id': planId } : {}\"\n        :generic-input=\"genericInput ?? ''\"\n        @user-input-submitted=\"handleUserInputSubmitted\"\n      />\n\n      <!-- Final response with content -->\n      <div v-if=\"content\" class=\"final-response\">\n        <div class=\"response-text\" v-html=\"formatResponseText(content)\"></div>\n\n        <!-- Response actions -->\n        <div class=\"response-actions\">\n          <button\n            class=\"action-btn copy-btn\"\n            @click=\"copyToClipboard\"\n            :title=\"$t('chat.copyResponse')\"\n          >\n            <Icon icon=\"carbon:copy\" />\n          </button>\n\n          <button\n            class=\"action-btn regenerate-btn\"\n            @click=\"handleRegenerate\"\n            :title=\"$t('chat.regenerateResponse')\"\n          >\n            <Icon icon=\"carbon:renew\" />\n          </button>\n        </div>\n      </div>\n\n      <!-- Loading/streaming state -->\n      <div v-else-if=\"isStreaming\" class=\"response-placeholder\">\n        <div class=\"typing-indicator\">\n          <div class=\"typing-dots\">\n            <span></span>\n            <span></span>\n            <span></span>\n          </div>\n          <span class=\"typing-text\">{{ $t('chat.thinkingResponse') }}</span>\n        </div>\n      </div>\n\n      <!-- Error state -->\n      <div v-else-if=\"error\" class=\"response-error\">\n        <Icon icon=\"carbon:warning\" class=\"error-icon\" />\n        <span class=\"error-text\">{{ error }}</span>\n        <button class=\"retry-btn\" @click=\"handleRetry\">\n          {{ $t('chat.retry') }}\n        </button>\n      </div>\n\n      <!-- Empty state -->\n      <div v-else class=\"response-empty\">\n        <span class=\"empty-text\">{{ $t('chat.waitingForResponse') }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport UserInputForm from './UserInputForm.vue'\nimport type { UserInputWaitState } from '@/types/plan-execution-record'\n\ninterface Props {\n  content?: string\n  isStreaming?: boolean\n  error?: string\n  timestamp?: Date\n  userInputWaitState?: UserInputWaitState\n  planId?: string\n  genericInput?: string\n}\n\ninterface Emits {\n  (e: 'copy'): void\n  (e: 'regenerate'): void\n  (e: 'retry'): void\n  (e: 'user-input-submitted', inputData: Record<string, unknown>): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst { formatResponseText, formatTimestamp } = useMessageFormatting()\n\n// Methods\nconst copyToClipboard = async () => {\n  if (!props.content) return\n\n  try {\n    // Strip HTML tags for clipboard\n    const plainText = props.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    emit('copy')\n  } catch (error) {\n    console.error('Failed to copy to clipboard:', error)\n  }\n}\n\nconst handleRegenerate = () => {\n  emit('regenerate')\n}\n\nconst handleRetry = () => {\n  emit('retry')\n}\n\nconst handleUserInputSubmitted = (inputData: Record<string, unknown>) => {\n  console.log('[ResponseSection] User input submitted:', inputData)\n  emit('user-input-submitted', inputData)\n}\n</script>\n\n<style lang=\"less\" scoped>\n.response-section {\n  .response-header {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n    margin-bottom: 12px;\n\n    .response-avatar {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      width: 32px;\n      height: 32px;\n      background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);\n      border-radius: 50%;\n      flex-shrink: 0;\n\n      .bot-icon {\n        font-size: 16px;\n        color: #ffffff;\n      }\n    }\n\n    .response-name {\n      font-weight: 600;\n      color: #ffffff;\n      font-size: 14px;\n      flex: 1;\n    }\n\n    .response-timestamp {\n      font-size: 11px;\n      color: #aaaaaa;\n    }\n  }\n\n  .response-content {\n    .final-response {\n      position: relative;\n\n      .response-text {\n        background: rgba(255, 255, 255, 0.05);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 12px;\n        padding: 16px;\n        color: #ffffff;\n        line-height: 1.6;\n        font-size: 14px;\n\n        :deep(strong) {\n          font-weight: 600;\n          color: #ffffff;\n        }\n\n        :deep(em) {\n          font-style: italic;\n          color: #cccccc;\n        }\n\n        :deep(code) {\n          background: rgba(0, 0, 0, 0.3);\n          padding: 2px 6px;\n          border-radius: 4px;\n          font-family: 'Monaco', 'Menlo', monospace;\n          font-size: 13px;\n          color: #8be9fd;\n        }\n\n        :deep(pre) {\n          background: rgba(0, 0, 0, 0.4);\n          padding: 12px;\n          border-radius: 8px;\n          overflow-x: auto;\n          margin: 8px 0;\n\n          code {\n            background: none;\n            padding: 0;\n            color: #f8f8f2;\n            font-size: 12px;\n          }\n        }\n      }\n\n      .response-actions {\n        display: flex;\n        gap: 8px;\n        margin-top: 8px;\n        opacity: 0;\n        transition: opacity 0.2s ease;\n\n        .action-btn {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 28px;\n          height: 28px;\n          background: rgba(255, 255, 255, 0.1);\n          border: none;\n          border-radius: 6px;\n          color: #aaaaaa;\n          cursor: pointer;\n          transition: all 0.2s ease;\n\n          &:hover {\n            background: rgba(255, 255, 255, 0.2);\n            color: #ffffff;\n          }\n\n          svg {\n            font-size: 14px;\n          }\n        }\n      }\n\n      &:hover .response-actions {\n        opacity: 1;\n      }\n    }\n\n    .response-placeholder {\n      .typing-indicator {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n        padding: 16px;\n        color: #aaaaaa;\n        font-size: 14px;\n\n        .typing-dots {\n          display: flex;\n          gap: 4px;\n\n          span {\n            width: 6px;\n            height: 6px;\n            background: #4f46e5;\n            border-radius: 50%;\n            animation: typing-pulse 1.5s ease-in-out infinite;\n\n            &:nth-child(1) {\n              animation-delay: 0s;\n            }\n\n            &:nth-child(2) {\n              animation-delay: 0.2s;\n            }\n\n            &:nth-child(3) {\n              animation-delay: 0.4s;\n            }\n          }\n        }\n\n        .typing-text {\n          font-style: italic;\n        }\n      }\n    }\n\n    .response-error {\n      display: flex;\n      align-items: center;\n      gap: 8px;\n      padding: 12px 16px;\n      background: rgba(239, 68, 68, 0.1);\n      border: 1px solid rgba(239, 68, 68, 0.2);\n      border-radius: 8px;\n      color: #ff9999;\n      font-size: 13px;\n\n      .error-icon {\n        font-size: 16px;\n        color: #ef4444;\n        flex-shrink: 0;\n      }\n\n      .error-text {\n        flex: 1;\n      }\n\n      .retry-btn {\n        background: rgba(239, 68, 68, 0.2);\n        border: none;\n        padding: 4px 8px;\n        border-radius: 4px;\n        color: #ffffff;\n        font-size: 12px;\n        cursor: pointer;\n        transition: background 0.2s ease;\n\n        &:hover {\n          background: rgba(239, 68, 68, 0.3);\n        }\n      }\n    }\n\n    .response-empty {\n      padding: 16px;\n      text-align: center;\n      color: #888888;\n      font-style: italic;\n      font-size: 13px;\n    }\n  }\n}\n\n@keyframes typing-pulse {\n  0%,\n  80%,\n  100% {\n    opacity: 0.3;\n    transform: scale(1);\n  }\n  40% {\n    opacity: 1;\n    transform: scale(1.2);\n  }\n}\n\n@media (max-width: 768px) {\n  .response-section {\n    .response-header {\n      gap: 10px;\n\n      .response-avatar {\n        width: 28px;\n        height: 28px;\n\n        .bot-icon {\n          font-size: 14px;\n        }\n      }\n\n      .response-name {\n        font-size: 13px;\n      }\n    }\n\n    .response-content {\n      .final-response {\n        .response-text {\n          padding: 14px;\n          font-size: 13px;\n        }\n\n        .response-actions {\n          margin-top: 6px;\n\n          .action-btn {\n            width: 26px;\n            height: 26px;\n\n            svg {\n              font-size: 12px;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonApiService } from '@/api/common-api-service'\nimport { useTaskStore } from '@/stores/task'\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\nimport { reactive, readonly, ref } from 'vue'\n\n/**\n * Composable for managing plan execution with reactive state\n * Optimized for real-time status updates with progressive polling intervals\n */\nexport function usePlanExecution() {\n  // Polling configuration\n  const POLL_INTERVAL = 1000 // 1 second polling interval for responsive updates\n  const MAX_RETRY_ATTEMPTS = 10 // Maximum retry attempts for plan not found\n  const POST_COMPLETION_POLL_COUNT = 10 // Continue polling after completion to ensure summary is fetched\n\n  // Tracked plan IDs (plans being polled)\n  const trackedPlanIds = ref<Set<string>>(new Set())\n\n  // Track completed plans that still need polling for summary\n  const completedPlansPollCount = reactive(new Map<string, number>())\n\n  // Track polling attempts per plan (for progressive intervals)\n  const planPollAttempts = reactive(new Map<string, number>())\n\n  // Track retry attempts for plans not found\n  const planRetryAttempts = reactive(new Map<string, number>())\n\n  // Reactive map of PlanExecutionRecord by planId (rootPlanId or currentPlanId)\n  // This is the main reactive state that components watch\n  const planExecutionRecords = reactive(new Map<string, PlanExecutionRecord>())\n\n  // Polling state\n  const isPolling = ref(false)\n  const pollTimer = ref<number | null>(null)\n\n  /**\n   * Get PlanExecutionRecord by planId\n   */\n  const getPlanExecutionRecord = (planId: string): PlanExecutionRecord | undefined => {\n    return planExecutionRecords.get(planId)\n  }\n\n  /**\n   * Set a cached plan record in the reactive map\n   * Useful for restoring conversation history\n   */\n  const setCachedPlanRecord = (planId: string, record: PlanExecutionRecord): void => {\n    if (!planId) {\n      console.warn('[usePlanExecution] Cannot cache plan record with empty planId')\n      return\n    }\n    planExecutionRecords.set(planId, record)\n    console.log('[usePlanExecution] Cached plan record:', planId)\n  }\n\n  /**\n   * Get all tracked plan IDs\n   */\n  const getTrackedPlanIds = (): string[] => {\n    return Array.from(trackedPlanIds.value)\n  }\n\n  /**\n   * Add planId to tracking and start aggressive polling\n   */\n  const trackPlan = (planId: string): void => {\n    if (!planId) {\n      console.warn('[usePlanExecution] Cannot track empty planId')\n      return\n    }\n\n    trackedPlanIds.value.add(planId)\n    planPollAttempts.set(planId, 0)\n    planRetryAttempts.set(planId, 0)\n    console.log('[usePlanExecution] Tracking plan:', planId)\n\n    // Start polling if not already started\n    if (!pollTimer.value) {\n      startPolling()\n    }\n\n    // Immediately poll the plan status (don't wait for first interval)\n    pollPlanStatus(planId).catch(error => {\n      console.error(`[usePlanExecution] Initial poll failed for ${planId}:`, error)\n    })\n  }\n\n  /**\n   * Remove planId from tracking\n   */\n  const untrackPlan = (planId: string): void => {\n    trackedPlanIds.value.delete(planId)\n    planPollAttempts.delete(planId)\n    planRetryAttempts.delete(planId)\n    console.log('[usePlanExecution] Untracking plan:', planId)\n\n    // Stop polling if no more plans to track\n    if (trackedPlanIds.value.size === 0 && completedPlansPollCount.size === 0) {\n      stopPolling()\n    }\n  }\n\n  /**\n   * Poll plan execution status for a specific planId\n   * Implements retry logic for plans not found and progressive polling intervals\n   */\n  const pollPlanStatus = async (planId: string): Promise<void> => {\n    if (!planId) return\n\n    try {\n      console.log('[usePlanExecution] Polling plan status for:', planId)\n      const details = await CommonApiService.getDetails(planId)\n      console.log('[usePlanExecution] Received plan details:', details ? 'YES' : 'NO', details)\n\n      // Reset retry attempts on successful fetch\n      planRetryAttempts.delete(planId)\n\n      if (!details) {\n        // Plan not found - might be temporary (plan not created yet)\n        const retryCount = planRetryAttempts.get(planId) || 0\n\n        if (retryCount < MAX_RETRY_ATTEMPTS) {\n          planRetryAttempts.set(planId, retryCount + 1)\n          console.log(\n            `[usePlanExecution] Plan ${planId} not found yet, retrying (${retryCount + 1}/${MAX_RETRY_ATTEMPTS})`\n          )\n          // Retry after a short delay\n          setTimeout(() => {\n            if (trackedPlanIds.value.has(planId)) {\n              pollPlanStatus(planId).catch(error => {\n                console.error(`[usePlanExecution] Retry poll failed for ${planId}:`, error)\n              })\n            }\n          }, POLL_INTERVAL)\n        } else {\n          console.warn(\n            `[usePlanExecution] Plan ${planId} not found after ${MAX_RETRY_ATTEMPTS} attempts, giving up`\n          )\n          // Remove from tracking if plan doesn't exist after max retries\n          untrackPlan(planId)\n        }\n        return\n      }\n\n      // Increment poll attempts\n      const currentAttempts = planPollAttempts.get(planId) || 0\n      planPollAttempts.set(planId, currentAttempts + 1)\n\n      // Determine the key to use (rootPlanId or currentPlanId)\n      // Priority: use rootPlanId if available, otherwise use currentPlanId\n      const recordKey = details.rootPlanId || details.currentPlanId\n\n      if (!recordKey) {\n        console.warn('[usePlanExecution] Plan record has no rootPlanId or currentPlanId:', details)\n        return\n      }\n\n      // Update reactive map - this will trigger watchers in components\n      // Always use recordKey (rootPlanId or currentPlanId) as the map key\n      planExecutionRecords.set(recordKey, details)\n\n      // If the passed planId is different from recordKey, also store it with the passed planId\n      // This handles cases where the API returns a different planId than what was requested\n      if (planId !== recordKey) {\n        planExecutionRecords.set(planId, details)\n        console.log('[usePlanExecution] Stored record with both keys:', { planId, recordKey })\n      }\n\n      console.log('[usePlanExecution] Updated plan execution record:', {\n        planId,\n        recordKey,\n        rootPlanId: details.rootPlanId,\n        currentPlanId: details.currentPlanId,\n        completed: details.completed,\n        status: details.status,\n        attempt: currentAttempts + 1,\n      })\n\n      // Handle completion - continue polling to ensure summary is fetched\n      if (details.completed) {\n        console.log(`[usePlanExecution] Plan ${recordKey} completed, checking for summary...`)\n\n        // Mark task as no longer running\n        const taskStore = useTaskStore()\n        if (taskStore.currentTask && taskStore.currentTask.isRunning) {\n          taskStore.currentTask.isRunning = false\n        }\n\n        // Check if we have summary or if we need to continue polling\n        const hasSummary = details.summary || details.result || details.message\n        const currentPollCount = completedPlansPollCount.get(recordKey) || 0\n\n        if (!hasSummary && currentPollCount < POST_COMPLETION_POLL_COUNT) {\n          // Continue polling to fetch summary\n          completedPlansPollCount.set(recordKey, currentPollCount + 1)\n          console.log(\n            `[usePlanExecution] Plan ${recordKey} completed but no summary yet, continuing to poll (${currentPollCount + 1}/${POST_COMPLETION_POLL_COUNT})`\n          )\n          // Don't untrack yet - keep polling\n        } else {\n          // We have summary or reached max poll count, proceed with cleanup\n          console.log(`[usePlanExecution] Plan ${recordKey} completed, cleaning up...`, {\n            hasSummary: !!hasSummary,\n            pollCount: currentPollCount,\n          })\n\n          // Delete execution details from backend\n          try {\n            await CommonApiService.deleteExecutionDetails(recordKey)\n            console.log(`[usePlanExecution] Deleted execution details for plan: ${recordKey}`)\n          } catch (error: unknown) {\n            const message = error instanceof Error ? error.message : 'Unknown error'\n            console.error(`[usePlanExecution] Failed to delete execution details: ${message}`)\n          }\n\n          // Remove from tracking\n          untrackPlan(planId)\n\n          // Clean up poll count tracking\n          completedPlansPollCount.delete(recordKey)\n\n          // Remove from reactive map after a delay\n          setTimeout(() => {\n            planExecutionRecords.delete(recordKey)\n            if (planId !== recordKey) {\n              planExecutionRecords.delete(planId)\n            }\n          }, 5000)\n        }\n      }\n\n      // Handle errors\n      if (\n        details.status === 'failed' &&\n        details.message &&\n        !details.message.includes('Failed to get detailed information')\n      ) {\n        console.error(`[usePlanExecution] Plan ${recordKey} failed:`, details.message)\n        // Keep the record in the map so components can handle the error\n      }\n    } catch (error: unknown) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error'\n      console.error(`[usePlanExecution] Failed to poll plan status for ${planId}:`, errorMessage)\n\n      // Handle network errors with retry\n      const retryCount = planRetryAttempts.get(planId) || 0\n      if (retryCount < MAX_RETRY_ATTEMPTS) {\n        planRetryAttempts.set(planId, retryCount + 1)\n        console.log(\n          `[usePlanExecution] Network error for ${planId}, retrying (${retryCount + 1}/${MAX_RETRY_ATTEMPTS})`\n        )\n        // Retry after a delay with exponential backoff\n        setTimeout(\n          () => {\n            if (trackedPlanIds.value.has(planId)) {\n              pollPlanStatus(planId).catch(err => {\n                console.error(`[usePlanExecution] Retry poll failed for ${planId}:`, err)\n              })\n            }\n          },\n          POLL_INTERVAL * (retryCount + 1)\n        )\n      }\n    }\n  }\n\n  /**\n   * Poll all tracked plans with adaptive intervals\n   */\n  const pollAllTrackedPlans = async (): Promise<void> => {\n    if (isPolling.value) {\n      console.log('[usePlanExecution] Previous polling still in progress, skipping')\n      return\n    }\n\n    // Poll both tracked plans and completed plans that still need polling\n    const plansToPoll = new Set(trackedPlanIds.value)\n    for (const [planId] of completedPlansPollCount.entries()) {\n      plansToPoll.add(planId)\n    }\n\n    if (plansToPoll.size === 0) {\n      return\n    }\n\n    try {\n      isPolling.value = true\n\n      // Poll all plans in parallel\n      const pollPromises = Array.from(plansToPoll).map(planId => pollPlanStatus(planId))\n      await Promise.all(pollPromises)\n    } catch (error: unknown) {\n      console.error('[usePlanExecution] Failed to poll tracked plans:', error)\n    } finally {\n      isPolling.value = false\n    }\n  }\n\n  /**\n   * Start adaptive polling with dynamic intervals\n   * Uses shorter intervals for new plans, longer intervals for established plans\n   */\n  const startPolling = (): void => {\n    if (pollTimer.value) {\n      clearInterval(pollTimer.value)\n    }\n\n    // Use 1 second interval for responsive updates\n    pollTimer.value = window.setInterval(() => {\n      pollAllTrackedPlans()\n    }, POLL_INTERVAL)\n\n    console.log('[usePlanExecution] Started adaptive polling')\n  }\n\n  /**\n   * Stop polling\n   * Only stops if there are no tracked plans AND no completed plans waiting for summary\n   */\n  const stopPolling = (): void => {\n    // Check if there are any completed plans still being polled\n    if (completedPlansPollCount.size > 0) {\n      console.log(\n        `[usePlanExecution] Not stopping polling - ${completedPlansPollCount.size} completed plans still waiting for summary`\n      )\n      return\n    }\n\n    if (pollTimer.value) {\n      clearInterval(pollTimer.value)\n      pollTimer.value = null\n    }\n    console.log('[usePlanExecution] Stopped polling')\n  }\n\n  /**\n   * Immediately poll a specific plan\n   */\n  const pollPlanStatusImmediately = async (planId: string): Promise<void> => {\n    console.log(`[usePlanExecution] Polling plan status immediately for: ${planId}`)\n    await pollPlanStatus(planId)\n  }\n\n  /**\n   * Handle plan execution request - track the planId and start aggressive polling\n   * Called by useMessageDialog when a new plan execution starts\n   * This method is the entry point for tracking plan execution\n   */\n  const handlePlanExecutionRequested = (planId: string): void => {\n    console.log('[usePlanExecution] Received plan execution request:', { planId })\n\n    if (!planId) {\n      console.error('[usePlanExecution] Invalid plan execution request: missing planId')\n      return\n    }\n\n    // Mark task as running\n    const taskStore = useTaskStore()\n    taskStore.setTaskRunning(planId)\n\n    // Track the plan (this will start immediate polling)\n    trackPlan(planId)\n  }\n\n  /**\n   * Clean up resources\n   */\n  const cleanup = (): void => {\n    stopPolling()\n    trackedPlanIds.value.clear()\n    completedPlansPollCount.clear()\n    planPollAttempts.clear()\n    planRetryAttempts.clear()\n    planExecutionRecords.clear()\n    isPolling.value = false\n  }\n\n  return {\n    // Reactive state - components can watch this\n    planExecutionRecords: readonly(planExecutionRecords),\n    trackedPlanIds: readonly(trackedPlanIds),\n    isPolling: readonly(isPolling),\n\n    // Methods\n    getPlanExecutionRecord,\n    setCachedPlanRecord,\n    getTrackedPlanIds,\n    trackPlan,\n    untrackPlan,\n    handlePlanExecutionRequested,\n    pollPlanStatusImmediately,\n    startPolling,\n    stopPolling,\n    cleanup,\n  }\n}\n\n// Singleton instance for global use\nlet singletonInstance: ReturnType<typeof usePlanExecution> | null = null\n\n/**\n * Get or create singleton instance of usePlanExecution\n */\nexport function usePlanExecutionSingleton() {\n  if (!singletonInstance) {\n    singletonInstance = usePlanExecution()\n  }\n  return singletonInstance\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DirectApiService } from '@/api/direct-api-service'\nimport { PlanActApiService } from '@/api/plan-act-api-service'\nimport { usePlanExecutionSingleton } from '@/composables/usePlanExecution'\nimport { memoryStore } from '@/stores/memory'\nimport type {\n  ChatMessage,\n  CompatiblePlanExecutionRecord,\n  InputMessage,\n  MessageDialog,\n} from '@/types/message-dialog'\nimport type { PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport type { AgentExecutionRecord, PlanExecutionRecord } from '@/types/plan-execution-record'\nimport { computed, readonly, ref, watchEffect } from 'vue'\n\n/**\n * Composable for managing message dialogs\n * Provides methods to manage dialog list and send messages\n */\nexport function useMessageDialog() {\n  // Plan execution manager\n  const planExecution = usePlanExecutionSingleton()\n\n  // Dialog list state\n  const dialogList = ref<MessageDialog[]>([])\n  const activeDialogId = ref<string | null>(null)\n\n  // Maintain conversationId independently (persisted)\n  // Relationship: conversationId 1:n rootPlanId 1:n dialogId\n  // - conversationId: Persistent conversation identifier\n  // - rootPlanId: Plan execution identifier (one conversation can have multiple plans)\n  // - dialogId: Round identifier (one plan can have multiple dialog rounds)\n  const conversationId = ref<string | null>(null)\n\n  // Maintain rootPlanId independently (not persisted)\n  // Relationship: rootPlanId 1:n dialogId (one plan can have multiple dialog rounds)\n  const rootPlanId = ref<string | null>(null)\n\n  // Computed active rootPlanId - now just returns the maintained rootPlanId\n  const activeRootPlanId = computed(() => {\n    return rootPlanId.value\n  })\n\n  // Loading state\n  const isLoading = ref(false)\n  const error = ref<string | null>(null)\n  const streamingMessageId = ref<string | null>(null)\n  const inputPlaceholder = ref<string | null>(null)\n\n  // Computed properties\n  const activeDialog = computed(() => {\n    if (!activeDialogId.value) {\n      return null\n    }\n    return dialogList.value.find(dialog => dialog.id === activeDialogId.value) || null\n  })\n\n  const hasDialogs = computed(() => {\n    return dialogList.value.length > 0\n  })\n\n  const dialogCount = computed(() => {\n    return dialogList.value.length\n  })\n\n  // Messages from all dialogs in the current conversation\n  // Since each round has its own dialogId, we need to merge messages from all dialogs\n  // that share the same conversationId\n  const messages = computed(() => {\n    if (!conversationId.value) {\n      // If no conversationId, return messages from active dialog only\n      return activeDialog.value?.messages || []\n    }\n    // Merge messages from all dialogs with the same conversationId\n    const allMessages: ChatMessage[] = []\n    for (const dialog of dialogList.value) {\n      if (dialog.conversationId === conversationId.value) {\n        allMessages.push(...dialog.messages)\n      }\n    }\n    // Sort by timestamp to maintain chronological order\n    return allMessages.sort((a, b) => a.timestamp.getTime() - b.timestamp.getTime())\n  })\n\n  /**\n   * Create a new dialog for each conversation round\n   * Each round (user message + assistant response) gets a new dialogId\n   * Relationship: conversationId 1:n rootPlanId 1:n dialogId\n   */\n  const createDialog = (title?: string): MessageDialog => {\n    const dialog: MessageDialog = {\n      id: `dialog_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      title: title || 'New Conversation',\n      messages: [],\n      ...(conversationId.value && { conversationId: conversationId.value }), // Link to conversation if exists\n      ...(rootPlanId.value && { planId: rootPlanId.value }), // Link to plan if exists\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      isActive: true,\n    }\n\n    dialogList.value.push(dialog)\n    activeDialogId.value = dialog.id\n    console.log('[useMessageDialog] Created new dialog round:', dialog.id, {\n      conversationId: conversationId.value,\n      rootPlanId: rootPlanId.value,\n    })\n    return dialog\n  }\n\n  /**\n   * Get dialog by ID\n   */\n  const getDialog = (dialogId: string): MessageDialog | null => {\n    return dialogList.value.find(dialog => dialog.id === dialogId) || null\n  }\n\n  /**\n   * Set active dialog\n   */\n  const setActiveDialog = (dialogId: string | null) => {\n    // Deactivate all dialogs\n    dialogList.value.forEach(dialog => {\n      dialog.isActive = false\n    })\n\n    // Activate selected dialog\n    if (dialogId) {\n      const dialog = dialogList.value.find(d => d.id === dialogId)\n      if (dialog) {\n        dialog.isActive = true\n        activeDialogId.value = dialogId\n      }\n    } else {\n      activeDialogId.value = null\n    }\n  }\n\n  /**\n   * Add message to a dialog\n   */\n  const addMessageToDialog = (dialogId: string, message: ChatMessage) => {\n    const dialog = dialogList.value.find(d => d.id === dialogId)\n    if (dialog) {\n      dialog.messages.push(message)\n      dialog.updatedAt = new Date()\n    }\n  }\n\n  /**\n   * Update message in a dialog\n   */\n  const updateMessageInDialog = (\n    dialogId: string,\n    messageId: string,\n    updates: Partial<ChatMessage>\n  ) => {\n    const dialog = dialogList.value.find(d => d.id === dialogId)\n    if (dialog) {\n      const messageIndex = dialog.messages.findIndex(m => m.id === messageId)\n      if (messageIndex !== -1) {\n        dialog.messages[messageIndex] = { ...dialog.messages[messageIndex], ...updates }\n        dialog.updatedAt = new Date()\n      }\n    }\n  }\n\n  /**\n   * Delete a dialog (one conversation round)\n   * @param dialogId - The dialog ID to delete\n   */\n  const deleteDialog = (dialogId: string) => {\n    const index = dialogList.value.findIndex(d => d.id === dialogId)\n    if (index !== -1) {\n      const deletedDialog = dialogList.value[index]\n      dialogList.value.splice(index, 1)\n      console.log('[useMessageDialog] Deleted dialog round:', dialogId)\n\n      // If deleted dialog was active, set first dialog with same conversationId as active or null\n      if (activeDialogId.value === dialogId) {\n        const sameConversationDialogs = dialogList.value.filter(\n          d => d.conversationId === deletedDialog.conversationId\n        )\n        activeDialogId.value =\n          sameConversationDialogs.length > 0 ? sameConversationDialogs[0].id : null\n        if (activeDialogId.value) {\n          setActiveDialog(activeDialogId.value)\n        }\n      }\n    }\n  }\n\n  /**\n   * Delete a conversation round by rootPlanId\n   * Deletes all dialogs associated with a specific rootPlanId\n   * @param planId - The rootPlanId to delete\n   */\n  const deleteConversationRoundByPlanId = (planId: string): void => {\n    const dialogsToDelete = dialogList.value.filter(d => d.planId === planId)\n    dialogsToDelete.forEach(dialog => {\n      deleteDialog(dialog.id)\n    })\n    console.log(\n      `[useMessageDialog] Deleted ${dialogsToDelete.length} dialog round(s) for plan:`,\n      planId\n    )\n  }\n\n  /**\n   * Delete all dialogs in a conversation\n   * @param convId - The conversationId to delete\n   */\n  const deleteConversation = (convId: string): void => {\n    const dialogsToDelete = dialogList.value.filter(d => d.conversationId === convId)\n    dialogsToDelete.forEach(dialog => {\n      deleteDialog(dialog.id)\n    })\n    console.log(\n      `[useMessageDialog] Deleted ${dialogsToDelete.length} dialog round(s) for conversation:`,\n      convId\n    )\n    // Clear conversationId if it was the active one\n    if (conversationId.value === convId) {\n      conversationId.value = null\n    }\n  }\n\n  /**\n   * Clear all dialogs\n   */\n  const clearAllDialogs = () => {\n    dialogList.value = []\n    activeDialogId.value = null\n  }\n\n  /**\n   * Send message via send button (InputArea)\n   * This method handles sending messages and updating the dialog list\n   */\n  const sendMessage = async (\n    query: InputMessage\n  ): Promise<{ success: boolean; planId?: string; conversationId?: string; error?: string }> => {\n    let targetDialog: MessageDialog | null = null\n    let assistantMessage: ChatMessage | null = null\n\n    try {\n      // Check if there's an active running task based on our own state\n      // Disable new requests if we're currently loading\n      if (isLoading.value) {\n        const errorMsg = 'Please wait for the current task to complete before starting a new one'\n        error.value = errorMsg\n        return {\n          success: false,\n          error: errorMsg,\n        }\n      }\n\n      isLoading.value = true\n      error.value = null\n\n      // Always create a new dialog for each conversation round\n      // Each round (user message + assistant response) gets a new dialogId\n      targetDialog = createDialog()\n\n      // Add user message to dialog\n      const userMessage: ChatMessage = {\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        type: 'user',\n        content: query.input,\n        timestamp: new Date(),\n        isStreaming: false,\n        ...(query.uploadedFiles && {\n          attachments: query.uploadedFiles.map(file => {\n            // Convert string file names to File objects if needed\n            return typeof file === 'string' ? new File([], file) : file\n          }),\n        }),\n      }\n      addMessageToDialog(targetDialog.id, userMessage)\n\n      // Add assistant thinking message\n      assistantMessage = {\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        type: 'assistant',\n        content: '',\n        timestamp: new Date(),\n        thinking: 'Processing...',\n        isStreaming: true,\n      }\n      addMessageToDialog(targetDialog.id, assistantMessage)\n\n      // Import and call DirectApiService\n      const extendedQuery = query as InputMessage & {\n        toolName?: string\n        replacementParams?: Record<string, string>\n      }\n\n      let response: { planId?: string; conversationId?: string; message?: string; result?: string }\n\n      if (extendedQuery.toolName && extendedQuery.replacementParams) {\n        // Execute selected tool\n        response = (await DirectApiService.executeByToolName(\n          extendedQuery.toolName,\n          extendedQuery.replacementParams as Record<string, string>,\n          query.uploadedFiles,\n          query.uploadKey,\n          'VUE_DIALOG'\n        )) as typeof response\n      } else {\n        // Use default plan template\n        response = (await DirectApiService.sendMessageWithDefaultPlan(\n          query,\n          'VUE_DIALOG'\n        )) as typeof response\n      }\n\n      // Update conversationId if present (persisted)\n      if (response.conversationId) {\n        // Maintain conversationId independently (persisted)\n        conversationId.value = response.conversationId\n        // Also set on dialog for reference\n        targetDialog.conversationId = response.conversationId\n        memoryStore.setConversationId(response.conversationId)\n        console.log('[useMessageDialog] Conversation ID set:', response.conversationId)\n      }\n\n      // Update assistant message with response\n      if (response.planId) {\n        // Plan execution mode\n        const newRootPlanId = response.planId\n        // Maintain rootPlanId independently (not persisted)\n        rootPlanId.value = newRootPlanId\n        // Also set on dialog for reference\n        targetDialog.planId = newRootPlanId\n\n        updateMessageInDialog(targetDialog.id, assistantMessage.id, {\n          thinking: 'Planning execution...',\n          planExecution: {\n            currentPlanId: newRootPlanId,\n            rootPlanId: newRootPlanId,\n            status: 'running',\n          },\n          isStreaming: false,\n        })\n\n        // Actively notify usePlanExecution to track this plan\n        planExecution.handlePlanExecutionRequested(newRootPlanId)\n        console.log('[useMessageDialog] Root plan ID set and tracking started:', newRootPlanId)\n      } else {\n        // Direct response mode\n        const updates: Partial<ChatMessage> = {\n          content: response.message || response.result || 'No response received',\n          isStreaming: false,\n        }\n        // Only set thinking if it exists, don't set undefined\n        updateMessageInDialog(targetDialog.id, assistantMessage.id, updates)\n      }\n\n      return {\n        success: true,\n        ...(response.planId && { planId: response.planId }),\n        ...(response.conversationId && { conversationId: response.conversationId }),\n      }\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to send message'\n      error.value = errorMessage\n      console.error('[useMessageDialog] Send message failed:', err)\n\n      // Update assistant message with error\n      if (targetDialog && assistantMessage) {\n        updateMessageInDialog(targetDialog.id, assistantMessage.id, {\n          content: `Error: ${errorMessage}`,\n          error: errorMessage,\n          isStreaming: false,\n        })\n      }\n\n      return {\n        success: false,\n        error: errorMessage,\n      }\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  /**\n   * Execute plan via execute plan button (ExecutionController)\n   * This method handles executing plans and updating the dialog list\n   */\n  const executePlan = async (\n    payload: PlanExecutionRequestPayload\n  ): Promise<{ success: boolean; planId?: string; error?: string }> => {\n    let targetDialog: MessageDialog | null = null\n    let assistantMessage: ChatMessage | null = null\n\n    try {\n      // Check if there's an active running task based on our own state\n      // Disable new requests if we're currently loading\n      if (isLoading.value) {\n        const errorMsg = 'Please wait for the current task to complete before starting a new one'\n        error.value = errorMsg\n        return {\n          success: false,\n          error: errorMsg,\n        }\n      }\n\n      isLoading.value = true\n      error.value = null\n\n      // Check if there's an existing conversationId from memoryStore (persisted)\n      // This allows appending new dialog rounds to existing conversations\n      const existingConversationId = memoryStore.getConversationId()\n      if (existingConversationId && !conversationId.value) {\n        // Restore conversationId from memoryStore if we don't have one yet\n        conversationId.value = existingConversationId\n        console.log(\n          '[useMessageDialog] Restored conversationId from memoryStore:',\n          existingConversationId\n        )\n      }\n\n      // Always create a new dialog for each conversation round\n      // Each round (user message + assistant response) gets a new dialogId\n      // If conversationId exists, it will be automatically linked to the new dialog\n      targetDialog = createDialog(payload.title)\n\n      // Update dialog title if provided\n      if (payload.title) {\n        targetDialog.title = payload.title\n      }\n\n      // Add user message to dialog\n      const userMessage: ChatMessage = {\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        type: 'user',\n        content: payload.title,\n        timestamp: new Date(),\n        isStreaming: false,\n        ...(payload.uploadedFiles && {\n          attachments: payload.uploadedFiles.map(file => {\n            return typeof file === 'string' ? new File([], file) : file\n          }),\n        }),\n      }\n      addMessageToDialog(targetDialog.id, userMessage)\n\n      // Add assistant thinking message\n      assistantMessage = {\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        type: 'assistant',\n        content: '',\n        timestamp: new Date(),\n        thinking: 'Planning execution...',\n        isStreaming: true,\n      }\n      addMessageToDialog(targetDialog.id, assistantMessage)\n\n      // Get plan template ID\n      const planTemplateId = payload.planData.planTemplateId\n      if (!planTemplateId || planTemplateId === null) {\n        throw new Error('Plan template ID is required')\n      }\n\n      // Call PlanActApiService.executePlan\n      // Note: DirectApiService.executeByToolName will automatically include conversationId from memoryStore\n      const response = (await PlanActApiService.executePlan(\n        planTemplateId as string,\n        payload.params,\n        payload.uploadedFiles,\n        payload.replacementParams,\n        payload.uploadKey ?? undefined,\n        'VUE_SIDEBAR'\n      )) as { planId?: string; conversationId?: string }\n\n      // Update conversationId if present (persisted)\n      // Only update if it's different from what we already have\n      if (response.conversationId) {\n        const newConversationId = response.conversationId\n        const currentConversationId = conversationId.value || memoryStore.getConversationId()\n\n        // Only update if the backend returned a different conversationId\n        // This can happen if:\n        // 1. We didn't send a conversationId (first request)\n        // 2. Backend generated a new one (shouldn't happen if we sent one)\n        if (newConversationId !== currentConversationId) {\n          console.log(\n            '[useMessageDialog] Conversation ID changed:',\n            currentConversationId,\n            '->',\n            newConversationId\n          )\n          // Maintain conversationId independently (persisted)\n          conversationId.value = newConversationId\n          // Also set on dialog for reference\n          targetDialog.conversationId = newConversationId\n          memoryStore.setConversationId(newConversationId)\n        } else {\n          // Ensure dialog has the conversationId even if it didn't change\n          targetDialog.conversationId = newConversationId\n          console.log('[useMessageDialog] Conversation ID unchanged:', newConversationId)\n        }\n      } else {\n        // If backend didn't return conversationId, ensure dialog uses the one we have\n        if (conversationId.value) {\n          targetDialog.conversationId = conversationId.value\n        }\n      }\n\n      // Update assistant message with plan execution info\n      if (response.planId) {\n        const newRootPlanId = response.planId\n        // Maintain rootPlanId independently (not persisted)\n        rootPlanId.value = newRootPlanId\n        // Also set on dialog for reference\n        targetDialog.planId = newRootPlanId\n\n        updateMessageInDialog(targetDialog.id, assistantMessage.id, {\n          thinking: 'Planning execution...',\n          planExecution: {\n            currentPlanId: newRootPlanId,\n            rootPlanId: newRootPlanId,\n            status: 'running',\n          },\n          isStreaming: false,\n        })\n\n        // Actively notify usePlanExecution to track this plan\n        planExecution.handlePlanExecutionRequested(newRootPlanId)\n        console.log('[useMessageDialog] Root plan ID set and tracking started:', newRootPlanId)\n      } else {\n        const updates: Partial<ChatMessage> = {\n          content: 'Plan execution started',\n          isStreaming: false,\n        }\n        // Only set thinking if it exists, don't set undefined\n        updateMessageInDialog(targetDialog.id, assistantMessage.id, updates)\n      }\n\n      return {\n        success: true,\n        ...(response.planId && { planId: response.planId }),\n      }\n      // Note: isLoading is NOT reset here - it will be reset when the plan execution completes\n      // This prevents concurrent executions while a plan is still running\n    } catch (err) {\n      const errorMessage = err instanceof Error ? err.message : 'Failed to execute plan'\n      error.value = errorMessage\n      console.error('[useMessageDialog] Execute plan failed:', err)\n\n      // Update assistant message with error\n      if (targetDialog && assistantMessage) {\n        updateMessageInDialog(targetDialog.id, assistantMessage.id, {\n          content: `Error: ${errorMessage}`,\n          error: errorMessage,\n          isStreaming: false,\n        })\n      }\n\n      // Reset isLoading on error since execution failed\n      isLoading.value = false\n\n      return {\n        success: false,\n        error: errorMessage,\n      }\n    }\n  }\n\n  /**\n   * Update plan execution status in a dialog\n   */\n  const updatePlanExecutionStatus = (\n    dialogId: string,\n    messageId: string,\n    planExecution: ChatMessage['planExecution']\n  ) => {\n    const updates: Partial<ChatMessage> = {}\n    if (planExecution !== undefined) {\n      updates.planExecution = planExecution\n    }\n    updateMessageInDialog(dialogId, messageId, updates)\n  }\n\n  /**\n   * Convert readonly PlanExecutionRecord to mutable CompatiblePlanExecutionRecord\n   */\n  const convertPlanExecutionRecord = (\n    record: PlanExecutionRecord | CompatiblePlanExecutionRecord | Readonly<PlanExecutionRecord>\n  ): CompatiblePlanExecutionRecord => {\n    // Create a mutable copy of the record\n    const converted = { ...record } as CompatiblePlanExecutionRecord\n\n    if ('agentExecutionSequence' in record && Array.isArray(record.agentExecutionSequence)) {\n      // Convert readonly array to mutable array\n      converted.agentExecutionSequence = record.agentExecutionSequence.map((agent: unknown) =>\n        convertAgentExecutionRecord(agent as AgentExecutionRecord)\n      )\n    }\n\n    return converted\n  }\n\n  /**\n   * Convert readonly AgentExecutionRecord to mutable version\n   */\n  const convertAgentExecutionRecord = (record: AgentExecutionRecord): AgentExecutionRecord => {\n    const converted = { ...record } as AgentExecutionRecord\n\n    if ('subPlanExecutionRecords' in record && Array.isArray(record.subPlanExecutionRecords)) {\n      converted.subPlanExecutionRecords = record.subPlanExecutionRecords.map((subPlan: unknown) =>\n        convertPlanExecutionRecord(subPlan as PlanExecutionRecord)\n      )\n    }\n\n    return converted\n  }\n\n  /**\n   * Add message to active dialog (convenience method for ChatContainer)\n   * Automatically converts readonly planExecution to mutable version\n   */\n  const addMessage = (\n    type: 'user' | 'assistant',\n    content: string,\n    options?: Partial<ChatMessage>\n  ): ChatMessage => {\n    if (!activeDialog.value) {\n      // Create a new dialog if none exists\n      createDialog()\n    }\n\n    const dialog = activeDialog.value!\n\n    // Convert planExecution if it exists\n    const processedOptions: Partial<ChatMessage> = { ...options }\n    if (options?.planExecution) {\n      processedOptions.planExecution = convertPlanExecutionRecord(options.planExecution)\n    }\n\n    const message: ChatMessage = {\n      id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n      type,\n      content,\n      timestamp: new Date(),\n      isStreaming: false,\n      ...processedOptions,\n    }\n\n    dialog.messages.push(message)\n    dialog.updatedAt = new Date()\n    return message\n  }\n\n  /**\n   * Update message in active dialog (convenience method for ChatContainer)\n   * Automatically converts readonly planExecution to mutable version\n   */\n  const updateMessage = (messageId: string, updates: Partial<ChatMessage>) => {\n    if (!activeDialog.value) {\n      return\n    }\n\n    // Convert planExecution if it exists\n    const processedUpdates: Partial<ChatMessage> = { ...updates }\n    if (updates.planExecution) {\n      processedUpdates.planExecution = convertPlanExecutionRecord(updates.planExecution)\n    }\n\n    const messageIndex = activeDialog.value.messages.findIndex(m => m.id === messageId)\n    if (messageIndex !== -1) {\n      activeDialog.value.messages[messageIndex] = {\n        ...activeDialog.value.messages[messageIndex],\n        ...processedUpdates,\n      }\n      activeDialog.value.updatedAt = new Date()\n    }\n  }\n\n  /**\n   * Find message in active dialog (convenience method for ChatContainer)\n   */\n  const findMessage = (messageId: string): ChatMessage | undefined => {\n    if (!activeDialog.value) {\n      return undefined\n    }\n    return activeDialog.value.messages.find(m => m.id === messageId)\n  }\n\n  /**\n   * Start streaming for a message (convenience method for ChatContainer)\n   */\n  const startStreaming = (messageId: string) => {\n    streamingMessageId.value = messageId\n    updateMessage(messageId, { isStreaming: true })\n  }\n\n  /**\n   * Stop streaming for a message (convenience method for ChatContainer)\n   */\n  const stopStreaming = (messageId?: string) => {\n    if (messageId) {\n      updateMessage(messageId, { isStreaming: false })\n    }\n    if (streamingMessageId.value === messageId || !messageId) {\n      streamingMessageId.value = null\n    }\n  }\n\n  /**\n   * Clear messages in active dialog (convenience method for ChatContainer)\n   */\n  const clearMessages = () => {\n    if (!activeDialog.value) {\n      return\n    }\n    activeDialog.value.messages = []\n    activeDialog.value.updatedAt = new Date()\n    streamingMessageId.value = null\n  }\n\n  /**\n   * Update input state (enabled/disabled)\n   */\n  const updateInputState = (enabled: boolean, placeholder?: string) => {\n    // isLoading is the inverse of enabled\n    isLoading.value = !enabled\n    if (placeholder !== undefined) {\n      inputPlaceholder.value = placeholder\n    }\n    console.log('[useMessageDialog] Input state updated:', {\n      enabled,\n      placeholder,\n      isLoading: isLoading.value,\n    })\n  }\n\n  /**\n   * Set conversationId (internal method for restoring from history)\n   * This is needed when loading conversation history to ensure new dialogs are linked correctly\n   */\n  const setConversationId = (id: string | null) => {\n    conversationId.value = id\n    console.log('[useMessageDialog] Set conversationId:', id)\n  }\n\n  /**\n   * Reset state\n   */\n  const reset = () => {\n    dialogList.value = []\n    activeDialogId.value = null\n    rootPlanId.value = null\n    conversationId.value = null\n    isLoading.value = false\n    error.value = null\n    inputPlaceholder.value = null\n  }\n\n  /**\n   * Helper: Update message with plan execution record\n   */\n  const updateMessageWithPlanRecord = (\n    dialog: MessageDialog,\n    message: ChatMessage,\n    record: PlanExecutionRecord\n  ): void => {\n    const updates: Partial<ChatMessage> = {\n      planExecution: convertPlanExecutionRecord(record),\n      isStreaming: !record.completed,\n    }\n\n    if (!record.completed) {\n      updates.thinking = 'Processing...'\n    } else {\n      // When plan is completed, handle summary content\n      // Only update content if there's no agent execution sequence (simple response)\n      // or if we have a summary/result to display\n      if (!record.agentExecutionSequence || record.agentExecutionSequence.length === 0) {\n        const finalResponse =\n          record.summary ?? record.result ?? record.message ?? 'Execution completed'\n        if (finalResponse) {\n          updates.content = finalResponse\n          updates.thinking = ''\n        }\n      } else if (record.summary) {\n        // Even with agent execution sequence, show summary if available\n        updates.content = record.summary\n        updates.thinking = ''\n      }\n\n      // Handle errors\n      if (record.status === 'failed' && record.message) {\n        updates.content = `Error: ${record.message}`\n        updates.thinking = ''\n      }\n    }\n\n    updateMessageInDialog(dialog.id, message.id, updates)\n  }\n\n  /**\n   * Watch for PlanExecutionRecord changes and update dialog messages\n   * Uses watchEffect for automatic dependency tracking (more Vue 3 idiomatic)\n   * Processes all dialogs with planIds, not just active one\n   */\n  watchEffect(() => {\n    const records = planExecution.planExecutionRecords\n\n    // Force reactivity by accessing the Map size - this ensures watchEffect tracks Map changes\n    const recordsSize = records.size\n\n    // Iterate over all records in the Map to ensure watchEffect tracks all changes\n    // This is important for first-time execution when records are added to the Map\n    const recordsArray = Array.from(records.entries())\n\n    // Also access dialogList to ensure we re-run when dialogs change\n    const dialogs = dialogList.value\n\n    console.log(\n      '[useMessageDialog] watchEffect triggered - records count:',\n      recordsArray.length,\n      'size:',\n      recordsSize\n    )\n    console.log('[useMessageDialog] watchEffect - dialogList count:', dialogs.length)\n    console.log(\n      '[useMessageDialog] watchEffect - dialogs with planId:',\n      dialogs.filter(d => d.planId).map(d => ({ id: d.id, planId: d.planId }))\n    )\n\n    // Process all dialogs that have associated planIds\n    for (const dialog of dialogs) {\n      if (!dialog.planId) {\n        console.log('[useMessageDialog] watchEffect: Skipping dialog without planId:', dialog.id)\n        continue\n      }\n\n      // Find the assistant message with this planId\n      // Try multiple matching strategies: dialog.planId, message.planExecution.rootPlanId, message.planExecution.currentPlanId\n      const message = dialog.messages.find(\n        m =>\n          m.planExecution?.rootPlanId === dialog.planId ||\n          m.planExecution?.currentPlanId === dialog.planId\n      )\n      if (!message) {\n        console.log('[useMessageDialog] watchEffect: No message found for planId:', dialog.planId, {\n          dialogMessages: dialog.messages.map(m => ({\n            id: m.id,\n            type: m.type,\n            planExecutionRootPlanId: m.planExecution?.rootPlanId,\n            planExecutionCurrentPlanId: m.planExecution?.currentPlanId,\n            hasPlanExecution: !!m.planExecution,\n          })),\n        })\n        continue\n      }\n\n      // Enhanced matching: try to find record by multiple keys\n      // 1. Try dialog.planId (primary key)\n      // 2. Try message.planExecution.rootPlanId\n      // 3. Try message.planExecution.currentPlanId\n      // 4. Try all record keys to find matching rootPlanId or currentPlanId\n      let recordEntry = recordsArray.find(([planId]) => planId === dialog.planId)\n\n      const planExecution = message.planExecution\n      if (!recordEntry && planExecution?.rootPlanId) {\n        recordEntry = recordsArray.find(([planId]) => planId === planExecution.rootPlanId)\n      }\n\n      if (!recordEntry && planExecution?.currentPlanId) {\n        recordEntry = recordsArray.find(([planId]) => planId === planExecution.currentPlanId)\n      }\n\n      // If still not found, try to match by checking all records' rootPlanId/currentPlanId\n      if (!recordEntry) {\n        for (const [recordKey, recordValue] of recordsArray) {\n          if (\n            recordValue &&\n            (recordValue.rootPlanId === dialog.planId ||\n              recordValue.currentPlanId === dialog.planId ||\n              (message.planExecution?.rootPlanId &&\n                (recordValue.rootPlanId === message.planExecution.rootPlanId ||\n                  recordValue.currentPlanId === message.planExecution.rootPlanId)) ||\n              (message.planExecution?.currentPlanId &&\n                (recordValue.rootPlanId === message.planExecution.currentPlanId ||\n                  recordValue.currentPlanId === message.planExecution.currentPlanId)))\n          ) {\n            recordEntry = [recordKey, recordValue]\n            console.log('[useMessageDialog] watchEffect: Found record by value matching:', {\n              dialogPlanId: dialog.planId,\n              recordKey,\n              recordRootPlanId: recordValue.rootPlanId,\n              recordCurrentPlanId: recordValue.currentPlanId,\n            })\n            break\n          }\n        }\n      }\n\n      // Handle case where message has planExecution but record not found yet\n      // This is the initial state gap - keep showing the initial state\n      if (!recordEntry) {\n        // If message has planExecution with status 'running', keep it visible\n        // Don't skip - this ensures the execution chain displays immediately\n        const messagePlanExecution = message.planExecution\n        if (messagePlanExecution && messagePlanExecution.status === 'running') {\n          console.log(\n            '[useMessageDialog] watchEffect: Message has planExecution but record not found yet, keeping initial state:',\n            {\n              dialogId: dialog.id,\n              messageId: message.id,\n              planId: dialog.planId,\n              messagePlanExecution: messagePlanExecution,\n              availableRecordKeys: recordsArray.map(([key]) => key),\n            }\n          )\n          // Keep the initial state visible - don't update, just ensure it's displayed\n          // The message already has planExecution with status 'running', which is correct\n          continue\n        }\n        // If message doesn't have planExecution or status is not 'running', skip\n        console.log(\n          '[useMessageDialog] watchEffect: No record found and message has no running planExecution:',\n          {\n            dialogId: dialog.id,\n            planId: dialog.planId,\n            hasPlanExecution: !!message.planExecution,\n            planExecutionStatus: message.planExecution?.status,\n            availableRecordKeys: recordsArray.map(([key]) => key),\n          }\n        )\n        continue\n      }\n\n      const [, readonlyRecord] = recordEntry\n\n      // Convert readonly record to mutable for processing\n      // Use type assertion to handle deeply readonly types from reactive Map\n      // The convertPlanExecutionRecord function will properly convert nested readonly arrays\n      const record = convertPlanExecutionRecord(\n        readonlyRecord as unknown as PlanExecutionRecord\n      ) as PlanExecutionRecord\n\n      console.log('[useMessageDialog] watchEffect: Updating message with plan record:', {\n        dialogId: dialog.id,\n        messageId: message.id,\n        planId: dialog.planId,\n        recordKey: recordEntry[0],\n        recordCompleted: record.completed,\n        recordStatus: record.status,\n      })\n\n      // Update message with latest plan execution record\n      updateMessageWithPlanRecord(dialog, message, record)\n    }\n\n    // Reset isLoading when all plans are completed\n    // Check both trackedPlanIds and planExecutionRecords to handle the case where\n    // a plan has just started but hasn't been polled yet (no record in planExecutionRecords)\n    const hasTrackedPlans = planExecution.trackedPlanIds.value.size > 0\n    const hasRunningPlansInRecords = recordsArray.some(\n      ([, record]) => record && !record.completed && record.status !== 'failed'\n    )\n\n    // If there are tracked plans but no records yet, consider it as running\n    // This handles the race condition where a plan just started but hasn't been polled\n    const hasRunningPlans = hasTrackedPlans || hasRunningPlansInRecords\n\n    if (!hasRunningPlans && isLoading.value) {\n      console.log('[useMessageDialog] All plans completed, resetting isLoading', {\n        hasTrackedPlans,\n        hasRunningPlansInRecords,\n        trackedPlanIds: Array.from(planExecution.trackedPlanIds.value),\n        recordsCount: recordsArray.length,\n      })\n      isLoading.value = false\n    }\n  })\n\n  return {\n    // State\n    dialogList: readonly(dialogList),\n    activeDialogId: readonly(activeDialogId),\n    rootPlanId: readonly(rootPlanId),\n    conversationId: readonly(conversationId),\n    isLoading,\n    error,\n    streamingMessageId: readonly(streamingMessageId),\n    inputPlaceholder: readonly(inputPlaceholder),\n\n    // Computed\n    activeDialog,\n    activeRootPlanId,\n    hasDialogs,\n    dialogCount,\n    messages,\n\n    // Methods\n    createDialog,\n    getDialog,\n    setActiveDialog,\n    addMessageToDialog,\n    updateMessageInDialog,\n    deleteDialog,\n    deleteConversationRoundByPlanId,\n    deleteConversation,\n    clearAllDialogs,\n    sendMessage,\n    executePlan,\n    updatePlanExecutionStatus,\n    updateInputState,\n    setConversationId,\n    reset,\n\n    // Convenience methods for ChatContainer\n    addMessage,\n    updateMessage,\n    findMessage,\n    startStreaming,\n    stopStreaming,\n    clearMessages,\n  }\n}\n\n// Singleton instance for global use\nlet singletonInstance: ReturnType<typeof useMessageDialog> | null = null\n\n/**\n * Get or create singleton instance of useMessageDialog\n */\nexport function useMessageDialogSingleton() {\n  if (!singletonInstance) {\n    singletonInstance = useMessageDialog()\n  }\n  return singletonInstance\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ref, nextTick, onMounted, onUnmounted, readonly } from 'vue'\nimport type { Ref } from 'vue'\n\n/**\n * Scroll behavior management for chat messages\n */\nexport function useScrollBehavior(containerRef: Ref<HTMLElement | null>) {\n  const showScrollToBottom = ref(false)\n  const isAutoScrollEnabled = ref(true)\n  const scrollThreshold = 150 // pixels from bottom to show scroll button\n\n  /**\n   * Scroll to bottom of container\n   */\n  const scrollToBottom = async (smooth = true) => {\n    if (!containerRef.value) return\n\n    await nextTick()\n\n    containerRef.value.scrollTo({\n      top: containerRef.value.scrollHeight,\n      behavior: smooth ? 'smooth' : 'auto',\n    })\n  }\n\n  /**\n   * Check if user is near bottom of container\n   */\n  const isNearBottom = (): boolean => {\n    if (!containerRef.value) return false\n\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    return scrollHeight - scrollTop - clientHeight < scrollThreshold\n  }\n\n  /**\n   * Check scroll position and update scroll button visibility\n   */\n  const checkScrollPosition = () => {\n    if (!containerRef.value) return\n\n    const nearBottom = isNearBottom()\n    showScrollToBottom.value =\n      !nearBottom && containerRef.value.scrollHeight > containerRef.value.clientHeight\n\n    // Enable auto-scroll when user scrolls to bottom\n    if (nearBottom) {\n      isAutoScrollEnabled.value = true\n    }\n  }\n\n  /**\n   * Handle scroll event\n   */\n  const handleScroll = () => {\n    checkScrollPosition()\n\n    // Disable auto-scroll when user manually scrolls up\n    if (!isNearBottom()) {\n      isAutoScrollEnabled.value = false\n    }\n  }\n\n  /**\n   * Auto scroll to bottom when new messages arrive\n   */\n  const autoScrollToBottom = async () => {\n    if (isAutoScrollEnabled.value) {\n      await scrollToBottom()\n    }\n  }\n\n  /**\n   * Force scroll to bottom and enable auto-scroll\n   */\n  const forceScrollToBottom = async () => {\n    isAutoScrollEnabled.value = true\n    await scrollToBottom()\n  }\n\n  /**\n   * Scroll to a specific message element\n   */\n  const scrollToMessage = (messageId: string, smooth = true) => {\n    if (!containerRef.value) return\n\n    const messageElement = containerRef.value.querySelector(`[data-message-id=\"${messageId}\"]`)\n    if (messageElement) {\n      messageElement.scrollIntoView({\n        behavior: smooth ? 'smooth' : 'auto',\n        block: 'center',\n      })\n    }\n  }\n\n  /**\n   * Get scroll position info\n   */\n  const getScrollInfo = () => {\n    if (!containerRef.value) {\n      return {\n        scrollTop: 0,\n        scrollHeight: 0,\n        clientHeight: 0,\n        isAtTop: true,\n        isAtBottom: true,\n        scrollPercentage: 0,\n      }\n    }\n\n    const { scrollTop, scrollHeight, clientHeight } = containerRef.value\n    const isAtTop = scrollTop === 0\n    const isAtBottom = scrollTop + clientHeight >= scrollHeight - 5\n    const scrollPercentage =\n      scrollHeight > clientHeight ? (scrollTop / (scrollHeight - clientHeight)) * 100 : 100\n\n    return {\n      scrollTop,\n      scrollHeight,\n      clientHeight,\n      isAtTop,\n      isAtBottom,\n      scrollPercentage,\n    }\n  }\n\n  /**\n   * Add scroll event listener\n   */\n  const addScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.addEventListener('scroll', handleScroll, { passive: true })\n    }\n  }\n\n  /**\n   * Remove scroll event listener\n   */\n  const removeScrollListener = () => {\n    if (containerRef.value) {\n      containerRef.value.removeEventListener('scroll', handleScroll)\n    }\n  }\n\n  /**\n   * Initialize scroll behavior\n   */\n  const initializeScrollBehavior = () => {\n    addScrollListener()\n    checkScrollPosition()\n  }\n\n  /**\n   * Clean up scroll behavior\n   */\n  const cleanupScrollBehavior = () => {\n    removeScrollListener()\n  }\n\n  // Auto-initialize on mount\n  onMounted(() => {\n    nextTick(() => {\n      initializeScrollBehavior()\n    })\n  })\n\n  // Cleanup on unmount\n  onUnmounted(() => {\n    cleanupScrollBehavior()\n  })\n\n  return {\n    // State\n    showScrollToBottom: readonly(showScrollToBottom),\n    isAutoScrollEnabled: readonly(isAutoScrollEnabled),\n\n    // Methods\n    scrollToBottom,\n    autoScrollToBottom,\n    forceScrollToBottom,\n    scrollToMessage,\n    isNearBottom,\n    checkScrollPosition,\n    getScrollInfo,\n    addScrollListener,\n    removeScrollListener,\n    initializeScrollBehavior,\n    cleanupScrollBehavior,\n  }\n}\n\n/**\n * Smooth scroll behavior with easing\n */\nexport function useSmoothScroll() {\n  const scrollWithEasing = (\n    element: HTMLElement,\n    targetPosition: number,\n    duration: number = 300\n  ) => {\n    const startPosition = element.scrollTop\n    const distance = targetPosition - startPosition\n    let startTime: number | null = null\n\n    const animation = (currentTime: number) => {\n      if (startTime === null) startTime = currentTime\n      const timeElapsed = currentTime - startTime\n      const run = easeInOutQuad(timeElapsed, startPosition, distance, duration)\n\n      element.scrollTop = run\n\n      if (timeElapsed < duration) {\n        requestAnimationFrame(animation)\n      }\n    }\n\n    requestAnimationFrame(animation)\n  }\n\n  // Easing function\n  const easeInOutQuad = (t: number, b: number, c: number, d: number): number => {\n    t /= d / 2\n    if (t < 1) return (c / 2) * t * t + b\n    t--\n    return (-c / 2) * (t * (t - 2) - 1) + b\n  }\n\n  return {\n    scrollWithEasing,\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"chat-container\">\n    <!-- Messages container -->\n    <div class=\"messages\" ref=\"messagesRef\" @click=\"handleMessageContainerClick\">\n      <!-- Message list -->\n      <div\n        v-for=\"message in compatibleMessages\"\n        :key=\"message.id\"\n        class=\"chat-message\"\n        :class=\"[getMessageClasses(message), { streaming: isMessageStreaming(message.id) }]\"\n      >\n        <!-- User message -->\n        <div v-if=\"message.type === 'user'\" class=\"user-message\" :data-message-id=\"message.id\">\n          <div class=\"user-content\">\n            <div class=\"message-text\">\n              {{ message.content }}\n            </div>\n\n            <!-- Attachments if any -->\n            <div v-if=\"message.attachments?.length\" class=\"attachments\">\n              <div\n                v-for=\"(attachment, index) in message.attachments\"\n                :key=\"index\"\n                class=\"attachment-item\"\n              >\n                <Icon icon=\"carbon:document\" class=\"attachment-icon\" />\n                <span class=\"attachment-name\">{{ attachment.name }}</span>\n                <span class=\"attachment-size\">{{ formatFileSize(attachment.size) }}</span>\n              </div>\n            </div>\n\n            <!-- Timestamp -->\n            <div class=\"message-timestamp\">\n              {{ formatTimestamp(message.timestamp) }}\n            </div>\n          </div>\n\n          <!-- Message status indicator -->\n          <div v-if=\"message.error\" class=\"message-status error\">\n            <Icon icon=\"carbon:warning\" class=\"status-icon\" />\n            <span class=\"status-text\">{{ message.error }}</span>\n          </div>\n        </div>\n\n        <!-- Assistant message -->\n        <div v-else-if=\"message.type === 'assistant'\" class=\"assistant-message\">\n          <!-- Plan execution section (when available) -->\n          <ExecutionDetails\n            v-if=\"message.planExecution\"\n            :plan-execution=\"message.planExecution\"\n            :step-actions=\"message.stepActions || []\"\n            :generic-input=\"message.genericInput || ''\"\n            @step-selected=\"handleStepSelected\"\n          />\n\n          <!-- Response section -->\n          <ResponseSection\n            v-if=\"\n              message.content ||\n              message.error ||\n              isMessageStreaming(message.id) ||\n              message.planExecution?.userInputWaitState?.waiting\n            \"\n            :content=\"message.content || ''\"\n            :is-streaming=\"isMessageStreaming(message.id) || false\"\n            v-bind=\"{\n              ...(message.error ? { error: message.error } : {}),\n              ...(message.planExecution?.userInputWaitState\n                ? { userInputWaitState: message.planExecution.userInputWaitState }\n                : {}),\n              ...(message.planExecution?.currentPlanId\n                ? { planId: message.planExecution.currentPlanId }\n                : {}),\n            }\"\n            :timestamp=\"message.timestamp\"\n            :generic-input=\"message.genericInput || ''\"\n            @copy=\"() => handleCopyMessage(message.id)\"\n            @regenerate=\"() => handleRegenerateMessage(message.id)\"\n            @retry=\"() => handleRetryMessage(message.id)\"\n            @user-input-submitted=\"\n              (inputData: Record<string, unknown>) => handleUserInputSubmit(message, inputData)\n            \"\n          />\n        </div>\n      </div>\n\n      <!-- Loading indicator -->\n      <div v-if=\"isLoading\" class=\"loading-message\">\n        <div class=\"loading-content\">\n          <Icon icon=\"carbon:circle-dash\" class=\"loading-icon\" />\n          <span>{{ $t('chat.processing') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Scroll to bottom button -->\n    <Transition name=\"scroll-button\">\n      <button\n        v-if=\"showScrollToBottom\"\n        class=\"scroll-to-bottom\"\n        @click=\"() => scrollToBottom()\"\n        :title=\"$t('chat.scrollToBottom')\"\n      >\n        <Icon icon=\"carbon:chevron-down\" />\n      </button>\n    </Transition>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\n// Import new modular components\nimport ExecutionDetails from './ExecutionDetails.vue'\nimport ResponseSection from './ResponseSection.vue'\n\n// Import composables\nimport { useMessageDialogSingleton } from '@/composables/useMessageDialog'\nimport type { ChatMessage as ChatMessageType } from '@/types/message-dialog'\nimport { useMessageFormatting } from './composables/useMessageFormatting'\nimport { useScrollBehavior } from './composables/useScrollBehavior'\n\n// Plan execution updates are handled by useMessageDialog's watchEffect\n// No need to import usePlanExecutionSingleton here\n\ninterface Emits {\n  (e: 'step-selected', stepId: string): void\n}\n\n// InputMessage interface removed - not needed in display component\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\ninterface Props {}\n\ndefineProps<Props>()\n\nconst emit = defineEmits<Emits>()\n\n// Initialize composables\nconst { t } = useI18n()\n\n// Message dialog state\nconst messageDialog = useMessageDialogSingleton()\nconst { messages, isLoading, streamingMessageId, updateMessage, startStreaming, findMessage } =\n  messageDialog\n\n// Plan execution updates are handled by useMessageDialog's watchEffect\n// No need to access planExecution directly here\n\n// Scroll behavior\nconst messagesRef = ref<HTMLElement | null>(null)\nconst { scrollToBottom, autoScrollToBottom, showScrollToBottom } = useScrollBehavior(messagesRef)\n\n// Message formatting\nconst { getMessageClasses, formatTimestamp, formatFileSize } = useMessageFormatting()\n\n// Computed properties\nconst isMessageStreaming = (messageId: string) => {\n  return streamingMessageId.value === messageId\n}\n\n// Messages are already in compatible format (useMessageDialog handles conversion)\n// Directly use messages.value instead of creating unnecessary wrapper\nconst compatibleMessages = computed(() => messages.value)\n\n// Event handlers\n// Note: Scroll behavior is handled by useScrollBehavior composable\n// The @scroll handler is kept for potential future use but currently not needed\n\nconst handleMessageContainerClick = (event: Event) => {\n  // Handle markdown copy buttons and other click events\n  const target = event.target as HTMLElement\n\n  if (target.classList.contains('md-copy-btn')) {\n    const rawText = target.getAttribute('data-raw')\n    if (rawText) {\n      const text = decodeURIComponent(rawText)\n      navigator.clipboard.writeText(text).then(() => {\n        // Show copy feedback\n        target.textContent = t('chat.copied')\n        setTimeout(() => {\n          target.textContent = t('chat.copy')\n        }, 1000)\n      })\n    }\n  }\n}\n\nconst handleCopyMessage = async (messageId: string) => {\n  const message = findMessage(messageId)\n  if (!message) return\n\n  try {\n    // Strip HTML tags for clipboard\n    const plainText = message.content.replace(/<[^>]*>/g, '')\n    await navigator.clipboard.writeText(plainText)\n    // Could add toast notification here\n  } catch (error) {\n    console.error('Failed to copy message:', error)\n  }\n}\n\n// Regenerate and retry handlers - placeholder implementations\n// TODO: Implement actual regeneration/retry logic when needed\n// Currently these are UI placeholders that reset message state\nconst handleRegenerateMessage = (messageId: string) => {\n  const message = findMessage(messageId)\n  if (message && message.type === 'assistant') {\n    // Reset message content and restart generation\n    updateMessage(messageId, {\n      content: '',\n    })\n    startStreaming(messageId)\n    // TODO: Trigger actual regeneration API call here\n    console.warn('[ChatContainer] Regenerate not yet implemented')\n  }\n}\n\nconst handleRetryMessage = (messageId: string) => {\n  const message = findMessage(messageId)\n  if (message) {\n    // Remove error property instead of setting to undefined\n    const updates: Partial<ChatMessageType> = {\n      content: '',\n    }\n    // Only include error if we want to clear it (delete the property)\n    updateMessage(messageId, updates)\n    startStreaming(messageId)\n    // TODO: Trigger actual retry API call here\n    console.warn('[ChatContainer] Retry not yet implemented')\n  }\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[ChatContainer] Step selected:', stepId)\n  emit('step-selected', stepId)\n}\n\n// User input submission handler\n// TODO: Implement actual user input submission logic when needed\n// This should send user input to the backend for plan execution continuation\nconst handleUserInputSubmit = (message: ChatMessageType, inputData: Record<string, unknown>) => {\n  console.log('[ChatContainer] User input submitted:', inputData, 'for message:', message.id)\n  // TODO: Send user input to backend via API\n  // Should call messageDialog or planExecution API to continue plan execution\n  console.warn('[ChatContainer] User input submission not yet implemented')\n}\n\n// Message handling methods removed - ChatContainer is now a pure display component\n// Plan execution record updates are handled by useMessageDialog's watchEffect\n// No need for duplicate watch here - useMessageDialog.updateMessageWithPlanRecord handles summary content\n\n// Scroll handlers (remove unused function)\n\n// Lifecycle\nonMounted(() => {\n  // Initial prompt processing removed - handled by parent component\n\n  // Auto-scroll to bottom when new messages are added\n  watch(\n    messages,\n    () => {\n      nextTick(() => {\n        autoScrollToBottom()\n      })\n    },\n    { deep: true }\n  )\n})\n\nonUnmounted(() => {\n  // Cleanup handled by composables (useScrollBehavior, useMessageDialog)\n  // No local cleanup needed\n})\n</script>\n\n<style lang=\"less\" scoped>\n.chat-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n\n  .messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 20px;\n    scroll-behavior: smooth;\n\n    // Custom scrollbar\n    &::-webkit-scrollbar {\n      width: 6px;\n    }\n\n    &::-webkit-scrollbar-track {\n      background: rgba(255, 255, 255, 0.1);\n      border-radius: 3px;\n    }\n\n    &::-webkit-scrollbar-thumb {\n      background: rgba(255, 255, 255, 0.3);\n      border-radius: 3px;\n\n      &:hover {\n        background: rgba(255, 255, 255, 0.5);\n      }\n    }\n  }\n\n  .chat-message {\n    width: 100%;\n\n    &.streaming {\n      position: relative;\n\n      &::after {\n        content: '';\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        height: 2px;\n        background: linear-gradient(90deg, transparent, #4f46e5, transparent);\n        animation: streaming-pulse 2s ease-in-out infinite;\n      }\n    }\n  }\n\n  .user-message {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    margin-bottom: 16px;\n\n    .user-content {\n      max-width: 70%;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      color: #ffffff;\n      padding: 12px 16px;\n      border-radius: 18px 18px 4px 18px;\n      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n      position: relative;\n\n      .message-text {\n        word-wrap: break-word;\n        white-space: pre-wrap;\n        line-height: 1.5;\n        font-size: 14px;\n      }\n\n      .attachments {\n        margin-top: 8px;\n\n        .attachment-item {\n          display: flex;\n          align-items: center;\n          gap: 6px;\n          padding: 6px 8px;\n          background: rgba(255, 255, 255, 0.1);\n          border-radius: 8px;\n          margin-bottom: 4px;\n          font-size: 12px;\n\n          &:last-child {\n            margin-bottom: 0;\n          }\n\n          .attachment-icon {\n            font-size: 14px;\n            color: rgba(255, 255, 255, 0.8);\n          }\n\n          .attachment-name {\n            flex: 1;\n            color: #ffffff;\n          }\n\n          .attachment-size {\n            color: rgba(255, 255, 255, 0.7);\n            font-size: 11px;\n          }\n        }\n      }\n\n      .message-timestamp {\n        margin-top: 6px;\n        font-size: 11px;\n        color: rgba(255, 255, 255, 0.7);\n        text-align: right;\n      }\n    }\n\n    .message-status {\n      margin-top: 4px;\n      display: flex;\n      align-items: center;\n      gap: 4px;\n      font-size: 12px;\n\n      &.error {\n        color: #ff6b6b;\n\n        .status-icon {\n          font-size: 14px;\n        }\n      }\n    }\n  }\n\n  .assistant-message {\n    margin-bottom: 24px;\n\n    // Add spacing between thinking and response sections\n    > * + * {\n      margin-top: 16px;\n    }\n  }\n\n  .loading-message {\n    display: flex;\n    justify-content: center;\n    padding: 20px;\n\n    .loading-content {\n      display: flex;\n      align-items: center;\n      gap: 12px;\n      color: #aaaaaa;\n      font-size: 14px;\n\n      .loading-icon {\n        font-size: 16px;\n        animation: spin 1s linear infinite;\n      }\n    }\n  }\n\n  .scroll-to-bottom {\n    position: absolute;\n    bottom: 30px;\n    right: 30px;\n    width: 40px;\n    height: 40px;\n    background: rgba(79, 70, 229, 0.9);\n    border: none;\n    border-radius: 50%;\n    color: #ffffff;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n    transition: all 0.2s ease;\n    z-index: 10;\n\n    &:hover {\n      background: rgba(79, 70, 229, 1);\n      transform: scale(1.1);\n    }\n\n    svg {\n      font-size: 20px;\n    }\n  }\n}\n\n// Transitions\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n@keyframes streaming-pulse {\n  0% {\n    transform: translateX(-100%);\n    opacity: 0;\n  }\n  50% {\n    opacity: 1;\n  }\n  100% {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n}\n\n@media (max-width: 768px) {\n  .chat-container {\n    .messages {\n      padding: 16px;\n    }\n\n    .scroll-to-bottom {\n      bottom: 20px;\n      right: 20px;\n      width: 36px;\n      height: 36px;\n\n      svg {\n        font-size: 18px;\n      }\n    }\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * File information interface matching FileUploadResult.FileInfo from Java\n */\nexport interface FileInfo {\n  originalName: string\n  size: number\n  type: string\n  uploadTime: string\n  success: boolean\n  error?: string\n}\n\n/**\n * File upload result interface matching FileUploadResult from Java\n */\nexport interface FileUploadResult {\n  success: boolean\n  message: string\n  uploadKey: string\n  uploadedFiles: FileInfo[]\n  totalFiles: number\n  successfulFiles: number\n  failedFiles: number\n}\n\n/**\n * Get uploaded files response interface\n */\nexport interface GetUploadedFilesResponse {\n  success: boolean\n  uploadKey: string\n  files: FileInfo[]\n  totalCount: number\n}\n\n/**\n * Delete file response interface\n */\nexport interface DeleteFileResponse {\n  success: boolean\n  message?: string\n  error?: string\n  uploadKey: string\n  fileName: string\n}\n\n/**\n * Upload configuration interface\n */\nexport interface UploadConfig {\n  success: boolean\n  maxFileSize: string\n  maxFiles: number\n  allowedTypes: string[]\n}\n\nexport class FileUploadApiService {\n  /**\n   * Upload files\n   * @param files Files to upload\n   * @returns FileUploadResult with upload information\n   */\n  public static async uploadFiles(files: File[]): Promise<FileUploadResult> {\n    try {\n      console.log('[FileUploadApiService] Uploading files:', files.length)\n\n      const formData = new FormData()\n      files.forEach(file => {\n        formData.append('files', file)\n      })\n\n      const response = await fetch('/api/file-upload/upload', {\n        method: 'POST',\n        body: formData,\n      })\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: FileUploadResult = await response.json()\n      console.log(\n        '[FileUploadApiService] Files uploaded successfully:',\n        result.successfulFiles,\n        'uploadKey:',\n        result.uploadKey\n      )\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error uploading files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get uploaded files for a specific upload key\n   * @param uploadKey Upload key to get files for\n   * @returns GetUploadedFilesResponse with file information\n   */\n  public static async getUploadedFiles(uploadKey: string): Promise<GetUploadedFilesResponse> {\n    try {\n      console.log('[FileUploadApiService] Getting uploaded files for uploadKey:', uploadKey)\n\n      const response = await fetch(`/api/file-upload/files/${encodeURIComponent(uploadKey)}`)\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: GetUploadedFilesResponse = await response.json()\n      console.log(\n        '[FileUploadApiService] Got uploaded files:',\n        result.totalCount,\n        'for uploadKey:',\n        uploadKey\n      )\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting uploaded files:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Delete an uploaded file from a specific upload key directory\n   * @param uploadKey Upload key directory\n   * @param fileName File name to delete\n   * @returns DeleteFileResponse with deletion result\n   */\n  public static async deleteFile(uploadKey: string, fileName: string): Promise<DeleteFileResponse> {\n    try {\n      console.log('[FileUploadApiService] Deleting file:', fileName, 'from uploadKey:', uploadKey)\n\n      const response = await fetch(\n        `/api/file-upload/files/${encodeURIComponent(uploadKey)}/${encodeURIComponent(fileName)}`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        }\n      )\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: DeleteFileResponse = await response.json()\n      console.log('[FileUploadApiService] File deleted successfully:', result.success)\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error deleting file:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get upload configuration and limits\n   * @returns UploadConfig with configuration information\n   */\n  public static async getUploadConfig(): Promise<UploadConfig> {\n    try {\n      console.log('[FileUploadApiService] Getting upload configuration')\n\n      const response = await fetch('/api/file-upload/config')\n\n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`)\n      }\n\n      const result: UploadConfig = await response.json()\n      console.log('[FileUploadApiService] Got upload configuration:', result)\n      return result\n    } catch (error) {\n      console.error('[FileUploadApiService] Error getting upload configuration:', error)\n      throw error\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"file-upload-component\">\n    <!-- Hidden file input -->\n    <input\n      ref=\"fileInputRef\"\n      type=\"file\"\n      multiple\n      style=\"display: none\"\n      @change=\"handleFileChange\"\n      :accept=\"acceptedFileTypes || ''\"\n    />\n\n    <!-- Uploaded files display with integrated upload button -->\n    <div class=\"uploaded-files\" :class=\"{ 'has-files': uploadedFiles.length > 0 }\">\n      <div class=\"files-header\" @click=\"handleFileUpload\">\n        <Icon icon=\"carbon:attachment\" />\n        <span v-if=\"uploadedFiles.length === 0\">{{ t('input.attachFile') }}</span>\n        <span v-else>{{ t('input.attachedFiles') }} ({{ uploadedFiles.length }})</span>\n      </div>\n      <div v-if=\"uploadedFiles.length > 0\" class=\"files-list\">\n        <div v-for=\"file in uploadedFiles\" :key=\"file.originalName\" class=\"file-item\">\n          <Icon icon=\"carbon:document\" class=\"file-icon\" />\n          <span class=\"file-name\">{{ file.originalName }}</span>\n          <span class=\"file-size\">({{ formatFileSize(file.size) }})</span>\n          <button @click=\"removeFile(file)\" class=\"remove-btn\" :title=\"t('input.removeFile')\">\n            <Icon icon=\"carbon:close\" />\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Upload progress indicator -->\n    <div v-if=\"isUploading\" class=\"upload-progress\">\n      <Icon icon=\"carbon:rotate--clockwise\" class=\"loading-icon\" />\n      <span>{{ t('input.uploading') }}</span>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted, watch } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { useI18n } from 'vue-i18n'\nimport {\n  FileInfo,\n  FileUploadApiService,\n  type DeleteFileResponse,\n  type FileUploadResult,\n} from '@/api/file-upload-api-service'\n\nconst { t } = useI18n()\n\ntype FileUploadProps = {\n  acceptedFileTypes?: string\n  disabled?: boolean\n}\n\ninterface Emits {\n  (e: 'files-uploaded', files: FileInfo[], uploadKey: string | null): void\n  (e: 'files-removed', files: FileInfo[]): void\n  (e: 'upload-key-changed', uploadKey: string | null): void\n  (e: 'upload-started'): void\n  (e: 'upload-completed'): void\n  (e: 'upload-error', error: unknown): void\n}\n\nconst props = withDefaults(defineProps<FileUploadProps>(), {\n  acceptedFileTypes:\n    '.pdf,.txt,.md,.doc,.docx,.csv,.xlsx,.xls,.json,.xml,.html,.htm,.mhtml,.log,.java,.py,.js,.ts,.sql,.sh,.bat,.yaml,.yml,.properties,.conf,.ini,.jpg,.jpeg,.png,.gif',\n  disabled: false,\n})\n\nconst emit = defineEmits<Emits>()\n\n// Reactive state\nconst fileInputRef = ref<HTMLInputElement>()\nconst uploadedFiles = ref<FileInfo[]>([])\nconst isUploading = ref(false)\nconst uploadKey = ref<string | null>(null)\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  uploadedFiles.value = []\n  uploadKey.value = null\n  emit('upload-key-changed', null)\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n\n// Watch for file changes to emit events\nwatch(\n  () => uploadedFiles.value,\n  newFiles => {\n    emit('files-removed', newFiles)\n  },\n  { deep: true }\n)\n\n// File upload handlers\nconst handleFileUpload = () => {\n  if (props.disabled) return\n  if (fileInputRef.value) {\n    fileInputRef.value.click()\n  }\n}\n\nconst handleFileChange = async (event: Event) => {\n  const target = event.target as HTMLInputElement\n  const files = target.files\n\n  if (!files || files.length === 0) return\n\n  // Convert FileList to Array and add to pending files (for batch upload)\n  const fileArray = Array.from(files)\n  console.log(\n    '[FileUpload] Selected files for upload:',\n    fileArray.map(f => f.name)\n  )\n\n  // Immediately upload all selected files\n  await uploadFiles(fileArray)\n\n  // Reset file input\n  target.value = ''\n}\n\nconst uploadFiles = async (files: File[]) => {\n  if (files.length === 0) return\n\n  isUploading.value = true\n  emit('upload-started')\n\n  try {\n    // Upload files using the new API service\n    const result: FileUploadResult = await FileUploadApiService.uploadFiles(files)\n\n    if (result.success) {\n      // Set uploadKey for file management\n      if (!uploadKey.value && result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[FileUpload] Set uploadKey:', uploadKey.value)\n        // New upload session - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      } else if (uploadKey.value) {\n        console.log('[FileUpload] Using existing uploadKey:', uploadKey.value)\n        // Existing upload session - append to existing files\n        uploadedFiles.value = [...uploadedFiles.value, ...result.uploadedFiles]\n      } else {\n        console.warn('[FileUpload] No uploadKey returned from upload')\n        // Fallback - replace entire array\n        uploadedFiles.value = result.uploadedFiles\n      }\n\n      // Save uploadKey locally\n      if (result.uploadKey) {\n        uploadKey.value = result.uploadKey\n        console.log('[Input] Saved uploadKey locally:', result.uploadKey)\n        emit('upload-key-changed', uploadKey.value)\n      }\n\n      console.log('[Input] Updated global uploadedFiles state:', uploadedFiles.value)\n\n      // Emit files uploaded event\n      emit('files-uploaded', uploadedFiles.value, uploadKey.value)\n    }\n\n    // Show success message or update UI as needed\n    console.log('Files uploaded successfully:', result)\n    emit('upload-completed')\n  } catch (error) {\n    console.error('File upload error:', error)\n    emit('upload-error', error)\n  } finally {\n    isUploading.value = false\n  }\n}\n\n// File management functions\nconst removeFile = async (fileToRemove: FileInfo) => {\n  try {\n    console.log(' Removing file:', fileToRemove.originalName, 'from uploadKey:', uploadKey)\n\n    // Call backend API to delete the file from the server\n    if (uploadKey.value) {\n      const result: DeleteFileResponse = await FileUploadApiService.deleteFile(\n        uploadKey.value,\n        fileToRemove.originalName\n      )\n      if (result.success) {\n        console.log(' File deleted from server successfully')\n      } else {\n        console.error(' Failed to delete file from server:', result.error)\n      }\n    }\n\n    // Update frontend state\n    uploadedFiles.value = uploadedFiles.value.filter(\n      file => file.originalName !== fileToRemove.originalName\n    )\n\n    // Clear uploadKey to force new plan for new files if no files remain\n    if (uploadedFiles.value.length === 0) {\n      console.log('[FileUpload]  Clearing uploadKey to force new plan for new files')\n      uploadKey.value = null\n      emit('upload-key-changed', null)\n    }\n\n    console.log(' File removal completed, remaining files:', uploadedFiles.value.length)\n  } catch (error) {\n    console.error(' Error removing file:', error)\n    emit('upload-error', error)\n  }\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n// Expose methods and state to parent component\ndefineExpose({\n  uploadedFiles,\n  uploadKey,\n  resetSession,\n  uploadFiles,\n  removeFile,\n  isUploading,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.file-upload-component {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n/* File upload styles */\n.uploaded-files {\n  padding: 8px;\n  border-radius: 8px;\n  transition: all 0.2s ease;\n  width: 100%;\n  box-sizing: border-box;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n\n  &.has-files {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.15);\n  }\n}\n\n.files-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.7);\n  font-weight: 500;\n  cursor: pointer;\n  padding: 4px 2px;\n  transition: all 0.2s ease;\n  user-select: none;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    color: #007acc;\n  }\n\n  &:active {\n    transform: translateY(1px);\n  }\n}\n\n.files-list {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.file-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 6px 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 6px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.08);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.file-icon {\n  font-size: 14px;\n  color: #007acc;\n  flex-shrink: 0;\n}\n\n.file-name {\n  flex: 1;\n  font-size: 13px;\n  color: #ffffff;\n  font-weight: 500;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.file-size {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  flex-shrink: 0;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  padding: 2px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.5);\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  flex-shrink: 0;\n\n  &:hover {\n    color: #ff6b6b;\n    background: rgba(255, 107, 107, 0.1);\n  }\n}\n\n.upload-progress {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  background: rgba(0, 122, 204, 0.1);\n  border-radius: 6px;\n  border: 1px solid rgba(0, 122, 204, 0.2);\n  font-size: 12px;\n  color: #007acc;\n}\n\n.loading-icon {\n  font-size: 14px;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"input-area\">\n    <!-- File upload component at the top, full width -->\n    <FileUploadComponent\n      ref=\"fileUploadRef\"\n      :disabled=\"isDisabled\"\n      @files-uploaded=\"handleFilesUploaded\"\n      @files-removed=\"handleFilesRemoved\"\n      @upload-key-changed=\"handleUploadKeyChanged\"\n      @upload-started=\"handleUploadStarted\"\n      @upload-completed=\"handleUploadCompleted\"\n      @upload-error=\"handleUploadError\"\n    />\n\n    <div class=\"input-container\">\n      <!-- First line: User input form -->\n      <div class=\"input-row-first\">\n        <textarea\n          v-model=\"currentInput\"\n          ref=\"inputRef\"\n          class=\"chat-input\"\n          :placeholder=\"currentPlaceholder\"\n          :disabled=\"isDisabled\"\n          @keydown=\"handleKeydown\"\n          @input=\"adjustInputHeight\"\n        ></textarea>\n      </div>\n\n      <!-- Second line: Selection input, Func-Agent mode and send button -->\n      <div class=\"input-row-second\">\n        <select\n          v-model=\"selectedOption\"\n          class=\"selection-input\"\n          :title=\"$t('input.selectionTitle')\"\n          :disabled=\"isLoadingTools || isDisabled\"\n        >\n          <option value=\"\">{{ $t('input.defaultFuncAgent') }}</option>\n          <option v-for=\"option in selectionOptions\" :key=\"option.value\" :value=\"option.value\">\n            {{ option.label }}\n          </option>\n        </select>\n        <button\n          v-if=\"!isTaskRunning\"\n          class=\"send-button\"\n          :disabled=\"!currentInput.trim() || isDisabled\"\n          @click=\"handleSend\"\n          :title=\"$t('input.send')\"\n        >\n          <Icon icon=\"carbon:send-alt\" />\n          {{ $t('input.send') }}\n        </button>\n        <button\n          v-else\n          class=\"send-button stop-button\"\n          @click=\"handleStop\"\n          :title=\"$t('input.stop')\"\n        >\n          <Icon icon=\"carbon:stop-filled\" />\n          {{ $t('input.stop') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport { useMessageDialogSingleton } from '@/composables/useMessageDialog'\nimport { usePlanExecutionSingleton } from '@/composables/usePlanExecution'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { memoryStore } from '@/stores/memory'\nimport { useTaskStore } from '@/stores/task'\nimport type { InputMessage } from '@/types/message-dialog'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\nconst taskStore = useTaskStore()\nconst templateConfig = usePlanTemplateConfigSingleton()\nconst messageDialog = useMessageDialogSingleton()\nconst planExecution = usePlanExecutionSingleton()\n\n// Track if task is running\nconst isTaskRunning = computed(() => taskStore.hasRunningTask())\n\ninterface Props {\n  initialValue?: string\n  selectionOptions?: Array<{ value: string; label: string }>\n}\n\ninterface InnerToolOption {\n  value: string\n  label: string\n  toolName: string\n  planTemplateId: string\n  paramName: string\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  initialValue: '',\n  selectionOptions: () => [],\n})\n\nconst inputRef = ref<HTMLTextAreaElement>()\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst currentInput = ref('')\nconst defaultPlaceholder = computed(() => t('input.placeholder'))\nconst fileUploadPlaceholder = ref<string | null>(null)\nconst currentPlaceholder = computed(() => {\n  // Priority: messageDialog inputPlaceholder > fileUploadPlaceholder > default\n  if (messageDialog.inputPlaceholder.value) {\n    return messageDialog.inputPlaceholder.value\n  }\n  if (fileUploadPlaceholder.value) {\n    return fileUploadPlaceholder.value\n  }\n  return defaultPlaceholder.value\n})\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\nconst selectedOption = ref('')\nconst innerToolOptions = ref<InnerToolOption[]>([])\nconst isLoadingTools = ref(false)\n// Flag to prevent watcher from saving during restoration from localStorage\nconst isRestoringSelection = ref(false)\n\n// History management\nconst HISTORY_STORAGE_KEY = 'chatInputHistory'\nconst MAX_HISTORY_SIZE = 20\nconst inputHistory = ref<string[]>([])\nconst historyIndex = ref(-1) // -1 means not browsing history\nconst originalInputBeforeHistory = ref('') // Store original input when starting to browse history\n\n// Detect operating system for platform-specific shortcuts\nconst isMac = computed(() => {\n  if (typeof window === 'undefined') return false\n  return /Mac|iPhone|iPad|iPod/.test(navigator.platform) || /Mac/.test(navigator.userAgent)\n})\n\n// Load inner tools with single parameter\nconst loadInnerTools = async () => {\n  isLoadingTools.value = true\n  try {\n    console.log('[InputArea] Loading inner tools from planTemplateList...')\n    const allTools = templateConfig.getAllCoordinatorToolsFromTemplates()\n\n    // Filter tools: enableInternalToolcall=true and exactly one parameter\n    const filteredTools: InnerToolOption[] = []\n\n    for (const tool of allTools) {\n      // Check if it's an internal toolcall\n      if (!tool.enableInternalToolcall) {\n        continue\n      }\n\n      // Parse inputSchema to count parameters\n      try {\n        const inputSchema = JSON.parse(tool.inputSchema || '[]')\n        if (Array.isArray(inputSchema) && inputSchema.length === 1) {\n          // Exactly one parameter\n          const param = inputSchema[0]\n          filteredTools.push({\n            value: tool.planTemplateId,\n            label: `${tool.toolName} (${param.name})`,\n            toolName: tool.toolName,\n            planTemplateId: tool.planTemplateId,\n            paramName: param.name,\n          })\n        }\n      } catch (e) {\n        console.warn('[InputArea] Failed to parse inputSchema for tool:', tool.toolName, e)\n      }\n    }\n\n    innerToolOptions.value = filteredTools\n    console.log('[InputArea] Loaded', filteredTools.length, 'inner tools with single parameter')\n\n    // Restore selected tool from localStorage and validate it still exists\n    const savedTool = localStorage.getItem('inputAreaSelectedTool')\n    if (savedTool) {\n      // Only check if tools are loaded (avoid clearing selection if list is empty during loading)\n      if (filteredTools.length > 0) {\n        const toolExists = filteredTools.some(tool => tool.value === savedTool)\n        if (toolExists) {\n          // Set flag to prevent watcher from overwriting during restoration\n          isRestoringSelection.value = true\n          try {\n            selectedOption.value = savedTool\n            console.log('[InputArea] Restored selected tool from localStorage:', savedTool)\n          } finally {\n            // Reset flag after restoration completes\n            isRestoringSelection.value = false\n          }\n        } else {\n          console.log('[InputArea] Saved tool no longer available, clearing selection')\n          localStorage.removeItem('inputAreaSelectedTool')\n          // Only clear if current selection matches the saved one (avoid clearing user's new selection)\n          if (selectedOption.value === savedTool) {\n            selectedOption.value = ''\n          }\n        }\n      } else {\n        // Tools list is empty, keep existing selection if it matches saved value\n        // This prevents clearing selection when tools haven't loaded yet\n        if (selectedOption.value !== savedTool) {\n          isRestoringSelection.value = true\n          try {\n            selectedOption.value = savedTool\n            console.log(\n              '[InputArea] Restored selected tool from localStorage (tools not loaded yet):',\n              savedTool\n            )\n          } finally {\n            isRestoringSelection.value = false\n          }\n        }\n      }\n    }\n  } catch (error) {\n    console.error('[InputArea] Failed to load inner tools:', error)\n    innerToolOptions.value = []\n  } finally {\n    isLoadingTools.value = false\n  }\n}\n\n// Computed property for selection options (use inner tools if available, otherwise use props)\nconst selectionOptions = computed(() => {\n  if (innerToolOptions.value.length > 0) {\n    return innerToolOptions.value.map(tool => ({\n      value: tool.value,\n      label: tool.label,\n    }))\n  }\n  return props.selectionOptions\n})\n\n// Watch for selection changes and persist to localStorage\nwatch(selectedOption, newValue => {\n  // Only save to localStorage if not restoring (prevents overwriting during restoration)\n  if (!isRestoringSelection.value) {\n    localStorage.setItem('inputAreaSelectedTool', newValue || '')\n  }\n})\n\n// History management functions\nconst loadHistory = () => {\n  try {\n    const stored = localStorage.getItem(HISTORY_STORAGE_KEY)\n    if (stored) {\n      inputHistory.value = JSON.parse(stored)\n    }\n  } catch (error) {\n    console.error('[InputArea] Failed to load history:', error)\n    inputHistory.value = []\n  }\n}\n\nconst saveHistory = () => {\n  try {\n    localStorage.setItem(HISTORY_STORAGE_KEY, JSON.stringify(inputHistory.value))\n  } catch (error) {\n    console.error('[InputArea] Failed to save history:', error)\n  }\n}\n\nconst saveToHistory = (input: string) => {\n  if (!input.trim()) return\n\n  // Remove duplicate if exists\n  const index = inputHistory.value.indexOf(input)\n  if (index !== -1) {\n    inputHistory.value.splice(index, 1)\n  }\n\n  // Add to the beginning\n  inputHistory.value.unshift(input)\n\n  // Keep only the last MAX_HISTORY_SIZE items\n  if (inputHistory.value.length > MAX_HISTORY_SIZE) {\n    inputHistory.value = inputHistory.value.slice(0, MAX_HISTORY_SIZE)\n  }\n\n  saveHistory()\n}\n\nconst navigateHistory = (direction: number) => {\n  if (inputHistory.value.length === 0) return\n\n  // If starting to browse history, save current input\n  if (historyIndex.value === -1) {\n    originalInputBeforeHistory.value = currentInput.value\n  }\n\n  // Calculate new index\n  let newIndex = historyIndex.value + direction\n\n  if (newIndex < -1) {\n    newIndex = -1\n  } else if (newIndex >= inputHistory.value.length) {\n    newIndex = inputHistory.value.length - 1\n  }\n\n  historyIndex.value = newIndex\n\n  // Update input based on history index\n  if (historyIndex.value === -1) {\n    // Restore original input\n    currentInput.value = originalInputBeforeHistory.value\n    originalInputBeforeHistory.value = ''\n  } else {\n    currentInput.value = inputHistory.value[historyIndex.value]\n  }\n\n  adjustInputHeight()\n}\n\n// Load inner tools on mount\n// Watch for planTemplateList changes to reload tools\nwatch(\n  () => templateConfig.planTemplateList.value,\n  () => {\n    // Reload tools when planTemplateList changes\n    console.log('[InputArea] planTemplateList changed, reloading inner tools')\n    loadInnerTools()\n  },\n  { deep: true }\n)\n\nonMounted(() => {\n  loadInnerTools()\n  loadHistory()\n\n  // Watch for plan completion to reset session (reactive approach)\n  // Only reset when ALL plans are completed, not when any single plan completes\n  watch(\n    () => planExecution.planExecutionRecords,\n    records => {\n      // Check if ALL tracked plans are completed\n      const recordsArray = Array.from(records.entries())\n      if (recordsArray.length === 0) {\n        return // No plans to check\n      }\n\n      // Check if there are any running plans\n      const hasRunningPlans = recordsArray.some(\n        ([, planDetails]) =>\n          planDetails && !planDetails.completed && planDetails.status !== 'failed'\n      )\n\n      // Only reset session when ALL plans are completed\n      if (!hasRunningPlans) {\n        console.log('[InputArea] All plans completed, resetting session')\n        resetSession()\n      }\n    },\n    { deep: true }\n  )\n\n  // Watch for taskToInput changes and set input value automatically\n  watch(\n    () => taskStore.taskToInput,\n    newTaskToInput => {\n      if (newTaskToInput?.trim()) {\n        console.log('[InputArea] taskToInput changed, setting input value:', newTaskToInput)\n        nextTick(() => {\n          setInputValue(newTaskToInput.trim())\n          taskStore.getAndClearTaskToInput()\n        })\n      }\n    },\n    { immediate: false }\n  )\n})\n\n// Function to reset session when starting a new conversation session\nconst resetSession = () => {\n  console.log('[FileUpload] Resetting session and clearing uploadKey')\n  fileUploadRef.value?.resetSession()\n}\n\n// Auto-reset session when component is unmounted to prevent memory leaks\nonUnmounted(() => {\n  resetSession()\n})\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[InputArea] Files uploaded:', files.length, 'uploadKey:', key)\n\n  // Update placeholder to show files are attached\n  if (uploadedFiles.value.length > 0) {\n    fileUploadPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[InputArea] Files removed, remaining:', files.length)\n\n  // Update placeholder\n  if (uploadedFiles.value.length === 0) {\n    fileUploadPlaceholder.value = null\n  } else {\n    fileUploadPlaceholder.value = t('input.filesAttached', { count: uploadedFiles.value.length })\n  }\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[InputArea] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[InputArea] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[InputArea] Upload completed')\n}\n\nconst handleUploadError = (error: unknown) => {\n  console.error('[InputArea] Upload error:', error)\n}\n\n// Computed property for disabled state - use messageDialog isLoading\nconst isDisabled = computed(() => messageDialog.isLoading.value)\n\nconst adjustInputHeight = () => {\n  nextTick(() => {\n    if (inputRef.value) {\n      inputRef.value.style.height = 'auto'\n      inputRef.value.style.height = Math.min(inputRef.value.scrollHeight, 120) + 'px'\n    }\n  })\n}\n\nconst handleKeydown = (event: KeyboardEvent) => {\n  // Ctrl+Enter (Windows/Linux) or Cmd+Enter (Mac) to send\n  if (event.key === 'Enter' && (event.ctrlKey || event.metaKey)) {\n    event.preventDefault()\n    handleSend()\n    return\n  }\n\n  // Platform-specific history navigation:\n  // Mac: Option+ArrowUp/Down\n  // Windows/Linux: Ctrl+ArrowUp/Down\n  // ArrowUp: go to newer (index 0, 1, 2...)\n  // ArrowDown: go to older (index -1, then older items)\n  const historyModifier = isMac.value ? event.altKey : event.ctrlKey\n\n  if (event.key === 'ArrowUp' && historyModifier) {\n    event.preventDefault()\n    navigateHistory(1) // Go to newer (next in history array)\n    return\n  }\n\n  if (event.key === 'ArrowDown' && historyModifier) {\n    event.preventDefault()\n    navigateHistory(-1) // Go to older (previous in history array)\n    return\n  }\n\n  // If user starts typing while browsing history, reset history index\n  if (\n    historyIndex.value !== -1 &&\n    event.key.length === 1 &&\n    !event.ctrlKey &&\n    !event.metaKey &&\n    !event.altKey\n  ) {\n    historyIndex.value = -1\n    originalInputBeforeHistory.value = ''\n  }\n}\n\nconst handleSend = async () => {\n  if (!currentInput.value.trim() || isDisabled.value) return\n\n  const finalInput = currentInput.value.trim()\n\n  // Save to history before sending\n  saveToHistory(finalInput)\n\n  // Reset history browsing state\n  historyIndex.value = -1\n  originalInputBeforeHistory.value = ''\n\n  // Prepare query with tool information if selected\n  const query: InputMessage = {\n    input: finalInput,\n    memoryId: memoryStore.selectMemoryId,\n    uploadedFiles: uploadedFiles.value,\n  }\n\n  // Add uploadKey if it exists\n  if (uploadKey.value) {\n    query.uploadKey = uploadKey.value\n    console.log('[InputArea] Including uploadKey in message:', uploadKey.value)\n  } else {\n    console.log('[InputArea] No uploadKey available for message')\n  }\n\n  // Check if a tool is selected\n  if (selectedOption.value) {\n    const selectedTool = innerToolOptions.value.find(tool => tool.value === selectedOption.value)\n\n    if (selectedTool) {\n      // Add tool information to query for backend processing\n      const extendedQuery = query as InputMessage & {\n        toolName?: string\n        replacementParams?: Record<string, string>\n      }\n      extendedQuery.toolName = selectedTool.planTemplateId\n      extendedQuery.replacementParams = {\n        [selectedTool.paramName]: finalInput,\n      }\n      console.log('[InputArea] Sending message with tool:', selectedTool.toolName)\n    }\n  }\n\n  // Call sendMessage from useMessageDialog directly\n  try {\n    await messageDialog.sendMessage(query)\n  } catch (error: unknown) {\n    const errorMessage = error instanceof Error ? error.message : String(error)\n    console.error('[InputArea] Send message failed:', errorMessage)\n  }\n\n  // Clear the input but keep uploaded files and uploadKey for follow-up conversations\n  clearInput()\n}\n\nconst handleStop = async () => {\n  console.log('[InputArea] Stop button clicked')\n  const success = await taskStore.stopCurrentTask()\n  if (success) {\n    console.log('[InputArea] Task stopped successfully')\n  } else {\n    console.error('[InputArea] Failed to stop task')\n  }\n}\n\n/**\n * Clear the input box\n */\nconst clearInput = () => {\n  currentInput.value = ''\n  adjustInputHeight()\n}\n\n/**\n * Update the state of the input area (enable/disable)\n * @param {boolean} enabled - Whether to enable input\n * @param {string} [placeholder] - Placeholder text when enabled\n */\nconst updateState = (enabled: boolean, placeholder?: string) => {\n  // Update state in useMessageDialog (which will update inputPlaceholder)\n  messageDialog.updateInputState(enabled, placeholder)\n}\n\n/**\n * Set the input value without triggering send\n * @param {string} value - The value to set\n */\nconst setInputValue = (value: string) => {\n  currentInput.value = value\n  adjustInputHeight()\n}\n\n/**\n * Get the current value of the input box\n * @returns {string} The text value of the current input box (trimmed)\n */\nconst getQuery = () => {\n  return currentInput.value.trim()\n}\n\n// Watch for initialValue changes\nwatch(\n  () => props.initialValue,\n  newValue => {\n    if (newValue.trim()) {\n      currentInput.value = newValue\n      adjustInputHeight()\n    }\n  },\n  { immediate: true }\n)\n\n// Expose methods to the parent component (if needed)\ndefineExpose({\n  clearInput,\n  updateState,\n  getQuery,\n  focus: () => inputRef.value?.focus(),\n  get uploadedFiles() {\n    return fileUploadRef.value?.uploadedFiles?.map(f => f.originalName) || []\n  },\n  get uploadKey() {\n    return fileUploadRef.value?.uploadKey || null\n  },\n})\n</script>\n\n<style lang=\"less\" scoped>\n.input-area {\n  min-height: 112px;\n  padding: 10px 12px;\n  border-top: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n  /* Ensure the input area is always at the bottom */\n  flex-shrink: 0; /* Won't be compressed */\n  position: sticky; /* Fixed at the bottom */\n  bottom: 0;\n  z-index: 100;\n  /* Add a slight shadow to distinguish the message area */\n  box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);\n  backdrop-filter: blur(20px);\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.input-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 12px;\n  padding: 12px 16px;\n\n  &:focus-within {\n    border-color: #667eea;\n  }\n}\n\n.input-row-first {\n  display: flex;\n  align-items: center;\n  width: 100%;\n}\n\n.input-row-second {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  flex-wrap: wrap;\n  gap: 8px;\n  width: 100%;\n  min-width: 0;\n  min-height: fit-content;\n}\n\n.selection-input {\n  flex-shrink: 1;\n  flex-basis: auto;\n  min-width: 0;\n  max-width: 100%;\n  padding: 6px 8px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  outline: none;\n  width: 18ch;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  box-sizing: border-box;\n\n  @media (max-width: 600px) {\n    width: 100%;\n    max-width: 100%;\n  }\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.3);\n  }\n\n  &:focus {\n    border-color: #667eea;\n    background: rgba(255, 255, 255, 0.08);\n  }\n\n  option {\n    background: #1a1a1a;\n    color: #ffffff;\n    white-space: normal;\n    padding: 4px 8px;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n}\n\n.chat-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #ffffff;\n  font-size: 14px;\n  line-height: 1.5;\n  resize: none;\n  min-height: 20px;\n  max-height: 120px;\n\n  &::placeholder {\n    color: #666666;\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n\n    &::placeholder {\n      color: #444444;\n    }\n  }\n}\n\n.send-button {\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  padding: 6px 12px;\n  border: none;\n  border-radius: 6px;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover:not(:disabled) {\n    transform: translateY(-1px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  &.stop-button {\n    background: linear-gradient(135deg, #f56565 0%, #c53030 100%);\n\n    &:hover {\n      background: linear-gradient(135deg, #fc8181 0%, #e53e3e 100%);\n    }\n  }\n}\n\n.clear-memory-btn {\n  width: 1.5em;\n  height: 1.5em;\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\n\nexport interface Memory {\n  id: number\n  conversation_id: string\n  memory_name: string\n  create_time: string\n  messages?: MessageBubble[]\n}\n\nexport interface MemoryResponse {\n  success: boolean\n  message: string\n  data?: Memory\n  memories?: Memory[]\n  total_count?: number\n  response_time: string\n}\n\nexport interface MessageBubble {\n  messageType: string\n  text: string\n}\n\nexport class MemoryApiService {\n  private static readonly BASE_URL = '/api/memories'\n\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n\n  static async getMemories(): Promise<Memory[]> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`)\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      return data.memories ?? []\n    } catch (error) {\n      console.error('Failed to get memory list:', error)\n      throw error\n    }\n  }\n\n  static async getMemory(conversationId: string): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/single?conversationId=${conversationId}`)\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Memory not found')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to get memory:', error)\n      throw error\n    }\n  }\n\n  static async createMemory(conversationId: string, memoryName: string): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          conversation_id: conversationId,\n          memory_name: memoryName,\n        }),\n      })\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Failed to create memory')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to create memory:', error)\n      throw error\n    }\n  }\n\n  static async updateMemory(conversationId: string, memoryName: string): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          conversation_id: conversationId,\n          memory_name: memoryName,\n        }),\n      })\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Failed to update memory')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to update memory:', error)\n      throw error\n    }\n  }\n\n  static async deleteMemory(conversationId: string): Promise<void> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${conversationId}`, {\n        method: 'DELETE',\n      })\n      await this.handleResponse(response)\n    } catch (error) {\n      console.error('Failed to delete memory:', error)\n      throw error\n    }\n  }\n\n  static async generateConversationId(): Promise<Memory> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/generate-id`)\n      const result = await this.handleResponse(response)\n      const data: MemoryResponse = await result.json()\n      if (!data.data) {\n        throw new Error('Failed to generate conversation ID')\n      }\n      return data.data\n    } catch (error) {\n      console.error('Failed to generate conversation ID:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get conversation history (plan execution records) for a specific conversation\n   * @param conversationId The conversation ID\n   * @returns Array of plan execution records\n   */\n  static async getConversationHistory(conversationId: string): Promise<PlanExecutionRecord[]> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${conversationId}/history`)\n      const result = await this.handleResponse(response)\n      const data: PlanExecutionRecord[] = await result.json()\n      return data || []\n    } catch (error) {\n      console.error('Failed to get conversation history:', error)\n      throw error\n    }\n  }\n}\n","<template>\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div class=\"app-container\" v-if=\"memoryStore.isCollapsed\">\n        <div class=\"app-content\">\n          <div class=\"header\">\n            <div class=\"relative\">\n              <div class=\"title-edit-group\">\n                <h1 id=\"main-title\" class=\"main-title\">\n                  <span>{{ $t('memory.title') }}</span>\n                </h1>\n              </div>\n\n              <div\n                id=\"title-edit-container\"\n                class=\"title-edit-container\"\n                v-if=\"showTitleEdit\"\n              ></div>\n            </div>\n            <button class=\"close-btn\" @click=\"memoryStore.toggleSidebar()\">\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n\n          <div class=\"search-bar\">\n            <div class=\"search-container\">\n              <Icon class=\"search-container-icon\" icon=\"carbon:search\" />\n              <input\n                type=\"text\"\n                :placeholder=\"$t('memory.searchPlaceholder')\"\n                class=\"search-input\"\n                v-model=\"searchQuery\"\n                @input=\"handleSearch\"\n              />\n            </div>\n          </div>\n\n          <div class=\"message-list\" id=\"message-list\">\n            <div>\n              <div\n                class=\"message-item\"\n                v-for=\"message in filteredMessages\"\n                :key=\"message.conversation_id\"\n                :class=\"{ expanded: message.expanded }\"\n              >\n                <div class=\"message-header\">\n                  <div class=\"message-content\">\n                    <div class=\"sender-info\">\n                      <div class=\"sender-div\" @click.stop=\"selectMemory(message.conversation_id)\">\n                        <h3 class=\"sender-name\">\n                          {{ message.memory_name }}\n                        </h3>\n                      </div>\n\n                      <div class=\"action-buttons\">\n                        <button\n                          class=\"delete-btn\"\n                          @click.stop=\"toggleMessage(message.conversation_id)\"\n                        >\n                          <Icon\n                            :id=\"'toggle-' + message.conversation_id\"\n                            icon=\"carbon:chevron-down\"\n                            class=\"down-btn\"\n                          ></Icon>\n                        </button>\n                      </div>\n                      <div class=\"action-buttons\">\n                        <button\n                          class=\"delete-btn\"\n                          @click.stop=\"showDeleteConfirm(message.conversation_id)\"\n                        >\n                          <Icon icon=\"carbon:delete\"></Icon>\n                        </button>\n                      </div>\n                    </div>\n\n                    <div class=\"message-meta\">\n                      <span class=\"message-id\">ID: {{ message.conversation_id }}</span>\n                      <div class=\"meta-right\">\n                        <span\n                          class=\"unread-count\"\n                          v-if=\"message.messages && message.messages.length > 0\"\n                        >\n                          {{ message.messages.length }} {{ $t('memory.size') }}\n                        </span>\n                        <span class=\"message-time\">{{ formatTimestamp(message.create_time) }}</span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n\n                <div\n                  :id=\"'content-' + message.conversation_id\"\n                  class=\"expanded-content\"\n                  v-if=\"message.expanded\"\n                >\n                  <div style=\"display: flex; flex-direction: column; gap: 0.75rem\">\n                    <div\n                      class=\"message-bubble\"\n                      v-for=\"(bubble, idx) in message.messages\"\n                      :key=\"idx\"\n                    >\n                      <div class=\"bubble-avatar\">\n                        {{ bubble.messageType }}\n                      </div>\n                      <div class=\"bubble-content\">\n                        <p class=\"bubble-text\">{{ bubble.text }}</p>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n\n            <div v-if=\"filteredMessages.length === 0 && searchQuery\" class=\"empty-state\">\n              <p class=\"state-text\">none message</p>\n            </div>\n          </div>\n\n          <div\n            id=\"name-edit-modal\"\n            class=\"modal-overlay\"\n            v-if=\"showNameModal\"\n            @click.self=\"closeNameModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{ $t('memory.changeName') }}</h3>\n                <input\n                  type=\"text\"\n                  v-model=\"nameInput\"\n                  class=\"edit-input\"\n                  :placeholder=\"$t('memory.newNamePlaceholder')\"\n                />\n                <span\n                  id=\"name-char-count\"\n                  class=\"char-count\"\n                  style=\"text-align: right; display: block; margin-top: 0.25rem\"\n                >\n                  {{ nameInput.length }}\n                </span>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button id=\"cancel-name\" class=\"modal-btn cancel-btn\" @click=\"closeNameModal\">\n                  {{ $t('memory.cancel') }}\n                </button>\n                <button id=\"save-name\" class=\"modal-btn confirm-btn\" @click=\"saveName\">\n                  {{ $t('memory.save') }}\n                </button>\n              </div>\n            </div>\n          </div>\n\n          <div\n            id=\"delete-modal\"\n            class=\"modal-overlay\"\n            v-if=\"showDeleteModal\"\n            @click.self=\"closeDeleteModal\"\n          >\n            <div class=\"modal-content\">\n              <div class=\"modal-header\">\n                <h3 class=\"modal-title\">{{ $t('memory.deleteHint') }}</h3>\n                <p class=\"state-text\" id=\"delete-message\">\n                  {{ $t('memory.deleteHintPrefix') }} {{ currentDeleteId }}\n                  {{ $t('memory.deleteHintSuffix') }}\n                </p>\n              </div>\n\n              <div class=\"modal-footer\">\n                <button id=\"cancel-delete\" class=\"modal-btn cancel-btn\" @click=\"closeDeleteModal\">\n                  {{ $t('memory.cancel') }}\n                </button>\n                <button\n                  id=\"confirm-delete\"\n                  class=\"modal-btn delete-btn-confirm\"\n                  @click=\"confirmDelete\"\n                >\n                  {{ $t('memory.delete') }}\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\n// Define component name to satisfy Vue linting rules\ndefineOptions({\n  name: 'MemoryPanel',\n})\nimport { onMounted, onUnmounted, ref } from 'vue'\nimport { MemoryApiService } from '@/api/memory-api-service'\nimport type { Memory } from '@/api/memory-api-service'\n\n// Extended interface for UI state\ninterface MemoryWithExpanded extends Memory {\n  expanded: boolean\n}\nimport { Icon } from '@iconify/vue'\nimport { memoryStore } from '@/stores/memory'\nimport type { MemoryEmits } from '@/stores/memory'\n\nconst showTitleEdit = ref(false)\nconst searchQuery = ref('')\nconst messages = ref<MemoryWithExpanded[]>([])\nconst filteredMessages = ref<MemoryWithExpanded[]>([])\n\nconst showNameModal = ref(false)\nconst currentEditMessageId = ref<string | null>(null)\nconst nameInput = ref('')\n\nconst showDeleteModal = ref(false)\nconst currentDeleteId = ref<string | null>(null)\nconst expandedMap = new Map()\nconst emit = defineEmits<MemoryEmits>()\n\n// Handle ESC key to close modals\nconst handleEscKey = (e: KeyboardEvent) => {\n  if (e.key === 'Escape') {\n    if (showDeleteModal.value) {\n      closeDeleteModal()\n    } else if (showNameModal.value) {\n      closeNameModal()\n    }\n  }\n}\n\nonMounted(() => {\n  memoryStore.setLoadMessages(loadMessages)\n  document.addEventListener('keydown', handleEscKey)\n})\n\nonUnmounted(() => {\n  document.removeEventListener('keydown', handleEscKey)\n})\n\nconst loadMessages = async () => {\n  try {\n    const mes = await MemoryApiService.getMemories()\n    messages.value = mes.map(\n      (mesMsg: Memory): MemoryWithExpanded => ({\n        ...mesMsg,\n        expanded: expandedMap.has(mesMsg.conversation_id)\n          ? expandedMap.get(mesMsg.conversation_id)\n          : false,\n      })\n    )\n    filteredMessages.value = [...messages.value]\n    handleSearch()\n  } catch (e) {\n    console.error('error:', e)\n    messages.value = []\n\n    filteredMessages.value = []\n  }\n}\n\nconst selectMemory = (conversationId: string) => {\n  memoryStore.selectMemory(conversationId)\n  emit('memory-selected')\n}\n\nconst formatTimestamp = (timestamp: number | string): string => {\n  const timestampNum = typeof timestamp === 'string' ? parseInt(timestamp, 10) : timestamp\n  if (isNaN(timestampNum) || timestampNum <= 0) {\n    return '--'\n  }\n  const date = new Date(timestampNum.toString().length === 13 ? timestampNum : timestampNum * 1000)\n\n  return date\n    .toLocaleString('zh-CN', {\n      year: 'numeric',\n      month: '2-digit',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit',\n      hour12: false,\n    })\n    .replace(',', ' ')\n}\n\nconst handleSearch = () => {\n  const query = searchQuery.value.toLowerCase().trim()\n\n  if (!query) {\n    filteredMessages.value = [...messages.value]\n    return\n  }\n\n  filteredMessages.value = messages.value.filter(message => {\n    const matchesName = message.memory_name.toLowerCase().includes(query)\n    const matchesId = message.conversation_id.toLowerCase().includes(query)\n    const matchesContent =\n      message.messages?.some(bubble => bubble.text.toLowerCase().includes(query)) ?? false\n    return matchesName || matchesId || matchesContent\n  })\n}\nconst closeNameModal = () => {\n  showNameModal.value = false\n  currentEditMessageId.value = null\n}\n\nconst saveName = async () => {\n  if (!currentEditMessageId.value) return\n  const newName = nameInput.value.trim() || 'unknow name'\n  const messageIndex = messages.value.findIndex(\n    msg => msg.conversation_id === currentEditMessageId.value\n  )\n  if (messageIndex !== -1) {\n    const currentMessage = messages.value[messageIndex]\n    try {\n      const returnMemory = await MemoryApiService.updateMemory(\n        currentMessage.conversation_id,\n        newName\n      )\n      if (!returnMemory.messages) {\n        returnMemory.messages = []\n      }\n      messages.value[messageIndex] = {\n        ...returnMemory,\n        expanded: currentMessage.expanded,\n      } as MemoryWithExpanded\n      handleSearch()\n      showNameModal.value = false\n    } catch (error) {\n      console.error('error:', error)\n    }\n  }\n}\n\nconst toggleMessage = (id: string) => {\n  const message = messages.value.find(msg => msg.conversation_id === id)\n  if (message) {\n    message.expanded = !message.expanded\n    expandedMap.set(id, message.expanded)\n    const filteredIndex = filteredMessages.value.findIndex(msg => msg.conversation_id === id)\n    if (filteredIndex !== -1) {\n      filteredMessages.value[filteredIndex] = { ...message }\n    }\n  }\n}\n\nconst showDeleteConfirm = (id: string) => {\n  currentDeleteId.value = id\n  showDeleteModal.value = true\n}\n\nconst closeDeleteModal = () => {\n  showDeleteModal.value = false\n  currentDeleteId.value = null\n}\n\nconst confirmDelete = async () => {\n  if (!currentDeleteId.value) return\n\n  try {\n    await MemoryApiService.deleteMemory(currentDeleteId.value)\n    messages.value = messages.value.filter(msg => msg.conversation_id !== currentDeleteId.value)\n    handleSearch()\n    if (messages.value.length === 0) {\n      memoryStore.clearMemoryId()\n    }\n    showDeleteModal.value = false\n    currentDeleteId.value = null\n  } catch (error) {\n    console.error('error:', error)\n  }\n}\n</script>\n\n<style scoped>\n* {\n  margin: 0;\n  padding: 0;\n  box-sizing: border-box;\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\n}\n\n.app-container {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.app-content {\n  position: relative;\n  transition: all 0.3s ease-in-out;\n  overflow-y: auto;\n  border-radius: 16px;\n  width: 90%;\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  max-width: 800px;\n  max-height: 80vh;\n  min-height: 500px;\n}\n\n.memory-wrapper-collapsed {\n  border-right: none;\n  width: 0;\n}\n\n.header {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.main-title {\n  font-size: 1.25rem;\n  font-weight: bold;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  -webkit-background-clip: text;\n  background-clip: text;\n  color: transparent;\n  display: flex;\n  align-items: center;\n  cursor: pointer;\n}\n\n.main-title i {\n  margin-right: 0.5rem;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n}\n\n.close-btn:hover {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.search-bar {\n  padding: 1rem;\n  border-bottom: 1px solid #333333;\n}\n\n.search-container {\n  position: relative;\n}\n.search-container-icon {\n  position: absolute;\n  top: 10px;\n  left: 8px;\n}\n\n.search-input {\n  width: 100%;\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.5rem 0.5rem 2.5rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: #667eea;\n}\n\n.search-icon {\n  position: absolute;\n  left: 0.75rem;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #888888;\n}\n\n.message-list {\n  flex: 1;\n  overflow-y: auto;\n  padding: 0.5rem;\n}\n\n.message-item {\n  background-color: #2d2d2d;\n  border: 1px solid #333333;\n  border-radius: 0.5rem;\n  overflow: hidden;\n  margin-bottom: 0.5rem;\n  transition: all 0.2s ease;\n}\n\n.message-item:hover {\n  background-color: #333333;\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n.message-header {\n  cursor: text;\n  padding: 0.75rem;\n  align-items: center;\n  width: 100%;\n}\n\n.message-content {\n  flex: 1;\n  min-width: 0;\n  padding-right: 0.5rem;\n}\n.message.user .message-content {\n  flex: none !important;\n}\n\n.sender-info {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin-bottom: 0.25rem;\n}\n\n.sender-div {\n  display: flex;\n  align-items: center;\n  width: 85%;\n  cursor: pointer;\n}\n\n.sender-div:hover .sender-name {\n  color: #667eea;\n}\n\n.sender-name {\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.message-meta {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n  margin-top: 0.25rem;\n}\n\n.meta-right {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n}\n\n.message-id {\n  font-size: 0.75rem;\n  color: #667eea;\n}\n\n.message-time {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n  white-space: nowrap;\n}\n\n.unread-count {\n  font-size: 0.75rem;\n  background-color: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  padding: 0.125rem 0.375rem;\n  margin-top: 2px;\n  border-radius: 1rem;\n}\n\n.action-buttons {\n  margin-left: 0.5rem;\n  transition: opacity 0.2s ease;\n}\n\n.message-item:hover .action-buttons {\n  opacity: 1;\n}\n\n.down-btn {\n  cursor: pointer;\n}\n\n.down-btn:hover {\n  color: #667eea;\n}\n\n.delete-btn {\n  color: rgba(255, 255, 255, 0.7);\n  background: none;\n  border: none;\n  cursor: pointer;\n  padding: 0.25rem 0;\n  font-size: 1rem;\n}\n\n.delete-btn:hover {\n  color: #ff6b6b;\n}\n\n.expanded-content {\n  background-color: #333333;\n  border-top: 1px solid #444444;\n  padding: 0.75rem;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.bubble-avatar {\n  width: 5rem;\n  overflow: hidden;\n  margin-right: 0.5rem;\n  flex-shrink: 0;\n  margin-bottom: 6px;\n  font-size: 16px;\n  color: rgba(255, 255, 255, 0.8);\n  font-weight: 500;\n}\n\n.bubble-avatar img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.bubble-content {\n  padding: 8px;\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n}\n\n.bubble-text {\n  font-size: 12px;\n  margin-bottom: 0.25rem;\n}\n\n.state-text {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 50;\n}\n\n.modal-content {\n  background-color: #2d2d2d;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  width: 100%;\n  max-width: 28rem;\n  padding: 1.25rem;\n  transition: all 0.3s ease;\n}\n\n.modal-header {\n  text-align: center;\n  margin-bottom: 1rem;\n}\n\n.modal-title {\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 0.5rem;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: space-between;\n  gap: 0.75rem;\n}\n\n.modal-btn {\n  flex: 1;\n  padding: 0.5rem;\n  border-radius: 0.25rem;\n  font-size: 0.875rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #333333;\n  border: 1px solid #444444;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.cancel-btn:hover {\n  background-color: #444444;\n}\n\n.confirm-btn {\n  background-color: #667eea;\n  color: #ffffff;\n}\n\n.confirm-btn:hover {\n  background-color: rgba(102, 126, 234, 0.9);\n}\n\n.delete-btn-confirm {\n  background-color: #ff6b6b;\n  color: #ffffff;\n}\n\n.delete-btn-confirm:hover {\n  background-color: #ff5252;\n}\n\n.edit-input {\n  width: 100%;\n  background-color: #333333;\n  border: 1px solid #444444;\n  border-radius: 0.5rem;\n  padding: 0.5rem 0.75rem;\n  color: #ffffff;\n  font-size: 0.875rem;\n}\n\n.edit-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n}\n\n.char-count {\n  font-size: 0.75rem;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n\n@keyframes fadeInOut {\n  0% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n  20% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  80% {\n    opacity: 1;\n    transform: translateY(0) translateX(-50%);\n  }\n  100% {\n    opacity: 0;\n    transform: translateY(-20px) translateX(-50%);\n  }\n}\n\n@media (max-width: 640px) {\n  .main-title {\n    font-size: 1.125rem;\n  }\n\n  .message-id {\n    display: none;\n  }\n\n  .message-time {\n    font-size: 0.7rem;\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Define interface types\nexport interface FileNode {\n  name: string\n  path: string\n  type: 'file' | 'directory'\n  size: number\n  lastModified: string\n  children?: FileNode[]\n}\n\nexport interface FileContent {\n  content: string\n  mimeType: string\n  size: number\n}\n\nexport interface ApiResponse<T> {\n  success: boolean\n  data?: T\n  message?: string\n}\n\n/**\n * File Browser API service class\n * Responsible for interacting with backend FileBrowserController\n */\nexport class FileBrowserApiService {\n  private static readonly BASE_URL = '/api/file-browser'\n\n  /**\n   * Handle HTTP response\n   */\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message ?? `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n\n  /**\n   * Get file tree for a specific plan ID\n   */\n  static async getFileTree(planId: string): Promise<FileNode> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/tree/${planId}`)\n      const result = await this.handleResponse(response)\n      const apiResponse: ApiResponse<FileNode> = await result.json()\n\n      if (!apiResponse.success) {\n        throw new Error(apiResponse.message ?? 'Failed to get file tree')\n      }\n\n      return apiResponse.data!\n    } catch (error) {\n      console.error('Failed to get file tree:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Get file content\n   */\n  static async getFileContent(planId: string, filePath: string): Promise<FileContent> {\n    try {\n      const response = await fetch(\n        `${this.BASE_URL}/content/${planId}?path=${encodeURIComponent(filePath)}`\n      )\n      const result = await this.handleResponse(response)\n      const apiResponse: ApiResponse<FileContent> = await result.json()\n\n      if (!apiResponse.success) {\n        throw new Error(apiResponse.message ?? 'Failed to get file content')\n      }\n\n      return apiResponse.data!\n    } catch (error) {\n      console.error('Failed to get file content:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Download file\n   */\n  static async downloadFile(planId: string, filePath: string, fileName?: string): Promise<void> {\n    try {\n      const response = await fetch(\n        `${this.BASE_URL}/download/${planId}?path=${encodeURIComponent(filePath)}`\n      )\n      await this.handleResponse(response)\n\n      const blob = await response.blob()\n      const url = window.URL.createObjectURL(blob)\n      const a = document.createElement('a')\n      a.href = url\n      a.download = fileName ?? filePath.split('/').pop() ?? 'download'\n      document.body.appendChild(a)\n      a.click()\n      window.URL.revokeObjectURL(url)\n      document.body.removeChild(a)\n    } catch (error) {\n      console.error('Failed to download file:', error)\n      throw error\n    }\n  }\n\n  /**\n   * Check if file is text-based (can be displayed in editor)\n   */\n  static isTextFile(mimeType: string, fileName: string): boolean {\n    const textMimeTypes = [\n      'text/',\n      'application/json',\n      'application/xml',\n      'application/javascript',\n      'application/typescript',\n    ]\n\n    const textExtensions = [\n      '.txt',\n      '.md',\n      '.json',\n      '.xml',\n      '.html',\n      '.css',\n      '.js',\n      '.ts',\n      '.vue',\n      '.jsx',\n      '.tsx',\n      '.py',\n      '.java',\n      '.cpp',\n      '.c',\n      '.h',\n      '.sh',\n      '.bat',\n      '.yml',\n      '.yaml',\n      '.properties',\n      '.conf',\n      '.cfg',\n    ]\n\n    // Check mime type\n    if (textMimeTypes.some(type => mimeType.startsWith(type))) {\n      return true\n    }\n\n    // Check file extension\n    const lowerFileName = fileName.toLowerCase()\n    return textExtensions.some(ext => lowerFileName.endsWith(ext))\n  }\n\n  /**\n   * Get file icon based on file type\n   */\n  static getFileIcon(node: FileNode): string {\n    if (node.type === 'directory') {\n      return 'carbon:folder'\n    }\n\n    const fileName = node.name.toLowerCase()\n\n    // Programming languages\n    if (fileName.endsWith('.js')) return 'vscode-icons:file-type-js'\n    if (fileName.endsWith('.ts')) return 'vscode-icons:file-type-typescript'\n    if (fileName.endsWith('.vue')) return 'vscode-icons:file-type-vue'\n    if (fileName.endsWith('.java')) return 'vscode-icons:file-type-java'\n    if (fileName.endsWith('.py')) return 'vscode-icons:file-type-python'\n    if (fileName.endsWith('.json')) return 'vscode-icons:file-type-json'\n    if (fileName.endsWith('.xml')) return 'vscode-icons:file-type-xml'\n    if (fileName.endsWith('.html')) return 'vscode-icons:file-type-html'\n    if (fileName.endsWith('.css')) return 'vscode-icons:file-type-css'\n    if (fileName.endsWith('.md')) return 'vscode-icons:file-type-markdown'\n    if (fileName.endsWith('.yml') || fileName.endsWith('.yaml'))\n      return 'vscode-icons:file-type-yaml'\n\n    // Documents\n    if (fileName.endsWith('.pdf')) return 'vscode-icons:file-type-pdf2'\n    if (fileName.endsWith('.doc') || fileName.endsWith('.docx'))\n      return 'vscode-icons:file-type-word'\n    if (fileName.endsWith('.xls') || fileName.endsWith('.xlsx'))\n      return 'vscode-icons:file-type-excel'\n    if (fileName.endsWith('.ppt') || fileName.endsWith('.pptx'))\n      return 'vscode-icons:file-type-powerpoint'\n\n    // Images\n    if (fileName.match(/\\.(jpg|jpeg|png|gif|bmp|svg)$/)) return 'carbon:image'\n\n    // Archives\n    if (fileName.match(/\\.(zip|rar|7z|tar|gz)$/)) return 'carbon:archive'\n\n    // Default file icon\n    return 'carbon:document'\n  }\n}\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-tree-node\">\n    <div\n      class=\"node-content\"\n      :class=\"{\n        'is-directory': node.type === 'directory',\n        'is-file': node.type === 'file',\n        'is-expanded': isExpanded,\n      }\"\n      :style=\"{ paddingLeft: `${level * 16 + 12}px` }\"\n      @click=\"handleClick\"\n      @contextmenu.prevent=\"handleRightClick\"\n    >\n      <!-- Expand/Collapse Icon for directories -->\n      <div v-if=\"node.type === 'directory'\" class=\"expand-icon\" @click.stop=\"toggleExpanded\">\n        <Icon\n          :icon=\"isExpanded ? 'carbon:chevron-down' : 'carbon:chevron-right'\"\n          class=\"chevron-icon\"\n        />\n      </div>\n\n      <!-- File/Directory Icon -->\n      <div class=\"node-icon\">\n        <Icon :icon=\"getNodeIcon()\" />\n      </div>\n\n      <!-- Name -->\n      <span class=\"node-name\">{{ node.name }}</span>\n\n      <!-- File size for files -->\n      <span v-if=\"node.type === 'file'\" class=\"file-size\">\n        {{ formatFileSize(node.size) }}\n      </span>\n\n      <!-- Actions -->\n      <div class=\"node-actions\" v-if=\"showActions\">\n        <button\n          v-if=\"node.type === 'file'\"\n          @click.stop=\"$emit('download-file', node)\"\n          class=\"action-btn download-btn\"\n          title=\"Download\"\n        >\n          <Icon icon=\"carbon:download\" />\n        </button>\n      </div>\n    </div>\n\n    <!-- Children (for directories) -->\n    <div v-if=\"node.type === 'directory' && isExpanded && node.children\" class=\"children\">\n      <FileTreeNode\n        v-for=\"child in node.children\"\n        :key=\"child.path\"\n        :node=\"child\"\n        :level=\"level + 1\"\n        @file-selected=\"$emit('file-selected', $event)\"\n        @download-file=\"$emit('download-file', $event)\"\n      />\n    </div>\n\n    <!-- Context Menu -->\n    <div v-if=\"showContextMenu\" class=\"context-menu\" :style=\"contextMenuStyle\" @click.stop>\n      <div class=\"context-menu-item\" @click=\"handleFileSelect\">\n        <Icon icon=\"carbon:view\" />\n        <span>Open</span>\n      </div>\n      <div v-if=\"node.type === 'file'\" class=\"context-menu-item\" @click=\"handleDownload\">\n        <Icon icon=\"carbon:download\" />\n        <span>Download</span>\n      </div>\n      <div class=\"context-menu-divider\"></div>\n      <div class=\"context-menu-item\" @click=\"copyPath\">\n        <Icon icon=\"carbon:copy\" />\n        <span>Copy Path</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ref, onUnmounted } from 'vue'\nimport { Icon } from '@iconify/vue'\nimport { FileBrowserApiService, type FileNode } from '@/api/file-browser-api-service'\n\ninterface Props {\n  node: FileNode\n  level: number\n}\n\ninterface Emits {\n  (e: 'file-selected', file: FileNode): void\n  (e: 'download-file', file: FileNode): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n// const { t } = useI18n()\n\n// State\nconst isExpanded = ref(props.level === 0) // Root directory expanded by default\nconst showActions = ref(false)\nconst showContextMenu = ref(false)\nconst contextMenuStyle = ref({})\n\n// Computed\n// const hasChildren = computed(() => {\n//   return props.node.type === 'directory' && props.node.children && props.node.children.length > 0\n// })\n\n// Methods\nconst toggleExpanded = () => {\n  if (props.node.type === 'directory') {\n    isExpanded.value = !isExpanded.value\n  }\n}\n\nconst handleClick = () => {\n  if (props.node.type === 'directory') {\n    toggleExpanded()\n  } else {\n    handleFileSelect()\n  }\n}\n\nconst handleFileSelect = () => {\n  if (props.node.type === 'file') {\n    emit('file-selected', props.node)\n  }\n  hideContextMenu()\n}\n\nconst handleDownload = () => {\n  emit('download-file', props.node)\n  hideContextMenu()\n}\n\nconst handleRightClick = (event: MouseEvent) => {\n  event.preventDefault()\n  showContextMenu.value = true\n\n  // Position context menu\n  // const rect = (event.target as HTMLElement).getBoundingClientRect()\n  contextMenuStyle.value = {\n    position: 'fixed',\n    top: `${event.clientY}px`,\n    left: `${event.clientX}px`,\n    zIndex: 1000,\n  }\n\n  // Add click listener to hide context menu\n  setTimeout(() => {\n    document.addEventListener('click', hideContextMenu)\n  }, 0)\n}\n\nconst hideContextMenu = () => {\n  showContextMenu.value = false\n  document.removeEventListener('click', hideContextMenu)\n}\n\nconst copyPath = async () => {\n  try {\n    await navigator.clipboard.writeText(props.node.path)\n    // You could show a toast message here\n  } catch (err) {\n    console.error('Failed to copy path:', err)\n  }\n  hideContextMenu()\n}\n\nconst getNodeIcon = () => {\n  if (props.node.type === 'directory') {\n    return isExpanded.value ? 'carbon:folder-open' : 'carbon:folder'\n  }\n  return FileBrowserApiService.getFileIcon(props.node)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Lifecycle\nonUnmounted(() => {\n  document.removeEventListener('click', hideContextMenu)\n})\n</script>\n\n<style scoped>\n.file-tree-node {\n  position: relative;\n}\n\n.node-content {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 6px 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 6px;\n  margin: 1px 8px;\n  position: relative;\n}\n\n.node-content:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.node-content.is-directory {\n  font-weight: 500;\n}\n\n.expand-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 16px;\n  height: 16px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.7);\n  transition: color 0.2s ease;\n}\n\n.expand-icon:hover {\n  color: #ffffff;\n}\n\n.chevron-icon {\n  font-size: 12px;\n  transition: transform 0.2s ease;\n}\n\n.node-icon {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 18px;\n  height: 18px;\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.node-icon .iconify {\n  font-size: 16px;\n}\n\n.node-name {\n  flex: 1;\n  color: #ffffff;\n  font-size: 13px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.5);\n  font-size: 11px;\n  white-space: nowrap;\n}\n\n.node-actions {\n  display: flex;\n  gap: 4px;\n  opacity: 0;\n  transition: opacity 0.2s ease;\n}\n\n.node-content:hover .node-actions {\n  opacity: 1;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 20px;\n  height: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.action-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  color: #ffffff;\n}\n\n.action-btn .iconify {\n  font-size: 12px;\n}\n\n.children {\n  overflow: hidden;\n}\n\n.context-menu {\n  background: rgba(20, 20, 20, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(20px);\n  padding: 6px;\n  min-width: 160px;\n}\n\n.context-menu-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  cursor: pointer;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 13px;\n  transition: background-color 0.2s ease;\n}\n\n.context-menu-item:hover {\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.context-menu-item .iconify {\n  font-size: 14px;\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.context-menu-divider {\n  height: 1px;\n  background: rgba(255, 255, 255, 0.1);\n  margin: 4px 0;\n}\n\n/* Directory specific styles */\n.node-content.is-directory .node-name {\n  color: #ffffff;\n  font-weight: 500;\n}\n\n.node-content.is-directory.is-expanded .node-icon {\n  color: #677eea;\n}\n\n/* File specific styles */\n.node-content.is-file .node-name {\n  color: rgba(255, 255, 255, 0.9);\n}\n\n/* Animation for expanding/collapsing */\n.children {\n  animation: slideDown 0.2s ease-out;\n}\n\n@keyframes slideDown {\n  from {\n    opacity: 0;\n    transform: translateY(-10px);\n  }\n  to {\n    opacity: 1;\n    transform: translateY(0);\n  }\n}\n</style>\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"file-browser\">\n    <div class=\"file-browser-header\">\n      <h3>{{ $t('fileBrowser.title') }}</h3>\n      <div class=\"header-actions\">\n        <button\n          class=\"refresh-btn\"\n          @click=\"refreshFileTree\"\n          :disabled=\"loading\"\n          :title=\"$t('fileBrowser.refresh')\"\n        >\n          <Icon\n            icon=\"carbon:refresh\"\n            :class=\"{ rotating: loading }\"\n            :style=\"{ color: '#ffffff', fontSize: '18px', width: '18px', height: '18px' }\"\n          />\n        </button>\n      </div>\n    </div>\n\n    <div class=\"file-browser-content\">\n      <!-- File Tree -->\n      <div class=\"file-tree-panel\">\n        <div v-if=\"loading\" class=\"loading-state\">\n          <Icon icon=\"carbon:loading\" class=\"rotating\" />\n          <span>{{ $t('fileBrowser.loading') }}</span>\n        </div>\n\n        <div v-else-if=\"error\" class=\"error-state\">\n          <div v-if=\"isPlanDirectoryNotFound\" class=\"waiting-for-files\">\n            <Icon icon=\"carbon:time\" class=\"rotating\" />\n            <div class=\"message-content\">\n              <h3>{{ $t('fileBrowser.waitingForGeneration') }}</h3>\n              <p>{{ $t('fileBrowser.planExecuting') }}</p>\n              <div class=\"tips\">\n                <Icon icon=\"carbon:information\" />\n                <span>{{ $t('fileBrowser.filesTip') }}</span>\n              </div>\n            </div>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\" :disabled=\"loading\">\n              <Icon icon=\"carbon:refresh\" :class=\"{ rotating: loading }\" />\n              {{ loading ? $t('fileBrowser.checking') : $t('fileBrowser.checkNow') }}\n            </button>\n          </div>\n          <div v-else class=\"actual-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ error }}</span>\n            <button @click=\"refreshFileTree\" class=\"retry-btn\">\n              {{ $t('fileBrowser.retry') }}\n            </button>\n          </div>\n        </div>\n\n        <div v-else-if=\"!fileTree\" class=\"empty-state\">\n          <Icon icon=\"carbon:folder-off\" />\n          <span>{{ $t('fileBrowser.noFiles') }}</span>\n        </div>\n\n        <div v-else class=\"file-tree\">\n          <FileTreeNode\n            :node=\"fileTree\"\n            :level=\"0\"\n            @file-selected=\"handleFileSelected\"\n            @download-file=\"handleDownloadFile\"\n          />\n        </div>\n      </div>\n\n      <!-- File Content Viewer -->\n      <div class=\"file-content-panel\" v-if=\"selectedFile\">\n        <div class=\"file-content-header\">\n          <div class=\"file-info\">\n            <Icon :icon=\"getFileIcon(selectedFile)\" />\n            <span class=\"file-name\">{{ selectedFile.name }}</span>\n            <span class=\"file-size\">({{ formatFileSize(selectedFile.size) }})</span>\n          </div>\n          <div class=\"file-actions\">\n            <button\n              @click=\"handleDownloadFile(selectedFile)\"\n              class=\"download-btn\"\n              :title=\"$t('fileBrowser.download')\"\n            >\n              <Icon icon=\"carbon:download\" />\n            </button>\n            <button @click=\"closeFileViewer\" class=\"close-btn\" :title=\"$t('common.close')\">\n              <Icon icon=\"carbon:close\" />\n            </button>\n          </div>\n        </div>\n\n        <div class=\"file-content-body\">\n          <div v-if=\"loadingContent\" class=\"loading-content\">\n            <Icon icon=\"carbon:loading\" class=\"rotating\" />\n            <span>{{ $t('fileBrowser.loadingContent') }}</span>\n          </div>\n\n          <div v-else-if=\"contentError\" class=\"content-error\">\n            <Icon icon=\"carbon:warning\" />\n            <span>{{ contentError }}</span>\n          </div>\n\n          <div v-else-if=\"fileContent\" class=\"file-content\">\n            <div v-if=\"isTextFile\" class=\"text-content\">\n              <pre><code>{{ fileContent.content }}</code></pre>\n            </div>\n            <div v-else class=\"binary-content\">\n              <Icon icon=\"carbon:document-unknown\" />\n              <p>{{ $t('fileBrowser.binaryFile') }}</p>\n              <button @click=\"handleDownloadFile(selectedFile)\" class=\"download-btn-large\">\n                <Icon icon=\"carbon:download\" />\n                {{ $t('fileBrowser.downloadToView') }}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n// Define component name to satisfy Vue linting rules\ndefineOptions({\n  name: 'FileBrowser',\n})\nimport { ref, computed, onMounted, onUnmounted, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { Icon } from '@iconify/vue'\nimport FileTreeNode from './FileTreeNode.vue'\nimport {\n  FileBrowserApiService,\n  type FileNode,\n  type FileContent,\n} from '@/api/file-browser-api-service'\n\ninterface Props {\n  planId: string\n}\n\nconst props = defineProps<Props>()\nconst { t } = useI18n()\n\n// State\nconst loading = ref(false)\nconst error = ref<string | null>(null)\nconst fileTree = ref<FileNode | null>(null)\nconst selectedFile = ref<FileNode | null>(null)\nconst fileContent = ref<FileContent | null>(null)\nconst loadingContent = ref(false)\nconst contentError = ref<string | null>(null)\nconst autoRefreshTimer = ref<number | null>(null)\n\n// Computed\nconst isTextFile = computed(() => {\n  if (!fileContent.value || !selectedFile.value) return false\n  return FileBrowserApiService.isTextFile(fileContent.value.mimeType, selectedFile.value.name)\n})\n\nconst isPlanDirectoryNotFound = computed(() => {\n  return (\n    error.value &&\n    (error.value.includes('Plan directory not found') || error.value.includes('not found'))\n  )\n})\n\n// Methods\nconst clearAutoRefresh = () => {\n  if (autoRefreshTimer.value) {\n    clearTimeout(autoRefreshTimer.value)\n    autoRefreshTimer.value = null\n  }\n}\n\nconst startAutoRefresh = () => {\n  clearAutoRefresh()\n  // Auto refresh every 5 seconds when plan directory is not found\n  autoRefreshTimer.value = window.setTimeout(() => {\n    if (isPlanDirectoryNotFound.value) {\n      refreshFileTree()\n    }\n  }, 5000)\n}\n\nconst refreshFileTree = async () => {\n  if (!props.planId) return\n\n  loading.value = true\n  error.value = null\n  clearAutoRefresh()\n\n  try {\n    fileTree.value = await FileBrowserApiService.getFileTree(props.planId)\n    // Success - no need to auto refresh\n  } catch (err) {\n    error.value = err instanceof Error ? err.message : t('fileBrowser.loadError')\n    console.error('Failed to load file tree:', err)\n\n    // Start auto refresh if it's a \"directory not found\" error\n    const errorMessage = err instanceof Error ? err.message : ''\n    if (errorMessage.includes('Plan directory not found') || errorMessage.includes('not found')) {\n      startAutoRefresh()\n    }\n  } finally {\n    loading.value = false\n  }\n}\n\nconst handleFileSelected = async (file: FileNode) => {\n  if (file.type === 'directory') return\n\n  selectedFile.value = file\n  fileContent.value = null\n  loadingContent.value = true\n  contentError.value = null\n\n  try {\n    fileContent.value = await FileBrowserApiService.getFileContent(props.planId, file.path)\n  } catch (err) {\n    contentError.value = err instanceof Error ? err.message : t('fileBrowser.contentLoadError')\n    console.error('Failed to load file content:', err)\n  } finally {\n    loadingContent.value = false\n  }\n}\n\nconst handleDownloadFile = async (file: FileNode) => {\n  try {\n    await FileBrowserApiService.downloadFile(props.planId, file.path, file.name)\n  } catch (err) {\n    console.error('Failed to download file:', err)\n    // You could show a toast message here\n  }\n}\n\nconst closeFileViewer = () => {\n  selectedFile.value = null\n  fileContent.value = null\n  contentError.value = null\n}\n\nconst getFileIcon = (file: FileNode) => {\n  return FileBrowserApiService.getFileIcon(file)\n}\n\nconst formatFileSize = (bytes: number): string => {\n  if (bytes === 0) return '0 B'\n  const k = 1024\n  const sizes = ['B', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i]\n}\n\n// Watch for plan ID changes\nwatch(\n  () => props.planId,\n  newPlanId => {\n    if (newPlanId) {\n      selectedFile.value = null\n      fileContent.value = null\n      refreshFileTree()\n    }\n  },\n  { immediate: true }\n)\n\n// Lifecycle\nonMounted(() => {\n  if (props.planId) {\n    refreshFileTree()\n  }\n})\n\nonUnmounted(() => {\n  clearAutoRefresh()\n})\n</script>\n\n<style scoped>\n.file-browser {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  background: rgba(255, 255, 255, 0.02);\n  border-radius: 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  overflow: hidden;\n}\n\n.file-browser-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-browser-header h3 {\n  margin: 0;\n  color: #ffffff;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.header-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.refresh-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  background: rgba(255, 255, 255, 0.15);\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  border-radius: 8px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 18px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n}\n\n.refresh-btn .iconify {\n  color: #ffffff !important;\n  font-size: 18px !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn svg {\n  fill: #ffffff !important;\n  color: #ffffff !important;\n  width: 18px !important;\n  height: 18px !important;\n}\n\n.refresh-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.25);\n  border-color: rgba(255, 255, 255, 0.4);\n  transform: translateY(-1px);\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);\n}\n\n.refresh-btn:hover:not(:disabled) .iconify,\n.refresh-btn:hover:not(:disabled) svg {\n  color: #ffffff !important;\n  fill: #ffffff !important;\n}\n\n.refresh-btn:active:not(:disabled) {\n  transform: translateY(0);\n}\n\n.refresh-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.15);\n}\n\n.refresh-btn:disabled .iconify,\n.refresh-btn:disabled svg {\n  color: rgba(255, 255, 255, 0.4) !important;\n  fill: rgba(255, 255, 255, 0.4) !important;\n}\n\n.file-browser-content {\n  display: flex;\n  flex: 1;\n  min-height: 0;\n}\n\n.file-tree-panel {\n  flex: 0 0 300px;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  overflow-y: auto;\n}\n\n.file-content-panel {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-width: 0;\n}\n\n.loading-state,\n.error-state,\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.loading-state .iconify,\n.error-state .iconify,\n.empty-state .iconify {\n  font-size: 32px;\n}\n\n.retry-btn {\n  padding: 8px 16px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 6px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.retry-btn:hover {\n  background: rgba(103, 126, 234, 0.3);\n}\n\n.retry-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.waiting-for-files {\n  color: #74c0fc;\n}\n\n.waiting-for-files .iconify {\n  font-size: 48px;\n  margin-bottom: 20px;\n  opacity: 0.8;\n}\n\n.waiting-for-files .message-content {\n  margin-bottom: 24px;\n  text-align: center;\n}\n\n.waiting-for-files h3 {\n  margin: 0 0 8px 0;\n  color: #ffffff;\n  font-size: 18px;\n  font-weight: 600;\n}\n\n.waiting-for-files p {\n  margin: 0 0 16px 0;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.waiting-for-files .tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(116, 192, 252, 0.1);\n  border: 1px solid rgba(116, 192, 252, 0.2);\n  border-radius: 8px;\n  color: #74c0fc;\n  font-size: 13px;\n}\n\n.waiting-for-files .tips .iconify {\n  font-size: 16px;\n  margin: 0;\n}\n\n.actual-error {\n  color: #ff6b6b;\n}\n\n.file-tree {\n  padding: 8px 0;\n}\n\n.file-content-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-info {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  color: #ffffff;\n}\n\n.file-info .iconify {\n  font-size: 18px;\n}\n\n.file-name {\n  font-weight: 600;\n}\n\n.file-size {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 12px;\n}\n\n.file-actions {\n  display: flex;\n  gap: 8px;\n}\n\n.download-btn,\n.close-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.download-btn:hover,\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.15);\n  transform: translateY(-1px);\n}\n\n.file-content-body {\n  flex: 1;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n\n.loading-content,\n.content-error {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 12px;\n}\n\n.file-content {\n  flex: 1;\n  overflow: hidden;\n}\n\n.text-content {\n  height: 100%;\n  overflow: auto;\n  padding: 20px;\n}\n\n.text-content pre {\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 13px;\n  line-height: 1.6;\n  color: #ffffff;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n}\n\n.binary-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  flex: 1;\n  color: rgba(255, 255, 255, 0.7);\n  gap: 16px;\n}\n\n.binary-content .iconify {\n  font-size: 48px;\n}\n\n.download-btn-large {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 24px;\n  background: rgba(103, 126, 234, 0.2);\n  border: 1px solid rgba(103, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #677eea;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n}\n\n.download-btn-large:hover {\n  background: rgba(103, 126, 234, 0.3);\n  transform: translateY(-1px);\n}\n\n.rotating {\n  animation: rotate 1s linear infinite;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Scrollbar styling */\n.file-tree-panel::-webkit-scrollbar,\n.text-content::-webkit-scrollbar {\n  width: 6px;\n}\n\n.file-tree-panel::-webkit-scrollbar-track,\n.text-content::-webkit-scrollbar-track {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb,\n.text-content::-webkit-scrollbar-thumb {\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 3px;\n}\n\n.file-tree-panel::-webkit-scrollbar-thumb:hover,\n.text-content::-webkit-scrollbar-thumb:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n</style>\n","/**\n * Plan Parameter API Service\n * Handles API calls for plan parameter requirements\n */\n\nexport interface ParameterRequirements {\n  parameters: string[]\n  hasParameters: boolean\n  requirements: string\n}\n\nexport class PlanParameterApiService {\n  private static readonly BASE_URL = '/api/plan-template'\n\n  /**\n   * Get parameter requirements for a plan template\n   * @param planTemplateId The plan template ID\n   * @returns Parameter requirements\n   */\n  static async getParameterRequirements(planTemplateId: string): Promise<ParameterRequirements> {\n    try {\n      const response = await fetch(`${this.BASE_URL}/${planTemplateId}/parameters`, {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      })\n\n      if (!response.ok) {\n        throw new Error(`Failed to get parameter requirements: ${response.statusText}`)\n      }\n\n      const data = await response.json()\n      return data\n    } catch (error) {\n      console.error('Error getting parameter requirements:', error)\n      throw error\n    }\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Tool } from '@/types/tool'\n\n/**\n * Tool API service class\n * Provides basic tool-related functionality without agent dependencies\n */\nexport class ToolApiService {\n  /**\n   * Handle HTTP response\n   */\n  private static async handleResponse(response: Response) {\n    if (!response.ok) {\n      try {\n        const errorData = await response.json()\n        throw new Error(errorData.message || `API request failed: ${response.status}`)\n      } catch {\n        throw new Error(`API request failed: ${response.status} ${response.statusText}`)\n      }\n    }\n    return response\n  }\n\n  /**\n   * Get available tools from backend API\n   */\n  static async getAvailableTools(): Promise<Tool[]> {\n    try {\n      const response = await fetch('/api/tools')\n      const result = await this.handleResponse(response)\n      return await result.json()\n    } catch (error) {\n      console.error('Failed to get available tools:', error)\n      throw error\n    }\n  }\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { ToolApiService } from '@/api/tool-api-service'\nimport type { Tool } from '@/types/tool'\nimport { ref } from 'vue'\n\nexport interface AvailableTool {\n  key: string\n  name: string\n  description: string\n  enabled: boolean\n  serviceGroup: string\n  selectable: boolean\n}\n\n/**\n * Composable for managing available tools\n * Provides state and methods for loading and managing available tools\n */\nexport function useAvailableTools() {\n  // Available tools state\n  const availableTools = ref<AvailableTool[]>([])\n  const isLoading = ref(false)\n  const error = ref<string | null>(null)\n\n  // Load available tools from backend\n  const loadAvailableTools = async () => {\n    if (isLoading.value) {\n      return // Avoid duplicate requests\n    }\n\n    isLoading.value = true\n    error.value = null\n\n    try {\n      console.log('[useAvailableTools] Loading available tools...')\n      const tools = await ToolApiService.getAvailableTools()\n      console.log('[useAvailableTools] Loaded available tools:', tools)\n      // Transform tools to ensure they have all required fields\n      // Filter out tools that are not selectable (enableInternalToolcall = false)\n      availableTools.value = tools\n        .filter((tool: Tool) => tool.selectable !== false)\n        .map((tool: Tool) => ({\n          key: tool.key || '', // Use the qualified key from backend (serviceGroup.toolName)\n          name: tool.name || '',\n          description: tool.description || '',\n          enabled: tool.enabled || false,\n          serviceGroup: tool.serviceGroup || 'default',\n          selectable: tool.selectable,\n        }))\n    } catch (err) {\n      console.error('[useAvailableTools] Error loading tools:', err)\n      error.value = err instanceof Error ? err.message : 'Unknown error'\n      availableTools.value = []\n    } finally {\n      isLoading.value = false\n    }\n  }\n\n  // Reset tools state\n  const reset = () => {\n    availableTools.value = []\n    isLoading.value = false\n    error.value = null\n  }\n\n  return {\n    // State\n    availableTools,\n    isLoading,\n    error,\n\n    // Actions\n    loadAvailableTools,\n    reset,\n  }\n}\n\n// Singleton instance for global use\nlet singletonInstance: ReturnType<typeof useAvailableTools> | null = null\n\n/**\n * Get or create singleton instance of useAvailableTools\n */\nexport function useAvailableToolsSingleton() {\n  if (!singletonInstance) {\n    singletonInstance = useAvailableTools()\n  }\n  return singletonInstance\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal v-model=\"showModal\" :title=\"modalTitle\" @confirm=\"handlePublish\">\n    <div class=\"modal-form wide-modal\">\n      <!-- Tool Description -->\n      <div class=\"form-section\">\n        <div class=\"form-item\">\n          <label>{{ t('mcpService.toolDescriptionRequired') }}</label>\n          <textarea\n            v-model=\"formData.userRequest\"\n            :placeholder=\"t('mcpService.toolDescriptionPlaceholder')\"\n            :class=\"{ error: !formData.userRequest || !formData.userRequest.trim() }\"\n            class=\"description-field\"\n            rows=\"4\"\n            required\n          />\n          <div class=\"field-description\">{{ t('mcpService.toolDescriptionDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Parameter Configuration -->\n      <div class=\"form-section\">\n        <div class=\"section-title\">{{ t('mcpService.parameterConfig') }}</div>\n\n        <!-- Parameter Requirements Help Text -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n\n        <div class=\"parameter-table\">\n          <table>\n            <thead>\n              <tr>\n                <th>{{ t('mcpService.parameterName') }}</th>\n                <th>{{ t('mcpService.parameterDescription') }}</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(param, index) in formData.parameters\" :key=\"index\">\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.name\"\n                    :placeholder=\"t('mcpService.parameterName')\"\n                    class=\"parameter-input\"\n                    :readonly=\"parameterRequirements.hasParameters\"\n                    :class=\"{ 'readonly-input': parameterRequirements.hasParameters }\"\n                    required\n                  />\n                </td>\n                <td>\n                  <input\n                    type=\"text\"\n                    v-model=\"param.description\"\n                    :placeholder=\"t('mcpService.parameterDescription')\"\n                    class=\"parameter-input\"\n                    required\n                  />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      <!-- Service Publishing Options -->\n      <div class=\"form-section\">\n        <div class=\"service-publish-options\">\n          <!-- Internal Toolcall Publishing Option -->\n          <div class=\"internal-toolcall-publish-option\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"publishAsInternalToolcall\" class=\"checkbox-input\" />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsInternalToolcall') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsInternalToolcallDescription') }}\n            </div>\n          </div>\n\n          <!-- HTTP POST Service Publishing Option -->\n          <div class=\"http-publish-option\">\n            <label class=\"checkbox-label\">\n              <input type=\"checkbox\" v-model=\"publishAsHttpService\" class=\"checkbox-input\" />\n              <span class=\"checkbox-text\">{{ t('mcpService.publishAsHttpService') }}</span>\n            </label>\n            <div class=\"checkbox-description\">\n              {{ t('mcpService.publishAsHttpServiceDescription') }}\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <template #footer>\n      <div class=\"button-container\">\n        <!-- Delete Button - Only shown when saved -->\n        <button v-if=\"isSaved\" class=\"action-btn danger\" @click=\"handleDelete\" :disabled=\"deleting\">\n          <Icon icon=\"carbon:loading\" v-if=\"deleting\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:trash-can\" v-else />\n          {{ deleting ? t('mcpService.deleting') : t('mcpService.delete') }}\n        </button>\n\n        <!-- Publish as Service Button - Always shown -->\n        <button class=\"action-btn primary\" @click=\"handlePublish\" :disabled=\"publishing\">\n          <Icon icon=\"carbon:loading\" v-if=\"publishing\" class=\"loading-icon\" />\n          <Icon icon=\"carbon:cloud-upload\" v-else />\n          {{ publishing ? t('mcpService.publishing') : t('mcpService.publishAsService') }}\n        </button>\n      </div>\n    </template>\n  </Modal>\n\n  <!-- Error Toast -->\n  <div v-if=\"error\" class=\"error-toast\" @click=\"error = ''\">\n    <Icon icon=\"carbon:error\" />\n    {{ error }}\n  </div>\n\n  <!-- Success Toast -->\n  <div v-if=\"success\" class=\"success-toast\" @click=\"success = ''\">\n    <Icon icon=\"carbon:checkmark\" />\n    {{ success }}\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  PlanParameterApiService,\n  type ParameterRequirements,\n} from '@/api/plan-parameter-api-service'\nimport Modal from '@/components/modal/index.vue'\nimport { useAvailableToolsSingleton } from '@/composables/useAvailableTools'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, reactive, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\n\n// Get template config singleton\nconst templateConfig = usePlanTemplateConfigSingleton()\n\n// Get available tools singleton to refresh tool list after publishing\nconst availableToolsStore = useAvailableToolsSingleton()\n\n// Props\ninterface Props {\n  modelValue: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  modelValue: false,\n})\n\n// Emits\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean]\n  published: [tool: null]\n}>()\n\n// Reactive data\nconst showModal = computed({\n  get: () => props.modelValue,\n  set: value => emit('update:modelValue', value),\n})\n\nconst error = ref('')\nconst success = ref('')\nconst publishing = ref(false)\nconst deleting = ref(false)\n\n// Service publishing options\nconst publishAsHttpService = ref(false)\nconst publishAsInternalToolcall = ref(true) // Default to true\n\n// Parameter requirements from plan template\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: '',\n})\nconst isLoadingParameters = ref(false)\n\n// Form data\nconst formData = reactive({\n  userRequest: '',\n  parameters: [] as Array<{ name: string; description: string }>,\n})\n\n// Calculate modal title - check if toolConfig exists to determine if updating or creating\nconst modalTitle = computed(() => {\n  const hasToolConfig = !!templateConfig.selectedTemplate.value?.toolConfig\n  return hasToolConfig ? t('mcpService.updateService') : t('mcpService.createService')\n})\n\n// Check if tool is saved (has toolConfig)\nconst isSaved = computed(() => {\n  return !!templateConfig.selectedTemplate.value?.toolConfig\n})\n\n// Initialize form data from templateConfig\nconst initializeFormData = () => {\n  const toolConfig = templateConfig.selectedTemplate.value?.toolConfig\n\n  if (toolConfig) {\n    // Load from existing toolConfig\n    formData.userRequest = toolConfig.toolDescription || ''\n    publishAsHttpService.value = toolConfig.enableHttpService ?? false\n    publishAsInternalToolcall.value = toolConfig.enableInternalToolcall ?? true\n\n    // Load parameters from inputSchema if available, otherwise use parameter requirements\n    if (\n      toolConfig.inputSchema &&\n      Array.isArray(toolConfig.inputSchema) &&\n      toolConfig.inputSchema.length > 0\n    ) {\n      formData.parameters = toolConfig.inputSchema.map(param => ({\n        name: param.name || '',\n        description: param.description || '',\n      }))\n    } else if (!parameterRequirements.value.hasParameters) {\n      formData.parameters = []\n    }\n  } else {\n    // Initialize with defaults\n    formData.userRequest = ''\n    publishAsHttpService.value = false\n    publishAsInternalToolcall.value = true\n    // Only reset parameters when not loaded from plan template\n    if (!parameterRequirements.value.hasParameters) {\n      formData.parameters = []\n    }\n  }\n}\n\n// Load parameter requirements from plan template\nconst loadParameterRequirements = async () => {\n  const planTemplateId = templateConfig.currentPlanTemplateId.value\n  if (!planTemplateId) {\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    formData.parameters = [] // Clear parameters when no template\n    return\n  }\n\n  isLoadingParameters.value = true\n  try {\n    const requirements = await PlanParameterApiService.getParameterRequirements(planTemplateId)\n    parameterRequirements.value = requirements\n\n    console.log('[PublishModal] Parameter requirements loaded:', requirements)\n\n    // Initialize form parameters with extracted parameters\n    // Preserve existing descriptions if parameters already exist (from toolConfig)\n    if (requirements.hasParameters) {\n      // Create a map of existing parameters by name to preserve descriptions\n      const existingParamsMap = new Map<string, string>()\n      formData.parameters.forEach(param => {\n        if (param.name) {\n          existingParamsMap.set(param.name, param.description || '')\n        }\n      })\n\n      // Merge: use existing description if available, otherwise use empty string\n      formData.parameters = requirements.parameters.map(param => ({\n        name: param,\n        description: existingParamsMap.get(param) || '',\n      }))\n      console.log(\n        '[PublishModal] Updated formData.parameters with requirements:',\n        formData.parameters\n      )\n    } else {\n      // IMPORTANT: When no parameters in plan template, clear formData.parameters\n      // This ensures old toolConfig parameters are removed from UI\n      formData.parameters = []\n      console.log('[PublishModal] No parameters in plan template, cleared formData.parameters')\n    }\n  } catch (error) {\n    console.error('[PublishModal] Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn('[PublishModal] Parameter requirements not available yet, will retry later')\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    formData.parameters = [] // Clear parameters on error\n  } finally {\n    isLoadingParameters.value = false\n  }\n}\n\n// Merge frontend parameters with backend toolConfig\n// Use frontend parameter list (from plan template) as source of truth\n// Preserve descriptions from backend for matching parameters\nconst mergeParametersWithBackend = (): Array<{ name: string; description: string }> => {\n  console.log('[PublishModal] Starting parameter merge')\n  console.log('[PublishModal] Frontend parameters:', parameterRequirements.value.parameters)\n  console.log('[PublishModal] Form parameters:', formData.parameters)\n\n  // Get backend parameters from toolConfig.inputSchema\n  const backendInputSchema = templateConfig.selectedTemplate.value?.toolConfig?.inputSchema || []\n  console.log('[PublishModal] Backend inputSchema:', backendInputSchema)\n\n  // Create a map of backend parameters by name\n  const backendParamsMap = new Map<string, string>()\n  backendInputSchema.forEach(param => {\n    if (param.name) {\n      backendParamsMap.set(param.name, param.description || '')\n    }\n  })\n\n  // If there are parameters from plan template (parameterRequirements), use them as source\n  if (parameterRequirements.value.hasParameters) {\n    const merged = parameterRequirements.value.parameters.map(paramName => {\n      // Try to get description from formData first (user may have edited it)\n      const formParam = formData.parameters.find(p => p.name === paramName)\n      const formDescription = formParam?.description || ''\n\n      // If formData has description, use it; otherwise try backend; otherwise empty\n      const description = formDescription || backendParamsMap.get(paramName) || ''\n\n      return {\n        name: paramName,\n        description: description,\n      }\n    })\n\n    console.log('[PublishModal] Merged parameters (from plan template):', merged)\n    return merged\n  }\n\n  // When hasParameters is false (no parameters in plan template)\n  // Return empty array to clear backend parameters\n  // This ensures frontend parameter list (even if empty) replaces backend\n  console.log('[PublishModal] No parameters in plan template, clearing backend parameters')\n  return []\n}\n\n// Show message\nconst showMessage = (msg: string, type: 'success' | 'error' | 'info') => {\n  if (type === 'success') {\n    success.value = msg\n    setTimeout(() => {\n      success.value = ''\n    }, 3000)\n  } else if (type === 'error') {\n    error.value = msg\n    setTimeout(() => {\n      error.value = ''\n    }, 5000)\n  }\n}\n\n// Validate form\nconst validateForm = (): boolean => {\n  // Validate tool description\n  if (!formData.userRequest.trim()) {\n    showMessage(t('mcpService.toolDescriptionRequiredError'), 'error')\n    return false\n  }\n\n  // Validate service group (from templateConfig)\n  const serviceGroup = templateConfig.getServiceGroup() || ''\n  if (!serviceGroup.trim()) {\n    showMessage(t('mcpService.serviceGroupRequiredError'), 'error')\n    return false\n  }\n\n  // Validate tool name (from templateConfig title)\n  const toolName = templateConfig.getTitle() || ''\n  if (!toolName.trim()) {\n    showMessage(t('mcpService.toolNameRequiredError'), 'error')\n    return false\n  }\n\n  // Ensure at least one service is selected\n  if (!publishAsInternalToolcall.value && !publishAsHttpService.value) {\n    showMessage('Please select at least one service type', 'error')\n    return false\n  }\n\n  // Validate parameter names and descriptions\n  for (let i = 0; i < formData.parameters.length; i++) {\n    const param = formData.parameters[i]\n    if (param.name && !param.description.trim()) {\n      showMessage(`Parameter \"${param.name}\" description cannot be empty`, 'error')\n      return false\n    }\n    if (param.description && !param.name.trim()) {\n      showMessage(\n        `Parameter description \"${param.description}\" corresponding name cannot be empty`,\n        'error'\n      )\n      return false\n    }\n  }\n\n  return true\n}\n\n// Handle publishing\nconst handlePublish = async () => {\n  console.log('[PublishModal] Starting to handle publish request')\n  console.log('[PublishModal] Form data:', formData)\n  console.log('[PublishModal] Publish as HTTP service:', publishAsHttpService.value)\n\n  if (!validateForm()) {\n    console.log('[PublishModal] Form validation failed')\n    return\n  }\n\n  publishing.value = true\n  try {\n    // Merge parameters: Use frontend parameters (from plan template) as the source of truth\n    // Preserve descriptions from backend toolConfig for matching parameters\n    const mergedParameters = mergeParametersWithBackend()\n\n    console.log('[PublishModal] Merged parameters:', mergedParameters)\n\n    // Prepare inputSchema from merged parameters\n    const inputSchema = mergedParameters\n      .filter(param => param.name.trim())\n      .map(param => ({\n        name: param.name.trim(),\n        description: param.description.trim() || '', // Use empty string if no description\n        type: 'string',\n      }))\n\n    // Update toolConfig in templateConfig with guard to prevent watcher syncing\n    templateConfig.setToolDescriptionWithGuard(formData.userRequest.trim())\n    templateConfig.setEnableInternalToolcallWithGuard(publishAsInternalToolcall.value)\n    templateConfig.setEnableHttpServiceWithGuard(publishAsHttpService.value)\n    templateConfig.setInputSchemaWithGuard(inputSchema)\n\n    // Save the plan template with updated toolConfig\n    const saveSuccess = await templateConfig.save()\n\n    if (!saveSuccess) {\n      throw new Error('Failed to save plan template')\n    }\n\n    // selectedTemplate is automatically refreshed by templateConfig.save()\n\n    // Perform corresponding publishing operations based on publish type\n    const enabledServices = []\n    if (publishAsInternalToolcall.value) enabledServices.push('Internal Method Call')\n    if (publishAsHttpService.value) enabledServices.push('HTTP Service')\n\n    if (enabledServices.length > 0) {\n      console.log(\n        '[PublishModal] Service published successfully. Enabled services:',\n        enabledServices.join(', ')\n      )\n      showMessage(t('mcpService.publishSuccess'), 'success')\n      // Refresh available tools list to include the newly published tool\n      await availableToolsStore.loadAvailableTools()\n      emit('published', null) // Emit null since state is managed in templateConfig\n    } else {\n      console.log('[PublishModal] Only saving tool, not publishing as any service')\n      showMessage(t('mcpService.saveSuccess'), 'success')\n      // Refresh available tools list even when only saving (tool might have been updated)\n      await availableToolsStore.loadAvailableTools()\n      emit('published', null)\n    }\n  } catch (err: unknown) {\n    console.error('[PublishModal] Failed to publish service:', err)\n    const message = err instanceof Error ? err.message : 'Unknown error'\n    showMessage(t('mcpService.publishFailed') + ': ' + message, 'error')\n  } finally {\n    publishing.value = false\n  }\n}\n\n// Handle delete\nconst handleDelete = async () => {\n  if (deleting.value) return\n\n  // Confirm deletion\n  if (!confirm(t('mcpService.deleteConfirmMessage'))) {\n    return\n  }\n\n  const planTemplateId = templateConfig.currentPlanTemplateId.value\n  if (!planTemplateId) {\n    showMessage(\n      t('mcpService.deleteFailed') + ': ' + t('mcpService.selectPlanTemplateFirst'),\n      'error'\n    )\n    return\n  }\n\n  deleting.value = true\n  try {\n    console.log('[PublishModal] Starting to delete tool config for planTemplateId:', planTemplateId)\n\n    // Remove toolConfig from templateConfig with guard to prevent watcher syncing\n    templateConfig.setToolConfigWithGuard(undefined)\n\n    // Save the plan template without toolConfig\n    const saveSuccess = await templateConfig.save()\n\n    if (!saveSuccess) {\n      throw new Error('Failed to save plan template after deletion')\n    }\n\n    // selectedTemplate is automatically refreshed by templateConfig.save()\n\n    console.log('[PublishModal] Deleted successfully')\n    showMessage(t('mcpService.deleteSuccess'), 'success')\n\n    // Close modal\n    showModal.value = false\n\n    // Notify parent component of successful deletion\n    emit('published', null)\n  } catch (error: unknown) {\n    console.error('[PublishModal] Failed to delete tool config:', error)\n    const message = error instanceof Error ? error.message : 'Unknown error'\n    showMessage(t('mcpService.deleteFailed') + ': ' + message, 'error')\n  } finally {\n    deleting.value = false\n  }\n}\n\n// Watch modal display state\nconst watchModal = async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Modal opened, starting to initialize data')\n    initializeFormData()\n    await loadParameterRequirements()\n  }\n}\n\n// Watch props changes\nwatch(() => props.modelValue, watchModal)\n\n// Watch for planTemplateId changes\nwatch(\n  () => templateConfig.currentPlanTemplateId.value,\n  (newId, oldId) => {\n    if (newId && newId !== oldId) {\n      // If this is a new template ID (not from initial load), retry loading parameters\n      if (oldId && newId.startsWith('planTemplate-')) {\n        // Retry loading parameters with a delay for new templates\n        setTimeout(() => {\n          loadParameterRequirements()\n        }, 1000)\n      } else {\n        loadParameterRequirements()\n      }\n    }\n  }\n)\n\n// Initialize when component mounts\nonMounted(async () => {\n  if (showModal.value) {\n    console.log('[PublishModal] Initialize when component mounted')\n    initializeFormData()\n    await loadParameterRequirements()\n  }\n})\n\n// Expose methods for parent component\ndefineExpose({\n  loadParameterRequirements,\n})\n</script>\n\n<style scoped>\n/* Wide modal styles */\n:deep(.wide-modal .modal-container) {\n  width: 90%;\n  max-width: 900px !important; /* Adjust width to 900px */\n}\n\n/* Form layout optimization - reference new Model modal styles */\n.modal-form {\n  display: flex;\n  flex-direction: column;\n  gap: 16px; /* Adjust to 16px, consistent with new Model modal */\n  width: 100%;\n}\n\n.form-section {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n  width: 100%;\n}\n\n.section-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  padding-bottom: 8px;\n}\n\n.form-item {\n  display: flex;\n  flex-direction: column;\n  gap: 8px; /* Adjust to 8px, optimize title and input spacing */\n}\n\n.form-item label {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  margin: 0; /* Remove default margin */\n}\n\n.required {\n  color: #ff6b6b;\n}\n\n/* Field description styles */\n.field-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  margin-top: 4px;\n  line-height: 1.4;\n  font-style: italic;\n}\n\n.form-item input,\n.form-item textarea {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  font-family: inherit;\n  box-sizing: border-box;\n  min-height: 48px; /* Ensure consistent minimum height */\n}\n\n.form-item input {\n  height: 48px; /* Single line input fixed height */\n}\n\n.form-item input:focus,\n.form-item textarea:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n}\n\n.form-item input::placeholder,\n.form-item textarea::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n/* Service Group Autocomplete Styles */\n.service-group-autocomplete {\n  position: relative;\n}\n\n.service-group-autocomplete input {\n  width: 100%;\n}\n\n.service-group-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  z-index: 99999;\n  margin-top: 4px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.service-group-option {\n  padding: 12px 16px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.service-group-option:last-child {\n  border-bottom: none;\n}\n\n.service-group-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.description-field {\n  resize: vertical;\n  min-height: 80px;\n  line-height: 1.5;\n  width: 100%;\n}\n\n/* Parameter Requirements Help Text */\n.params-help-text {\n  margin-bottom: 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  padding: 6px 8px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 4px;\n}\n\n/* Parameter table responsive */\n.parameter-table {\n  margin-bottom: 16px;\n  width: 100%;\n  overflow-x: auto;\n}\n\n.parameter-table table {\n  width: 100%;\n  border-collapse: collapse;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  overflow: hidden;\n  min-width: 600px;\n}\n\n.parameter-table th {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.9);\n  font-weight: 500;\n  padding: 12px;\n  text-align: left;\n  font-size: 14px;\n  white-space: nowrap;\n}\n\n.parameter-table td {\n  padding: 8px 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.parameter-input {\n  width: 100%;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.parameter-input:focus {\n  border-color: #667eea;\n  outline: none;\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02) !important;\n  color: rgba(255, 255, 255, 0.6) !important;\n  cursor: not-allowed;\n  border-color: rgba(255, 255, 255, 0.05) !important;\n}\n\n/* Delete and add button styles removed */\n\n/* Endpoint component responsive - supports manual input */\n.custom-dropdown {\n  position: relative;\n  width: 100%;\n}\n\n.dropdown-input {\n  width: 100%;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  font-size: 14px;\n  transition: all 0.3s ease;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  box-sizing: border-box;\n  height: 48px; /* Ensure consistent height with other inputs */\n}\n\n.dropdown-input input {\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #fff;\n  font-size: 14px;\n  width: 100%;\n  cursor: text; /* Allow text input */\n  height: 100%;\n  padding: 0;\n}\n\n.dropdown-input input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.dropdown-input.active {\n  border-color: #667eea;\n  outline: none;\n  background-color: rgba(255, 255, 255, 0.08);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);\n  transform: translateY(-1px);\n}\n\n.dropdown-input:hover {\n  border-color: rgba(255, 255, 255, 0.2);\n  background-color: rgba(255, 255, 255, 0.07);\n  transform: translateY(-1px);\n}\n\n.dropdown-arrow {\n  transition: transform 0.3s ease;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 16px;\n  flex-shrink: 0;\n  margin-left: 8px;\n}\n\n.dropdown-arrow.rotated {\n  transform: rotate(180deg);\n}\n\n.dropdown-menu {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  width: 100%;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  max-height: 200px;\n  overflow-y: auto;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  backdrop-filter: blur(10px);\n  z-index: 10;\n  margin-top: 4px;\n}\n\n.dropdown-item {\n  padding: 12px 16px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(102, 126, 234, 0.1));\n  color: #a8b3ff;\n  transform: translateX(4px);\n}\n\n.dropdown-item.selected {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(102, 126, 234, 0.2));\n  color: #a8b3ff;\n  font-weight: 500;\n}\n\n.dropdown-item.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n  padding-left: 16px; /* Align with other items */\n}\n\n.dropdown-item.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n/* Button container - reference screenshot styles */\n.button-container {\n  display: flex;\n  gap: 12px;\n  justify-content: flex-end;\n  margin-top: 0;\n  align-items: center;\n  padding: 16px 0;\n  min-height: 52px; /* Ensure container has fixed height, prevent jitter */\n  position: relative; /* Provide reference for absolutely positioned child elements */\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.primary {\n  background: rgba(102, 126, 234, 0.2);\n  border-color: rgba(102, 126, 234, 0.3);\n  color: #a8b3ff;\n}\n\n.action-btn.primary:hover:not(:disabled) {\n  background: rgba(102, 126, 234, 0.3);\n}\n\n.action-btn.danger {\n  background: rgba(234, 102, 102, 0.2);\n  border-color: rgba(234, 102, 102, 0.3);\n  color: #ff6b6b;\n}\n\n.action-btn.danger:hover:not(:disabled) {\n  background: rgba(234, 102, 102, 0.3);\n}\n\n.action-btn.danger:disabled {\n  background: rgba(234, 102, 102, 0.1);\n  border-color: rgba(234, 102, 102, 0.2);\n  color: rgba(255, 107, 107, 0.5);\n  cursor: not-allowed;\n}\n\n/* Read-only input styles */\n.readonly-input {\n  background: rgba(255, 255, 255, 0.03) !important;\n  color: rgba(255, 255, 255, 0.7) !important;\n  cursor: not-allowed !important;\n  opacity: 0.8;\n}\n\n.readonly-input::placeholder {\n  color: rgba(255, 255, 255, 0.4) !important;\n}\n\n/* Endpoint container layout */\n.endpoint-container {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  width: 100%;\n}\n\n.endpoint-row {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  width: 100%;\n}\n\n/* Custom dropdown styles - reference screenshot three */\n.custom-select {\n  position: relative;\n  display: inline-block;\n  width: 100%; /* Adjust to 100% to fit new layout */\n  flex-shrink: 0;\n}\n\n.select-input-container {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  background: rgba(20, 20, 25, 0.95);\n  border: 2px solid rgba(102, 126, 234, 0.6);\n  border-radius: 12px;\n  color: #667eea;\n  transition: all 0.3s ease;\n  font-size: 14px;\n  font-weight: 600;\n  outline: none;\n  width: 100%;\n  justify-content: space-between;\n  height: 44px;\n  box-sizing: border-box;\n  box-shadow: 0 0 0 1px rgba(102, 126, 234, 0.3);\n  padding: 0 12px;\n}\n\n.select-input-container:hover {\n  border-color: rgba(102, 126, 234, 0.8);\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.4);\n}\n\n.select-input-container:focus-within {\n  border-color: rgba(102, 126, 234, 0.9);\n  outline: none;\n  background-color: rgba(20, 20, 25, 0.98);\n  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);\n}\n\n.input-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  min-width: 0;\n}\n\n.input-icon {\n  color: #667eea;\n  flex-shrink: 0;\n}\n\n.select-input {\n  flex: 1;\n  background: transparent;\n  border: none;\n  outline: none;\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  text-shadow: none;\n  display: flex;\n  align-items: center;\n  gap: 0;\n  min-width: 0;\n  height: 100%;\n}\n\n.select-input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.select-arrow-btn {\n  background: none;\n  border: none;\n  color: #667eea;\n  cursor: pointer;\n  padding: 8px;\n  border-radius: 6px;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n}\n\n.select-arrow-btn:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.chevron {\n  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n  opacity: 0.9;\n  filter: none;\n  width: 16px;\n  height: 16px;\n}\n\n.select-dropdown {\n  position: absolute;\n  top: 100%;\n  z-index: 99999;\n  margin-top: 6px;\n  background: rgba(15, 15, 20, 0.98);\n  backdrop-filter: blur(20px);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 12px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);\n  width: 280px; /* Keep consistent with select-btn width */\n  max-height: 280px;\n  overflow: hidden;\n  /* Ensure not occupying document flow */\n  pointer-events: auto;\n}\n\n.select-dropdown.dropdown-top {\n  top: auto;\n  bottom: 100%;\n  margin-top: 0;\n  margin-bottom: 4px;\n}\n\n.dropdown-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 14px 18px;\n  border-bottom: 1px solid rgba(102, 126, 234, 0.2);\n  font-size: 14px;\n  font-weight: 600;\n  color: #667eea;\n  background: rgba(102, 126, 234, 0.05);\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.select-options {\n  padding: 12px 0;\n  max-height: 200px;\n  overflow-y: auto;\n}\n\n.select-option {\n  display: flex;\n  align-items: center;\n  gap: 0;\n  width: 100%;\n  padding: 12px 18px;\n  background: none;\n  border: none;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  text-align: left;\n  font-size: 14px;\n}\n\n.select-option:hover {\n  background: rgba(102, 126, 234, 0.1);\n  color: #667eea;\n}\n\n.select-option.active {\n  background: rgba(102, 126, 234, 0.2);\n  color: #667eea;\n  border-left: 3px solid #667eea;\n  padding-left: 15px;\n  font-weight: 500;\n}\n\n.select-option.custom-input {\n  color: rgba(255, 255, 255, 0.6);\n  font-style: italic;\n}\n\n.select-option.custom-input .custom-label {\n  color: rgba(255, 255, 255, 0.6);\n  margin-right: 4px;\n}\n\n.option-name {\n  flex: 1;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.check-icon {\n  color: #667eea;\n  opacity: 0.8;\n}\n\n/* Manual input area styles */\n.manual-input-section {\n  padding: 14px 18px;\n  border-top: 1px solid rgba(102, 126, 234, 0.2);\n  background: rgba(102, 126, 234, 0.03);\n}\n\n.manual-input-container {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n  width: 100%;\n}\n\n.manual-input {\n  flex: 1;\n  padding: 8px 12px;\n  background: rgba(20, 20, 25, 0.8);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  font-size: 14px;\n  transition: all 0.3s ease;\n}\n\n.manual-input:focus {\n  border-color: rgba(102, 126, 234, 0.8);\n  outline: none;\n  background: rgba(20, 20, 25, 0.9);\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.manual-input::placeholder {\n  color: rgba(102, 126, 234, 0.5);\n}\n\n.add-manual-btn {\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.15);\n  border: 1px solid rgba(102, 126, 234, 0.3);\n  border-radius: 8px;\n  color: #667eea;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.add-manual-btn:hover {\n  background: rgba(102, 126, 234, 0.25);\n  border-color: rgba(102, 126, 234, 0.5);\n}\n\n/* Service publishing option styles */\n.service-publish-options {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.mcp-publish-option,\n.http-publish-option,\n.internal-toolcall-publish-option {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n  padding: 16px;\n  background: rgba(255, 255, 255, 0.03);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n}\n\n/* .http-publish-option, .mcp-publish-option, .internal-toolcall-publish-option now use the same styles */\n\n.checkbox-label {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  cursor: pointer;\n  user-select: none;\n}\n\n.checkbox-input {\n  width: 16px;\n  height: 16px;\n  accent-color: #667eea;\n  cursor: pointer;\n}\n\n.checkbox-text {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.checkbox-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-left: 24px;\n}\n\n/* HTTP service options now use the same styles as MCP service, no special handling needed */\n\n.endpoint-description {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.4;\n  margin-bottom: 8px;\n}\n\n/* Two-column layout styles */\n.endpoint-url-row {\n  display: flex;\n  gap: 16px;\n  width: 100%;\n}\n\n.endpoint-url-row.single-item {\n  gap: 0;\n}\n\n.endpoint-url-row.single-item .endpoint-item {\n  flex: 0 0 50%; /* Maintain 50% width even when displayed alone */\n}\n\n.endpoint-item {\n  flex: 0 0 50%; /* Fixed width 50%, not responsive */\n  min-width: 0;\n}\n\n.url-item {\n  flex: 1;\n  min-width: 0;\n}\n\n/* URL display styles */\n.url-container {\n  width: 100%;\n}\n\n.url-display {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  min-height: 48px;\n}\n\n.url-display:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.url-text {\n  flex: 1;\n  font-size: 14px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  word-break: break-all;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.copy-icon {\n  color: rgba(255, 255, 255, 0.6);\n  margin-left: 8px;\n  flex-shrink: 0;\n  transition: all 0.3s ease;\n}\n\n.url-display:hover .copy-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.backdrop {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99998;\n  background: transparent;\n}\n\n.slideDown-enter-active,\n.slideDown-leave-active {\n  transition: all 0.2s ease;\n  transform-origin: top;\n}\n\n.slideDown-enter-from,\n.slideDown-leave-to {\n  opacity: 0;\n  transform: translateY(-8px) scale(0.95);\n}\n\n/* Old save button styles removed */\n\n.loading-icon {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Required field styles */\n.required {\n  color: #ff4d4f;\n  margin-left: 4px;\n}\n\n/* Error state styles */\n.form-item input.error,\n.form-item textarea.error {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.1);\n}\n\n.form-item input.error:focus,\n.form-item textarea.error:focus {\n  border-color: #ff4d4f;\n  box-shadow: 0 0 0 2px rgba(255, 77, 79, 0.2);\n}\n\n/* Tooltip messages */\n.error-toast,\n.success-toast {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #fff;\n  cursor: pointer;\n  z-index: 10000; /* Ensure above modal */\n  animation: slideIn 0.3s ease;\n}\n\n.error-toast {\n  background: rgba(234, 102, 102, 0.9);\n  border: 1px solid rgba(234, 102, 102, 0.5);\n}\n\n.success-toast {\n  background: rgba(102, 234, 102, 0.9);\n  border: 1px solid rgba(102, 234, 102, 0.5);\n}\n\n@keyframes slideIn {\n  from {\n    transform: translateX(100%);\n    opacity: 0;\n  }\n  to {\n    transform: translateX(0);\n    opacity: 1;\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div v-if=\"modelValue\" class=\"modal-overlay\" @click=\"handleCancel\">\n    <div class=\"modal-content\" @click.stop>\n      <div class=\"modal-header\">\n        <h3>{{ $t('sidebar.saveConfirmationTitle') }}</h3>\n        <button class=\"close-btn\" @click=\"handleCancel\">\n          <Icon icon=\"carbon:close\" width=\"16\" />\n        </button>\n      </div>\n      <div class=\"modal-body\">\n        <p>{{ $t('sidebar.saveConfirmationMessage') }}</p>\n      </div>\n      <div class=\"modal-footer\">\n        <button class=\"btn btn-secondary\" @click=\"handleCancel\">\n          {{ $t('common.cancel') }}\n        </button>\n        <button class=\"btn btn-primary\" @click=\"handleSave\" :disabled=\"isSaving\">\n          <Icon v-if=\"isSaving\" icon=\"carbon:loading\" width=\"16\" class=\"spinning\" />\n          {{ isSaving ? $t('sidebar.saving') : $t('common.save') }}\n        </button>\n        <button class=\"btn btn-danger\" @click=\"handleContinueWithoutSave\">\n          {{ $t('sidebar.continueWithoutSave') }}\n        </button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { Icon } from '@iconify/vue'\nimport { ref } from 'vue'\n\ninterface Props {\n  modelValue: boolean\n}\n\ninterface Emits {\n  (e: 'update:modelValue', value: boolean): void\n  (e: 'save'): void\n  (e: 'continue'): void\n}\n\ndefineProps<Props>()\nconst emit = defineEmits<Emits>()\n\nconst isSaving = ref(false)\n\nconst handleCancel = () => {\n  emit('update:modelValue', false)\n}\n\nconst handleSave = async () => {\n  isSaving.value = true\n  try {\n    emit('save')\n    emit('update:modelValue', false)\n  } finally {\n    isSaving.value = false\n  }\n}\n\nconst handleContinueWithoutSave = () => {\n  emit('continue')\n  emit('update:modelValue', false)\n}\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-body p {\n  margin: 0;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  line-height: 1.5;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:play\" width=\"16\" />\n      <span>{{ t('sidebar.executionController') }}</span>\n    </div>\n    <div class=\"execution-content\">\n      <!-- Parameter Requirements Display -->\n      <div class=\"params-requirements-group\">\n        <label>{{ t('sidebar.parameterRequirements') }}</label>\n        <div class=\"params-help-text\">\n          {{ t('sidebar.parameterRequirementsHelp') }}\n        </div>\n\n        <!-- Show parameter fields only if there are parameters -->\n        <div v-if=\"parameterRequirements.hasParameters\" class=\"parameter-fields\">\n          <div\n            v-for=\"param in parameterRequirements.parameters\"\n            :key=\"param\"\n            class=\"parameter-field\"\n          >\n            <label class=\"parameter-label\">\n              {{ param }}\n              <span class=\"required\">*</span>\n            </label>\n            <input\n              v-model=\"parameterValues[param]\"\n              class=\"parameter-input\"\n              :class=\"{ error: parameterErrors[param] }\"\n              :placeholder=\"t('sidebar.enterValueFor', { param })\"\n              @input=\"updateParameterValue(param, ($event.target as HTMLInputElement).value)\"\n              required\n            />\n            <div v-if=\"parameterErrors[param]\" class=\"parameter-error\">\n              {{ parameterErrors[param] }}\n            </div>\n          </div>\n        </div>\n\n        <!-- Validation status message -->\n        <div\n          v-if=\"parameterRequirements.hasParameters && !canExecute && !props.isExecuting\"\n          class=\"validation-message\"\n        >\n          <Icon icon=\"carbon:warning\" width=\"14\" />\n          {{ t('sidebar.fillAllRequiredParameters') }}\n        </div>\n      </div>\n\n      <!-- File Upload Component -->\n      <FileUploadComponent\n        ref=\"fileUploadRef\"\n        :disabled=\"props.isExecuting\"\n        @files-uploaded=\"handleFilesUploaded\"\n        @files-removed=\"handleFilesRemoved\"\n        @upload-key-changed=\"handleUploadKeyChanged\"\n        @upload-started=\"handleUploadStarted\"\n        @upload-completed=\"handleUploadCompleted\"\n        @upload-error=\"handleUploadError\"\n      />\n\n      <button\n        class=\"btn btn-primary execute-btn\"\n        @click=\"handleExecutePlan\"\n        :disabled=\"!canExecute\"\n      >\n        <Icon\n          :icon=\"props.isExecuting ? 'carbon:circle-dash' : 'carbon:play'\"\n          width=\"16\"\n          :class=\"{ spinning: props.isExecuting }\"\n        />\n        {{ props.isExecuting ? t('sidebar.executing') : t('sidebar.executePlan') }}\n      </button>\n      <button\n        class=\"btn publish-mcp-btn\"\n        @click=\"handlePublishMcpService\"\n        :disabled=\"!templateConfig.currentPlanTemplateId.value\"\n        v-if=\"showPublishButton\"\n      >\n        <Icon icon=\"carbon:application\" width=\"16\" />\n        {{ buttonText }}\n      </button>\n\n      <!-- Internal Call wrapper - only show when enableInternalToolcall is true -->\n      <div\n        v-if=\"templateConfig.selectedTemplate.value?.toolConfig?.enableInternalToolcall\"\n        class=\"call-example-wrapper\"\n      >\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.internalCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.internalCallDescription') }}</p>\n        </div>\n        <div class=\"internal-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.internalMethodCall') }}</div>\n            <div class=\"call-endpoint\">\n              {{ t('sidebar.toolName') }}:\n              {{\n                templateConfig.selectedTemplate.value?.title ||\n                templateConfig.currentPlanTemplateId.value ||\n                ''\n              }}\n            </div>\n            <div v-if=\"templateConfig.selectedTemplate.value?.serviceGroup\" class=\"call-endpoint\">\n              {{ t('sidebar.serviceGroup') }}:\n              {{ templateConfig.selectedTemplate.value.serviceGroup }}\n            </div>\n            <div class=\"call-description\">{{ t('sidebar.internalCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.internalCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- HTTP API URLs wrapper with tabs - only show when enableHttpService is true -->\n      <div\n        v-if=\"templateConfig.selectedTemplate.value?.toolConfig?.enableHttpService\"\n        class=\"call-example-wrapper\"\n      >\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.httpCallExample') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.httpCallDescription') }}</p>\n        </div>\n        <div class=\"http-api-urls-wrapper\">\n          <div class=\"tab-container\">\n            <div class=\"tab-header\">\n              <button\n                v-for=\"tab in apiTabs\"\n                :key=\"tab.id\"\n                :class=\"['tab-button', { active: activeTab === tab.id }]\"\n                @click=\"activeTab = tab.id\"\n              >\n                {{ tab.label }}\n              </button>\n            </div>\n            <div class=\"tab-content\">\n              <div\n                v-for=\"tab in apiTabs\"\n                :key=\"tab.id\"\n                v-show=\"activeTab === tab.id\"\n                class=\"tab-panel\"\n              >\n                <div class=\"http-api-url-display\">\n                  <div class=\"api-method\">{{ tab.method }}</div>\n                  <div class=\"api-endpoint\">{{ tab.endpoint }}</div>\n                  <div class=\"api-description\">{{ tab.description }}</div>\n                  <div v-if=\"tab.example\" class=\"api-example\">\n                    <strong>{{ t('sidebar.example') }}:</strong>\n                    <pre class=\"example-code\">{{ tab.example }}</pre>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- MCP Call wrapper - only show when enableMcpService is true -->\n      <div\n        v-if=\"templateConfig.selectedTemplate.value?.toolConfig?.enableMcpService\"\n        class=\"call-example-wrapper\"\n      >\n        <div class=\"call-example-header\">\n          <h4 class=\"call-example-title\">{{ t('sidebar.mcpCall') }}</h4>\n          <p class=\"call-example-description\">{{ t('sidebar.mcpCallDescription') }}</p>\n        </div>\n        <div class=\"mcp-call-wrapper\">\n          <div class=\"call-info\">\n            <div class=\"call-method\">{{ t('sidebar.mcpServiceCall') }}</div>\n            <div class=\"call-endpoint\">{{ t('sidebar.mcpEndpoint') }}: /mcp/execute</div>\n            <div class=\"call-description\">{{ t('sidebar.mcpCallUsage') }}</div>\n            <div class=\"call-example\">\n              <strong>{{ t('sidebar.usage') }}:</strong>\n              <pre class=\"example-code\">{{ t('sidebar.mcpCallExample') }}</pre>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <!-- Save Confirmation Dialog -->\n  <SaveConfirmationDialog\n    v-model=\"showSaveDialog\"\n    @save=\"handleSaveAndExecute\"\n    @continue=\"handleContinueExecution\"\n  />\n\n  <!-- Publish Service Modal -->\n  <PublishServiceModal v-model=\"showPublishMcpModal\" />\n</template>\n\n<script setup lang=\"ts\">\nimport { FileInfo } from '@/api/file-upload-api-service'\nimport {\n  PlanParameterApiService,\n  type ParameterRequirements,\n} from '@/api/plan-parameter-api-service'\nimport FileUploadComponent from '@/components/file-upload/FileUploadComponent.vue'\nimport PublishServiceModal from '@/components/publish-service-modal/PublishServiceModal.vue'\nimport SaveConfirmationDialog from '@/components/sidebar/SaveConfirmationDialog.vue'\nimport { useMessageDialogSingleton } from '@/composables/useMessageDialog'\nimport { usePlanExecutionSingleton } from '@/composables/usePlanExecution'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { useToast } from '@/plugins/useToast'\nimport { templateStore } from '@/stores/templateStore'\nimport type { PlanData, PlanExecutionRequestPayload } from '@/types/plan-execution'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, ref, watch, watchEffect } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Template config singleton\nconst templateConfig = usePlanTemplateConfigSingleton()\n\n// Message dialog singleton for executing plans\nconst messageDialog = useMessageDialogSingleton()\n\n// Plan execution singleton to track execution state\nconst planExecution = usePlanExecutionSingleton()\n\n// Props\ninterface Props {\n  isExecuting?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  isExecuting: false,\n})\n\n// No emits needed - we handle execution directly\n\n// Local state\nconst executionParams = ref('')\nconst showPublishMcpModal = ref(false)\nconst parameterRequirements = ref<ParameterRequirements>({\n  parameters: [],\n  hasParameters: false,\n  requirements: '',\n})\nconst parameterValues = ref<Record<string, string>>({})\nconst isLoadingParameters = ref(false)\nconst activeTab = ref('post-async')\nconst parameterErrors = ref<Record<string, string>>({})\nconst isValidationError = ref(false)\nconst isExecutingPlan = ref(false) // Flag to prevent parameter reload during execution\nconst lastPlanId = ref<string | null>(null) // Track last returned plan ID\n\n// Computed property: whether to show publish MCP service button\nconst showPublishButton = computed(() => {\n  return templateConfig.getCoordinatorToolConfig()\n})\n\n// File upload state\nconst fileUploadRef = ref<InstanceType<typeof FileUploadComponent>>()\nconst uploadedFiles = ref<string[]>([])\nconst uploadKey = ref<string | null>(null)\n\n// Save confirmation dialog state\nconst showSaveDialog = ref(false)\nconst pendingExecutionPayload = ref<PlanExecutionRequestPayload | null>(null)\n\n// API tabs configuration - dynamically generated from template and parameters\nconst apiTabs = computed(() => {\n  // Get actual values from selected template\n  const toolName = templateConfig.selectedTemplate.value?.title || 'my-tool'\n  const serviceGroup = templateConfig.selectedTemplate.value?.serviceGroup || 'research'\n  const planTemplateId = templateConfig.selectedTemplate.value?.planTemplateId || 'template-456'\n\n  // Generate replacementParams from actual parameter requirements\n  const replacementParams: Record<string, string> = {}\n  if (\n    parameterRequirements.value.hasParameters &&\n    parameterRequirements.value.parameters.length > 0\n  ) {\n    parameterRequirements.value.parameters.forEach(param => {\n      // Use actual value if available, otherwise use placeholder\n      replacementParams[param] = parameterValues.value[param] || 'test'\n    })\n  } else {\n    // Default example when no parameters\n    replacementParams['rawParam'] = 'test'\n  }\n\n  // Use actual planId or i18n placeholder\n  const planId = lastPlanId.value || t('sidebar.defaultPlanId')\n  const detailsPlanId = lastPlanId.value || t('sidebar.defaultPlanIdDetails')\n\n  return [\n    {\n      id: 'post-async',\n      label: 'POST + Async',\n      method: 'POST',\n      endpoint: '/api/executor/executeByToolNameAsync',\n      description: 'Asynchronous POST request - returns task ID, check status separately',\n      example: `POST /api/executor/executeByToolNameAsync\nContent-Type: application/json\n\n{\n  \"toolName\": \"${toolName}\",\n  \"serviceGroup\": \"${serviceGroup}\",\n  \"replacementParams\": ${JSON.stringify(replacementParams, null, 2)},\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"planId\": \"${planId}\",\n  \"status\": \"processing\",\n  \"message\": \"Task submitted, processing\",\n  \"memoryId\": \"ABC12345\",\n  \"toolName\": \"${toolName}\",\n  \"planTemplateId\": \"${planTemplateId}\"\n}\n\n# Check execution status and get detailed results:\nGET /api/executor/details/${detailsPlanId}\nResponse: {\n  \"currentPlanId\": \"${planId}\",\n  \"title\": \"Plan Title\",\n  \"status\": \"completed\",\n  \"summary\": \"Execution completed successfully\",\n  \"agentExecutionSequence\": [...],\n  \"userInputWaitState\": null,\n  \"structureResult\": {\n    \"message\": [\n      {\n        \"name\": \"Product A\",\n        \"price\": \"100\",\n        \"quantity\": \"5\"\n      }\n    ],\n    \"fileList\": [\n      {\n        \"fileName\": \"report.md\",\n        \"fileDescription\": \"Generated report with product information\"\n      }\n    ]\n  }\n}`,\n    },\n    {\n      id: 'post-sync',\n      label: 'POST + Sync',\n      method: 'POST',\n      endpoint: '/api/executor/executeByToolNameSync',\n      description: 'Synchronous POST request - returns execution result immediately',\n      example: `POST /api/executor/executeByToolNameSync\nContent-Type: application/json\n\n{\n  \"toolName\": \"${toolName}\",\n  \"serviceGroup\": \"${serviceGroup}\",\n  \"replacementParams\": ${JSON.stringify(replacementParams, null, 2)},\n  \"uploadedFiles\": []\n}\n\nResponse: {\n  \"status\": \"completed\",\n  \"result\": \"Execution result here\"\n}`,\n    },\n  ]\n})\n\n// Computed properties\nconst isAnyServiceEnabled = computed(() => {\n  const toolConfig = templateConfig.selectedTemplate.value?.toolConfig\n  return (\n    toolConfig?.enableInternalToolcall ??\n    toolConfig?.enableHttpService ??\n    toolConfig?.enableMcpService ??\n    false\n  )\n})\n\nconst buttonText = computed(() => {\n  return isAnyServiceEnabled.value\n    ? t('sidebar.updateServiceStatus')\n    : t('sidebar.publishMcpService')\n})\n\n// Computed property for disabled state - same as InputArea.vue\nconst isDisabled = computed(() => messageDialog.isLoading.value)\n\nconst canExecute = computed(() => {\n  // Disable if messageDialog is loading (same validation as InputArea)\n  if (isDisabled.value) {\n    return false\n  }\n\n  if (props.isExecuting) {\n    return false\n  }\n\n  // Disable if there's a plan execution in progress (prevents duplicate submissions)\n  if (isExecutingPlan.value) {\n    return false\n  }\n\n  // Also check if there are any tracked plans or running plans\n  const hasTrackedPlans = planExecution.trackedPlanIds.value.size > 0\n  const recordsArray = Array.from(planExecution.planExecutionRecords.entries())\n  const hasRunningPlansInRecords = recordsArray.some(\n    ([, record]) => record && !record.completed && record.status !== 'failed'\n  )\n  if (hasTrackedPlans || hasRunningPlansInRecords) {\n    return false\n  }\n\n  if (parameterRequirements.value.hasParameters) {\n    // Check if all required parameters are filled\n    return parameterRequirements.value.parameters.every(param => {\n      const value = parameterValues.value[param]\n      return typeof value === 'string' && value.trim() !== ''\n    })\n  }\n\n  return true\n})\n\n// File upload event handlers\nconst handleFilesUploaded = (files: FileInfo[], key: string | null) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  uploadKey.value = key\n  console.log('[ExecutionController] Files uploaded:', files.length, 'uploadKey:', key)\n}\n\nconst handleFilesRemoved = (files: FileInfo[]) => {\n  uploadedFiles.value = files.map(file => file.originalName)\n  console.log('[ExecutionController] Files removed, remaining:', files.length)\n}\n\nconst handleUploadKeyChanged = (key: string | null) => {\n  uploadKey.value = key\n  console.log('[ExecutionController] Upload key changed:', key)\n}\n\nconst handleUploadStarted = () => {\n  console.log('[ExecutionController] Upload started')\n}\n\nconst handleUploadCompleted = () => {\n  console.log('[ExecutionController] Upload completed')\n}\n\nconst handleUploadError = (error: unknown) => {\n  console.error('[ExecutionController] Upload error:', error)\n}\n\n// Methods\nconst handleExecutePlan = async () => {\n  console.log('[ExecutionController]  Execute button clicked')\n\n  // Check if there's already an execution in progress\n  if (props.isExecuting || messageDialog.isLoading.value || isExecutingPlan.value) {\n    console.log(\n      '[ExecutionController]  Execution already in progress. isExecuting: {}, messageDialog.isLoading: {}, isExecutingPlan: {}',\n      props.isExecuting,\n      messageDialog.isLoading.value,\n      isExecutingPlan.value\n    )\n    toast.error(t('sidebar.executionInProgress'))\n    return\n  }\n\n  // Check if task requirements have been modified\n  if (templateStore.hasTaskRequirementModified) {\n    console.log(\n      '[ExecutionController]  Task requirements modified, showing save confirmation dialog'\n    )\n    // Prepare payload but don't execute yet\n    if (!validateParameters()) {\n      console.log('[ExecutionController]  Parameter validation failed:', parameterErrors.value)\n      return\n    }\n\n    const replacementParams =\n      parameterRequirements.value.hasParameters && Object.keys(parameterValues.value).length > 0\n        ? parameterValues.value\n        : undefined\n\n    pendingExecutionPayload.value = {\n      title: '', // Will be set by the parent component\n      planData: {\n        title: '',\n        steps: [],\n        directResponse: false,\n      }, // Will be set by the parent component\n      params: undefined, // Will be set by the parent component\n      replacementParams,\n      uploadedFiles: uploadedFiles.value,\n      uploadKey: uploadKey.value,\n    }\n\n    showSaveDialog.value = true\n    return\n  }\n\n  // Continue with normal execution if no modifications\n  await proceedWithExecution()\n}\n\nconst proceedWithExecution = async () => {\n  // Double-check execution state before proceeding (defense in depth)\n  if (props.isExecuting || messageDialog.isLoading.value || isExecutingPlan.value) {\n    console.log(\n      '[ExecutionController]  Execution already in progress in proceedWithExecution. Skipping.'\n    )\n    return\n  }\n\n  // Set execution flag to prevent parameter reload and concurrent execution\n  isExecutingPlan.value = true\n  console.log('[ExecutionController]  Set isExecutingPlan to true')\n\n  // Validate parameters before execution\n  if (!validateParameters()) {\n    console.log('[ExecutionController]  Parameter validation failed:', parameterErrors.value)\n    isExecutingPlan.value = false // Reset flag on validation failure\n    return\n  }\n\n  try {\n    // Get plan data from templateConfig\n    if (!templateConfig.selectedTemplate.value) {\n      console.log('[ExecutionController]  No template selected, returning')\n      toast.error(t('sidebar.selectPlanFirst'))\n      isExecutingPlan.value = false\n      return\n    }\n\n    const config = templateConfig.getConfig()\n\n    // Convert PlanTemplateConfigVO to PlanData format\n    const planTemplateId =\n      templateConfig.selectedTemplate.value.planTemplateId || config.planTemplateId\n    const planData: PlanData = {\n      title: config.title || templateConfig.selectedTemplate.value.title || 'Execution Plan',\n      steps: (config.steps || []).map(step => ({\n        stepRequirement: step.stepRequirement || '',\n        agentName: step.agentName || '',\n        modelName: step.modelName || null,\n        selectedToolKeys: [],\n        terminateColumns: step.terminateColumns || '',\n        stepContent: '',\n      })),\n      directResponse: config.directResponse || false,\n      ...(planTemplateId && { planTemplateId }),\n      ...(config.planType && { planType: config.planType }),\n    }\n\n    const title = templateConfig.selectedTemplate.value.title ?? config.title ?? 'Execution Plan'\n\n    // Pass replacement parameters if available\n    const replacementParams =\n      parameterRequirements.value.hasParameters && Object.keys(parameterValues.value).length > 0\n        ? parameterValues.value\n        : undefined\n\n    console.log('[ExecutionController]  Replacement params:', replacementParams)\n    console.log('[ExecutionController]  Prepared plan data:', JSON.stringify(planData, null, 2))\n\n    // Build final payload with plan data\n    const finalPayload: PlanExecutionRequestPayload = {\n      title,\n      planData,\n      params: undefined, // params are now handled via replacementParams\n      replacementParams,\n      uploadedFiles: uploadedFiles.value,\n      uploadKey: uploadKey.value,\n    }\n\n    console.log(\n      '[ExecutionController]  Executing plan with payload:',\n      JSON.stringify(finalPayload, null, 2)\n    )\n\n    // Execute plan directly via messageDialog\n    const result = await messageDialog.executePlan(finalPayload)\n\n    if (result.success) {\n      console.log('[ExecutionController]  Plan execution started successfully:', result.planId)\n      // Track the returned planId for API examples\n      if (result.planId) {\n        lastPlanId.value = result.planId\n        console.log('[ExecutionController]  Tracked planId for API examples:', lastPlanId.value)\n      }\n    } else {\n      console.error('[ExecutionController]  Plan execution failed:', result.error)\n      toast.error(result.error || t('sidebar.executeFailed'))\n    }\n  } catch (error: unknown) {\n    console.error('[ExecutionController]  Error executing plan:', error)\n    const message = error instanceof Error ? error.message : 'Unknown error'\n    toast.error(t('sidebar.executeFailed') + ': ' + message)\n    isExecutingPlan.value = false\n  } finally {\n    console.log('[ExecutionController]  Cleaning up after execution')\n    // Clear parameters after execution\n    clearExecutionParams()\n    console.log('[ExecutionController]  Cleanup completed')\n  }\n}\n\nconst handleSaveAndExecute = async () => {\n  console.log('[ExecutionController]  Save and execute requested')\n  try {\n    // Save using templateConfig directly\n    if (!templateConfig.selectedTemplate.value) {\n      toast.error(t('sidebar.selectPlanFirst'))\n      return\n    }\n\n    // Validate config\n    const validation = templateConfig.validate()\n    if (!validation.isValid) {\n      toast.error(\n        'Invalid format, please correct and save.\\nErrors: ' + validation.errors.join(', ')\n      )\n      return\n    }\n\n    const planTemplateId = templateConfig.selectedTemplate.value.planTemplateId\n    if (!planTemplateId) {\n      toast.error('Plan template ID is required')\n      return\n    }\n\n    // Save using templateConfig (this already calls PlanTemplateApiService.createOrUpdatePlanTemplateWithTool)\n    const success = await templateConfig.save()\n    if (!success) {\n      toast.error('Failed to save plan template')\n      return\n    }\n\n    // Update versions after save\n    const content = templateConfig.generateJsonString().trim()\n    templateConfig.updateVersionsAfterSave(content)\n\n    // Get actual version count after update\n    const versionCount = templateConfig.planVersions.value.length\n\n    // Reset modification flag after successful save\n    templateStore.hasTaskRequirementModified = false\n\n    // Wait for templateConfig.save() to complete and selectedTemplate to be updated\n    // The save() method already calls load() internally, so we need to wait a bit more\n    await new Promise(resolve => setTimeout(resolve, 500))\n\n    // Refresh parameter requirements after successful save\n    // Increase delay to ensure backend has processed the save and parameters are updated\n    await refreshParameterRequirements()\n\n    // Refresh sidebar template list to reflect the saved changes\n    await templateStore.loadPlanTemplateList()\n\n    // Note: templateConfig.save() already handles the save, so we just show success\n    toast.success(t('sidebar.saveSuccess', { message: 'Plan saved successfully', versionCount }))\n\n    // Wait a bit for save to complete\n    await new Promise(resolve => setTimeout(resolve, 500))\n    // Now proceed with execution - rebuild payload with current template config\n    if (pendingExecutionPayload.value) {\n      // Rebuild payload with current template config\n      await proceedWithExecution()\n      pendingExecutionPayload.value = null\n    }\n  } catch (error: unknown) {\n    console.error('[ExecutionController]  Failed to save before execute:', error)\n    const message = error instanceof Error ? error.message : t('sidebar.saveFailed')\n    toast.error(message)\n    throw error\n  }\n}\n\nconst handleContinueExecution = async () => {\n  console.log('[ExecutionController]  Continue without save requested')\n  if (pendingExecutionPayload.value) {\n    // Rebuild payload with current template config\n    await proceedWithExecution()\n    pendingExecutionPayload.value = null\n  }\n}\n\nconst handlePublishMcpService = () => {\n  console.log('[ExecutionController] Publish MCP service button clicked')\n  console.log(\n    '[ExecutionController] currentPlanTemplateId:',\n    templateConfig.currentPlanTemplateId.value\n  )\n\n  if (!templateConfig.currentPlanTemplateId.value) {\n    console.log('[ExecutionController] No plan template selected, showing warning')\n    toast.error(t('mcpService.selectPlanTemplateFirst'))\n    return\n  }\n\n  showPublishMcpModal.value = true\n}\n\nconst clearExecutionParams = () => {\n  console.log('[ExecutionController]  clearExecutionParams called')\n  executionParams.value = ''\n  // Clear parameter values as well\n  parameterValues.value = {}\n\n  // Note: isExecutingPlan is NOT reset here - it will be reset when the plan execution completes\n  // This prevents concurrent executions while a plan is still running\n\n  console.log('[ExecutionController]  After clear - parameterValues cleared')\n  // Execution params are now managed internally, no need to emit\n}\n\n// Refresh parameter requirements (called after save)\nconst refreshParameterRequirements = async () => {\n  // Add a delay to ensure the backend has processed the new template and committed the transaction\n  // Also ensure selectedTemplate has been updated by templateConfig.save()\n  await new Promise(resolve => setTimeout(resolve, 1500))\n\n  console.log(\n    '[ExecutionController]  Refreshing parameter requirements for templateId:',\n    templateConfig.currentPlanTemplateId.value\n  )\n  console.log(\n    '[ExecutionController]  Current selectedTemplate steps:',\n    templateConfig.selectedTemplate.value?.steps?.map(s => s.stepRequirement).join(' ||| ')\n  )\n\n  // Use nextTick to ensure all reactive updates are complete\n  await new Promise(resolve => setTimeout(resolve, 200))\n\n  // Reload parameter requirements\n  await loadParameterRequirements()\n}\n\n// Load parameter requirements when plan template changes\nconst loadParameterRequirements = async () => {\n  const planTemplateId = templateConfig.currentPlanTemplateId.value\n  console.log(\n    '[ExecutionController]  loadParameterRequirements called for templateId:',\n    planTemplateId\n  )\n  console.log(\n    '[ExecutionController]  Current parameterRequirements before load:',\n    JSON.stringify(parameterRequirements.value, null, 2)\n  )\n\n  if (!planTemplateId) {\n    console.log('[ExecutionController]  No template ID, resetting parameters')\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    parameterValues.value = {}\n    return\n  }\n\n  // Clear previous data immediately to prevent stale data display\n  parameterRequirements.value = {\n    parameters: [],\n    hasParameters: false,\n    requirements: '',\n  }\n  parameterValues.value = {}\n  console.log('[ExecutionController]  Cleared previous data before loading new template')\n\n  isLoadingParameters.value = true\n  try {\n    console.log('[ExecutionController]  Fetching parameter requirements from API...')\n    const requirements = await PlanParameterApiService.getParameterRequirements(planTemplateId)\n    console.log(\n      '[ExecutionController]  Received requirements from API:',\n      JSON.stringify(requirements, null, 2)\n    )\n\n    parameterRequirements.value = requirements\n\n    // Initialize parameter values\n    const newValues: Record<string, string> = {}\n    requirements.parameters.forEach(param => {\n      newValues[param] = parameterValues.value[param] || ''\n    })\n    parameterValues.value = newValues\n\n    console.log(\n      '[ExecutionController]  Updated parameterRequirements:',\n      JSON.stringify(parameterRequirements.value, null, 2)\n    )\n    console.log(\n      '[ExecutionController]  Updated parameterValues:',\n      JSON.stringify(parameterValues.value, null, 2)\n    )\n\n    // Update execution params with current parameter values\n    updateExecutionParamsFromParameters()\n  } catch (error) {\n    console.error('[ExecutionController]  Failed to load parameter requirements:', error)\n    // Don't show error for 404 - template might not be ready yet\n    if (error instanceof Error && !error.message.includes('404')) {\n      console.warn(\n        '[ExecutionController]  Parameter requirements not available yet, will retry later'\n      )\n    }\n    parameterRequirements.value = {\n      parameters: [],\n      hasParameters: false,\n      requirements: '',\n    }\n    // Clear parameter values when there's an error to prevent stale data\n    parameterValues.value = {}\n    console.log(\n      '[ExecutionController]  Reset parameterRequirements due to error:',\n      JSON.stringify(parameterRequirements.value, null, 2)\n    )\n    console.log(\n      '[ExecutionController]  Cleared parameterValues:',\n      JSON.stringify(parameterValues.value, null, 2)\n    )\n  } finally {\n    isLoadingParameters.value = false\n    console.log('[ExecutionController]  loadParameterRequirements completed')\n  }\n}\n\n// Update parameter value and sync with execution params\nconst updateParameterValue = (paramName: string, value: string) => {\n  parameterValues.value[paramName] = value\n  // Clear error for this parameter when user starts typing\n  if (parameterErrors.value[paramName]) {\n    delete parameterErrors.value[paramName]\n  }\n  updateExecutionParamsFromParameters()\n}\n\n// Validate all parameters\nconst validateParameters = (): boolean => {\n  parameterErrors.value = {}\n  isValidationError.value = false\n\n  if (!parameterRequirements.value.hasParameters) {\n    return true\n  }\n\n  let hasErrors = false\n\n  parameterRequirements.value.parameters.forEach(param => {\n    const value = parameterValues.value[param] ? parameterValues.value[param].trim() : ''\n    if (!value) {\n      parameterErrors.value[param] = `${param} is required`\n      hasErrors = true\n    }\n  })\n\n  isValidationError.value = hasErrors\n  return !hasErrors\n}\n\n// Update execution params from parameter values\nconst updateExecutionParamsFromParameters = () => {\n  if (parameterRequirements.value.hasParameters) {\n    // Convert parameter values to JSON string for execution\n    executionParams.value = JSON.stringify(parameterValues.value, null, 2)\n  } else {\n    executionParams.value = ''\n  }\n  // Execution params are now managed internally, no need to emit\n}\n\n// Watch for changes in plan template ID\nwatch(\n  () => templateConfig.currentPlanTemplateId.value,\n  (newId, oldId) => {\n    if (newId && newId !== oldId) {\n      // Skip parameter reload if we're currently executing a plan\n      if (isExecutingPlan.value) {\n        console.log('[ExecutionController]  Skipping parameter reload - plan is executing')\n        return\n      }\n\n      console.log('[ExecutionController]  Template ID changed, will reload parameters')\n      // If this is a new template ID (not from initial load), retry loading parameters\n      if (oldId && newId.startsWith('planTemplate-')) {\n        console.log('[ExecutionController]  New template detected, retrying with delay...')\n        // Retry loading parameters with a delay for new templates\n        setTimeout(() => {\n          console.log('[ExecutionController]  Delay timeout, calling loadParameterRequirements')\n          loadParameterRequirements()\n        }, 1000)\n      } else {\n        console.log('[ExecutionController]  Immediate reload of parameters')\n        loadParameterRequirements()\n      }\n    }\n  }\n)\n\n// Watch for hasTaskRequirementModified flag change from true to false (indicates save completed)\n// This is the only watch that triggers parameter refresh - only on save, not on input\nwatch(\n  () => templateStore.hasTaskRequirementModified,\n  async (newValue, oldValue) => {\n    // When modification flag changes from true to false, it means save was completed\n    if (oldValue === true && newValue === false && templateConfig.currentPlanTemplateId.value) {\n      // Skip if currently executing\n      if (isExecutingPlan.value) {\n        console.log('[ExecutionController]  Skipping parameter reload - plan is executing')\n        return\n      }\n\n      console.log(\n        '[ExecutionController]  Save completed (hasTaskRequirementModified: true -> false), refreshing parameters'\n      )\n      // Add a delay to ensure backend has processed the save and parameters are updated\n      // Also ensure selectedTemplate has been updated by templateConfig.save()\n      await new Promise(resolve => setTimeout(resolve, 2000))\n      console.log('[ExecutionController]  Refreshing parameters after save')\n      await refreshParameterRequirements()\n    }\n  }\n)\n\n// Watch for plan execution completion to reset isExecutingPlan\nwatchEffect(() => {\n  const records = planExecution.planExecutionRecords\n  const recordsArray = Array.from(records.entries())\n\n  // Check both trackedPlanIds and planExecutionRecords to handle the case where\n  // a plan has just started but hasn't been polled yet (no record in planExecutionRecords)\n  const hasTrackedPlans = planExecution.trackedPlanIds.value.size > 0\n  const hasRunningPlansInRecords = recordsArray.some(\n    ([, record]) => record && !record.completed && record.status !== 'failed'\n  )\n\n  // If there are tracked plans but no records yet, consider it as running\n  // This handles the race condition where a plan just started but hasn't been polled\n  const hasRunningPlans = hasTrackedPlans || hasRunningPlansInRecords\n\n  // Reset isExecutingPlan when all plans are completed\n  if (!hasRunningPlans && isExecutingPlan.value) {\n    console.log('[ExecutionController] All plans completed, resetting isExecutingPlan', {\n      hasTrackedPlans,\n      hasRunningPlansInRecords,\n      trackedPlanIds: Array.from(planExecution.trackedPlanIds.value),\n      recordsCount: recordsArray.length,\n    })\n    isExecutingPlan.value = false\n  }\n})\n\n// Execution params are now managed internally, no need to emit updates\n\n// Load parameters on mount\nonMounted(() => {\n  loadParameterRequirements()\n})\n\n// Expose methods for parent component\ndefineExpose({\n  executionParams,\n  clearExecutionParams,\n  loadParameterRequirements,\n  refreshParameterRequirements,\n  fileUploadRef,\n  uploadedFiles,\n  uploadKey,\n})\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.execution-content {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.params-requirements-group {\n  label {\n    display: block;\n    margin-bottom: 6px;\n    font-size: 12px;\n    color: rgba(255, 255, 255, 0.8);\n    font-weight: 500;\n  }\n\n  .params-help-text {\n    margin-bottom: 12px;\n    font-size: 11px;\n    color: rgba(255, 255, 255, 0.6);\n    line-height: 1.4;\n    padding: 6px 8px;\n    background: rgba(102, 126, 234, 0.1);\n    border: 1px solid rgba(102, 126, 234, 0.2);\n    border-radius: 4px;\n  }\n\n  .parameter-fields {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n    margin-bottom: 12px;\n  }\n\n  .parameter-field {\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n\n    .parameter-label {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.8);\n      font-weight: 500;\n      display: flex;\n      align-items: center;\n      gap: 4px;\n\n      .required {\n        color: #ff6b6b;\n        font-weight: bold;\n      }\n    }\n\n    .parameter-input {\n      width: 100%;\n      background: rgba(0, 0, 0, 0.3);\n      border: 1px solid rgba(255, 255, 255, 0.2);\n      border-radius: 6px;\n      color: white;\n      font-size: 12px;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      padding: 8px 12px;\n      min-height: 36px;\n\n      &:focus {\n        outline: none;\n        border-color: #667eea;\n        box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n      }\n\n      &::placeholder {\n        color: rgba(255, 255, 255, 0.4);\n      }\n\n      &.error {\n        border-color: #ff6b6b;\n        box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.2);\n      }\n    }\n\n    .parameter-error {\n      color: #ff6b6b;\n      font-size: 11px;\n      margin-top: 4px;\n      display: block;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    }\n  }\n\n  .validation-message {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    color: #ffa726;\n    font-size: 14px;\n    margin-top: 8px;\n    padding: 8px 12px;\n    background: rgba(255, 167, 38, 0.1);\n    border: 1px solid rgba(255, 167, 38, 0.3);\n    border-radius: 4px;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  }\n}\n\n.call-example-wrapper {\n  margin-top: 12px;\n}\n\n.call-example-header {\n  margin-bottom: 12px;\n}\n\n.call-example-title {\n  color: #667eea;\n  font-size: 14px;\n  font-weight: 600;\n  margin: 0 0 6px 0;\n}\n\n.call-example-description {\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 12px;\n  line-height: 1.4;\n  margin: 0;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n}\n\n.http-api-urls-wrapper {\n  margin-top: 0;\n}\n\n.internal-call-wrapper,\n.mcp-call-wrapper {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.call-info {\n  font-size: 11px;\n\n  .call-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .call-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .call-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .call-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.tab-container {\n  background: rgba(0, 0, 0, 0.2);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.tab-header {\n  display: flex;\n  background: rgba(0, 0, 0, 0.3);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tab-button {\n  flex: 1;\n  padding: 8px 12px;\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 11px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n\n  &:last-child {\n    border-right: none;\n  }\n\n  &:hover {\n    background: rgba(102, 126, 234, 0.1);\n    color: rgba(255, 255, 255, 0.8);\n  }\n\n  &.active {\n    background: rgba(102, 126, 234, 0.2);\n    color: #667eea;\n    font-weight: 600;\n  }\n}\n\n.tab-content {\n  padding: 0;\n}\n\n.tab-panel {\n  padding: 0;\n}\n\n.http-api-url-display {\n  padding: 12px;\n  font-size: 11px;\n\n  .api-method {\n    display: inline-block;\n    padding: 2px 6px;\n    background: #667eea;\n    color: white;\n    border-radius: 3px;\n    font-size: 10px;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .api-endpoint {\n    color: #64b5f6;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 12px;\n    margin-bottom: 8px;\n    word-break: break-all;\n    background: rgba(0, 0, 0, 0.3);\n    padding: 6px 8px;\n    border-radius: 4px;\n    border: 1px solid rgba(100, 181, 246, 0.2);\n  }\n\n  .api-description {\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 8px;\n    line-height: 1.4;\n  }\n\n  .api-example {\n    margin-top: 8px;\n\n    strong {\n      color: rgba(255, 255, 255, 0.9);\n      font-size: 10px;\n      display: block;\n      margin-bottom: 4px;\n    }\n\n    .example-code {\n      background: rgba(0, 0, 0, 0.4);\n      border: 1px solid rgba(255, 255, 255, 0.1);\n      border-radius: 4px;\n      padding: 8px;\n      color: #e0e0e0;\n      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n      font-size: 10px;\n      line-height: 1.3;\n      white-space: pre-wrap;\n      word-break: break-all;\n      overflow-x: auto;\n    }\n  }\n}\n\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n\n  &.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-1px);\n      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n    }\n  }\n\n  &.publish-mcp-btn {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: #ffffff;\n    border: none;\n\n    &:hover:not(:disabled) {\n      transform: translateY(-2px);\n      box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);\n    }\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none !important;\n    box-shadow: none !important;\n  }\n\n  .spinning {\n    animation: spin 1s linear infinite;\n  }\n}\n\n.execute-btn,\n.publish-mcp-btn {\n  padding: 10px 16px;\n  font-size: 13px;\n  font-weight: 500;\n  width: 100%;\n  margin-bottom: 8px;\n}\n\n.publish-mcp-btn {\n  margin-bottom: 0;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","'use strict';\n\n/**\n * Create a bound version of a function with a specified `this` context\n *\n * @param {Function} fn - The function to bind\n * @param {*} thisArg - The value to be passed as the `this` parameter\n * @returns {Function} A new function that will call the original function with the specified `this` context\n */\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\nconst {iterator, toStringTag} = Symbol;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(toStringTag in val) && !(iterator in val);\n}\n\n/**\n * Determine if a value is an empty object (safely handles Buffers)\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an empty object, otherwise false\n */\nconst isEmptyObject = (val) => {\n  // Early return for non-objects or Buffers to prevent RangeError\n  if (!isObject(val) || isBuffer(val)) {\n    return false;\n  }\n\n  try {\n    return Object.keys(val).length === 0 && Object.getPrototypeOf(val) === Object.prototype;\n  } catch (e) {\n    // Fallback for any other objects that might cause RangeError with Object.keys()\n    return false;\n  }\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Buffer check\n    if (isBuffer(obj)) {\n      return;\n    }\n\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  if (isBuffer(obj)){\n    return null;\n  }\n\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless, skipUndefined} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else if (!skipUndefined || !isUndefined(val)) {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[iterator];\n\n  const _iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = _iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[toStringTag] === 'FormData' && thing[iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      //Buffer check\n      if (isBuffer(source)) {\n        return source;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\n\nconst isIterable = (thing) => thing != null && isFunction(thing[iterator]);\n\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isEmptyObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap,\n  isIterable\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  const msg = error && error.message ? error.message : 'Error';\n\n  // Prefer explicit code; otherwise copy the low-level error's code (e.g. ECONNREFUSED)\n  const errCode = code == null && error ? error.code : code;\n  AxiosError.call(axiosError, msg, errCode, config, request, response);\n\n  // Chain the original error on the standard field; non-enumerable to avoid JSON noise\n  if (error && axiosError.cause == null) {\n    Object.defineProperty(axiosError, 'cause', { value: error, configurable: true });\n  }\n\n  axiosError.name = (error && error.name) || 'Error';\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (utils.isBoolean(value)) {\n      return value.toString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {void}\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), {\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    },\n    ...options\n  });\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data, this.parseReviver);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isObject(header) && utils.isIterable(header)) {\n      let obj = {}, dest, key;\n      for (const entry of header) {\n        if (!utils.isArray(entry)) {\n          throw TypeError('Object iterator must return a key-value pair');\n        }\n\n        obj[key = entry[0]] = (dest = obj[key]) ?\n          (utils.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]]) : entry[1];\n      }\n\n      setHeaders(obj, valueOrRewrite)\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  getSetCookie() {\n    return this.get(\"set-cookie\") || [];\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn(...args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure, sameSite) {\n      if (typeof document === 'undefined') return;\n\n      const cookie = [`${name}=${encodeURIComponent(value)}`];\n\n      if (utils.isNumber(expires)) {\n        cookie.push(`expires=${new Date(expires).toUTCString()}`);\n      }\n      if (utils.isString(path)) {\n        cookie.push(`path=${path}`);\n      }\n      if (utils.isString(domain)) {\n        cookie.push(`domain=${domain}`);\n      }\n      if (secure === true) {\n        cookie.push('secure');\n      }\n      if (utils.isString(sameSite)) {\n        cookie.push(`SameSite=${sameSite}`);\n      }\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      if (typeof document === 'undefined') return null;\n      const match = document.cookie.match(new RegExp('(?:^|; )' + name + '=([^;]*)'));\n      return match ? decodeURIComponent(match[1]) : null;\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000, '/');\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop, caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop, caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop, caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b, prop) => mergeDeepProperties(headersToObject(a), headersToObject(b), prop, true)\n  };\n\n  utils.forEach(Object.keys({...config1, ...config2}), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let { data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth } = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // browser handles it\n    } else if (utils.isFunction(data.getHeaders)) {\n      // Node.js FormData (like form-data package)\n      const formHeaders = data.getHeaders();\n      // Only set safe headers to avoid overwriting security headers\n      const allowedHeaders = ['content-type', 'content-length'];\n      Object.entries(formHeaders).forEach(([key, val]) => {\n        if (allowedHeaders.includes(key.toLowerCase())) {\n          headers.set(key, val);\n        }\n      });\n    }\n  }  \n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n  request.onerror = function handleError(event) {\n       // Browsers deliver a ProgressEvent in XHR onerror\n       // (message may be empty; when present, surface it)\n       // See https://developer.mozilla.org/docs/Web/API/XMLHttpRequest/error_event\n       const msg = event && event.message ? event.message : 'Network Error';\n       const err = new AxiosError(msg, AxiosError.ERR_NETWORK, config, request);\n       // attach the underlying event for consumers who want details\n       err.event = event || null;\n       reject(err);\n       request = null;\n    };\n    \n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst {isFunction} = utils;\n\nconst globalFetchAPI = (({Request, Response}) => ({\n  Request, Response\n}))(utils.global);\n\nconst {\n  ReadableStream, TextEncoder\n} = utils.global;\n\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst factory = (env) => {\n  env = utils.merge.call({\n    skipUndefined: true\n  }, globalFetchAPI, env);\n\n  const {fetch: envFetch, Request, Response} = env;\n  const isFetchSupported = envFetch ? isFunction(envFetch) : typeof fetch === 'function';\n  const isRequestSupported = isFunction(Request);\n  const isResponseSupported = isFunction(Response);\n\n  if (!isFetchSupported) {\n    return false;\n  }\n\n  const isReadableStreamSupported = isFetchSupported && isFunction(ReadableStream);\n\n  const encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n      ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n      async (str) => new Uint8Array(await new Request(str).arrayBuffer())\n  );\n\n  const supportsRequestStream = isRequestSupported && isReadableStreamSupported && test(() => {\n    let duplexAccessed = false;\n\n    const hasContentType = new Request(platform.origin, {\n      body: new ReadableStream(),\n      method: 'POST',\n      get duplex() {\n        duplexAccessed = true;\n        return 'half';\n      },\n    }).headers.has('Content-Type');\n\n    return duplexAccessed && !hasContentType;\n  });\n\n  const supportsResponseStream = isResponseSupported && isReadableStreamSupported &&\n    test(() => utils.isReadableStream(new Response('').body));\n\n  const resolvers = {\n    stream: supportsResponseStream && ((res) => res.body)\n  };\n\n  isFetchSupported && ((() => {\n    ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n      !resolvers[type] && (resolvers[type] = (res, config) => {\n        let method = res && res[type];\n\n        if (method) {\n          return method.call(res);\n        }\n\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n    });\n  })());\n\n  const getBodyLength = async (body) => {\n    if (body == null) {\n      return 0;\n    }\n\n    if (utils.isBlob(body)) {\n      return body.size;\n    }\n\n    if (utils.isSpecCompliantForm(body)) {\n      const _request = new Request(platform.origin, {\n        method: 'POST',\n        body,\n      });\n      return (await _request.arrayBuffer()).byteLength;\n    }\n\n    if (utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n      return body.byteLength;\n    }\n\n    if (utils.isURLSearchParams(body)) {\n      body = body + '';\n    }\n\n    if (utils.isString(body)) {\n      return (await encodeText(body)).byteLength;\n    }\n  }\n\n  const resolveBodyLength = async (headers, body) => {\n    const length = utils.toFiniteNumber(headers.getContentLength());\n\n    return length == null ? getBodyLength(body) : length;\n  }\n\n  return async (config) => {\n    let {\n      url,\n      method,\n      data,\n      signal,\n      cancelToken,\n      timeout,\n      onDownloadProgress,\n      onUploadProgress,\n      responseType,\n      headers,\n      withCredentials = 'same-origin',\n      fetchOptions\n    } = resolveConfig(config);\n\n    let _fetch = envFetch || fetch;\n\n    responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n    let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n    let request = null;\n\n    const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n    });\n\n    let requestContentLength;\n\n    try {\n      if (\n        onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n        (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n      ) {\n        let _request = new Request(url, {\n          method: 'POST',\n          body: data,\n          duplex: \"half\"\n        });\n\n        let contentTypeHeader;\n\n        if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n          headers.setContentType(contentTypeHeader)\n        }\n\n        if (_request.body) {\n          const [onProgress, flush] = progressEventDecorator(\n            requestContentLength,\n            progressEventReducer(asyncDecorator(onUploadProgress))\n          );\n\n          data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n        }\n      }\n\n      if (!utils.isString(withCredentials)) {\n        withCredentials = withCredentials ? 'include' : 'omit';\n      }\n\n      // Cloudflare Workers throws when credentials are defined\n      // see https://github.com/cloudflare/workerd/issues/902\n      const isCredentialsSupported = isRequestSupported && \"credentials\" in Request.prototype;\n\n      const resolvedOptions = {\n        ...fetchOptions,\n        signal: composedSignal,\n        method: method.toUpperCase(),\n        headers: headers.normalize().toJSON(),\n        body: data,\n        duplex: \"half\",\n        credentials: isCredentialsSupported ? withCredentials : undefined\n      };\n\n      request = isRequestSupported && new Request(url, resolvedOptions);\n\n      let response = await (isRequestSupported ? _fetch(request, fetchOptions) : _fetch(url, resolvedOptions));\n\n      const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n      if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n        const options = {};\n\n        ['status', 'statusText', 'headers'].forEach(prop => {\n          options[prop] = response[prop];\n        });\n\n        const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n        const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n          responseContentLength,\n          progressEventReducer(asyncDecorator(onDownloadProgress), true)\n        ) || [];\n\n        response = new Response(\n          trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n            flush && flush();\n            unsubscribe && unsubscribe();\n          }),\n          options\n        );\n      }\n\n      responseType = responseType || 'text';\n\n      let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n      !isStreamResponse && unsubscribe && unsubscribe();\n\n      return await new Promise((resolve, reject) => {\n        settle(resolve, reject, {\n          data: responseData,\n          headers: AxiosHeaders.from(response.headers),\n          status: response.status,\n          statusText: response.statusText,\n          config,\n          request\n        })\n      })\n    } catch (err) {\n      unsubscribe && unsubscribe();\n\n      if (err && err.name === 'TypeError' && /Load failed|fetch/i.test(err.message)) {\n        throw Object.assign(\n          new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n          {\n            cause: err.cause || err\n          }\n        )\n      }\n\n      throw AxiosError.from(err, err && err.code, config, request);\n    }\n  }\n}\n\nconst seedCache = new Map();\n\nexport const getFetch = (config) => {\n  let env = (config && config.env) || {};\n  const {fetch, Request, Response} = env;\n  const seeds = [\n    Request, Response, fetch\n  ];\n\n  let len = seeds.length, i = len,\n    seed, target, map = seedCache;\n\n  while (i--) {\n    seed = seeds[i];\n    target = map.get(seed);\n\n    target === undefined && map.set(seed, target = (i ? new Map() : factory(env)))\n\n    map = target;\n  }\n\n  return target;\n};\n\nconst adapter = getFetch();\n\nexport default adapter;\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport * as fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\n/**\n * Known adapters mapping.\n * Provides environment-specific adapters for Axios:\n * - `http` for Node.js\n * - `xhr` for browsers\n * - `fetch` for fetch API-based requests\n * \n * @type {Object<string, Function|Object>}\n */\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: {\n    get: fetchAdapter.getFetch,\n  }\n};\n\n// Assign adapter names for easier debugging and identification\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', { value });\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', { value });\n  }\n});\n\n/**\n * Render a rejection reason string for unknown or unsupported adapters\n * \n * @param {string} reason\n * @returns {string}\n */\nconst renderReason = (reason) => `- ${reason}`;\n\n/**\n * Check if the adapter is resolved (function, null, or false)\n * \n * @param {Function|null|false} adapter\n * @returns {boolean}\n */\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\n/**\n * Get the first suitable adapter from the provided list.\n * Tries each adapter in order until a supported one is found.\n * Throws an AxiosError if no adapter is suitable.\n * \n * @param {Array<string|Function>|string|Function} adapters - Adapter(s) by name or function.\n * @param {Object} config - Axios request configuration\n * @throws {AxiosError} If no suitable adapter is available\n * @returns {Function} The resolved adapter function\n */\nfunction getAdapter(adapters, config) {\n  adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n  const { length } = adapters;\n  let nameOrAdapter;\n  let adapter;\n\n  const rejectedReasons = {};\n\n  for (let i = 0; i < length; i++) {\n    nameOrAdapter = adapters[i];\n    let id;\n\n    adapter = nameOrAdapter;\n\n    if (!isResolvedHandle(nameOrAdapter)) {\n      adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n      if (adapter === undefined) {\n        throw new AxiosError(`Unknown adapter '${id}'`);\n      }\n    }\n\n    if (adapter && (utils.isFunction(adapter) || (adapter = adapter.get(config)))) {\n      break;\n    }\n\n    rejectedReasons[id || '#' + i] = adapter;\n  }\n\n  if (!adapter) {\n    const reasons = Object.entries(rejectedReasons)\n      .map(([id, state]) => `adapter ${id} ` +\n        (state === false ? 'is not supported by the environment' : 'is not available in the build')\n      );\n\n    let s = length ?\n      (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n      'as no adapter specified';\n\n    throw new AxiosError(\n      `There is no suitable adapter to dispatch the request ` + s,\n      'ERR_NOT_SUPPORT'\n    );\n  }\n\n  return adapter;\n}\n\n/**\n * Exports Axios adapters and utility to resolve an adapter\n */\nexport default {\n  /**\n   * Resolve an adapter from a list of adapter names or functions.\n   * @type {Function}\n   */\n  getAdapter,\n\n  /**\n   * Exposes all known adapters\n   * @type {Object<string, Function|Object>}\n   */\n  adapters: knownAdapters\n};\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter, config);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.13.2\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig || {};\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift(...requestInterceptorChain);\n      chain.push(...responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n  WebServerIsDown: 521,\n  ConnectionTimedOut: 522,\n  OriginIsUnreachable: 523,\n  TimeoutOccurred: 524,\n  SslHandshakeFailed: 525,\n  InvalidSslCertificate: 526,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n","import type { AxiosResponse } from 'axios'\nimport axios from 'axios'\n\nexport interface ModelOption {\n  value: string\n  label: string\n}\n\nexport interface AvailableModelsResponse {\n  options: ModelOption[]\n  total: number\n}\n\nexport class ConfigApiService {\n  /**\n   * Get available model list\n   */\n  public static async getAvailableModels(): Promise<AvailableModelsResponse> {\n    try {\n      const response: AxiosResponse<AvailableModelsResponse> = await axios({\n        url: '/api/models/available-models',\n        method: 'GET',\n        baseURL: '', // Override the default /api/v1 baseURL\n      })\n      return response.data\n    } catch (error) {\n      console.error('Failed to fetch available models:', error)\n      return { options: [], total: 0 }\n    }\n  }\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"assigned-tools\">\n    <div class=\"section-header\">\n      <span>{{ title }} ({{ filteredSelectedToolIds.length }})</span>\n      <button class=\"action-btn small\" @click=\"$emit('add-tools')\" v-if=\"showAddButton\">\n        <Icon icon=\"carbon:add\" />\n        {{ addButtonText }}\n      </button>\n    </div>\n\n    <div\n      class=\"tools-grid\"\n      :class=\"{\n        'grid-layout': useGridLayout,\n        'has-more-items': useGridLayout && filteredSelectedToolIds.length > 2,\n      }\"\n    >\n      <div\n        v-for=\"toolId in filteredSelectedToolIds\"\n        :key=\"toolId\"\n        class=\"tool-item assigned\"\n        :title=\"getToolDescription(toolId)\"\n      >\n        <div class=\"tool-info\">\n          <span class=\"tool-name\">{{ getToolDisplayNameWithGroup(toolId) }}</span>\n          <span class=\"tool-desc\" :title=\"getToolDescription(toolId)\">{{\n            getToolDescription(toolId)\n          }}</span>\n        </div>\n      </div>\n\n      <div v-if=\"filteredSelectedToolIds.length === 0\" class=\"no-tools\">\n        <Icon icon=\"carbon:tool-box\" />\n        <span>{{ emptyText }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { useAvailableToolsSingleton } from '@/composables/useAvailableTools'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, watch } from 'vue'\n\n// Props\ninterface Props {\n  title: string\n  selectedToolIds: string[]\n  addButtonText?: string\n  emptyText?: string\n  showAddButton?: boolean\n  useGridLayout?: boolean\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  addButtonText: 'Add/Remove Tools',\n  emptyText: 'No tools assigned',\n  showAddButton: true,\n  useGridLayout: false,\n})\n\n// Emits\nconst emit = defineEmits<{\n  'add-tools': []\n  'tools-filtered': [filteredToolIds: string[]]\n}>()\n\n// Get available tools from singleton\nconst availableToolsStore = useAvailableToolsSingleton()\nconst availableTools = computed(() => availableToolsStore.availableTools.value)\n\n// Load available tools on mount if not already loaded\nonMounted(() => {\n  if (availableTools.value.length === 0 && !availableToolsStore.isLoading.value) {\n    availableToolsStore.loadAvailableTools()\n  }\n})\n\n// Computed property to filter out tools that are not in availableTools\nconst filteredSelectedToolIds = computed(() => {\n  if (!Array.isArray(props.selectedToolIds)) {\n    return []\n  }\n  return props.selectedToolIds.filter(toolId =>\n    availableTools.value.some(tool => tool.key === toolId)\n  )\n})\n\n// Watch for changes in filtered tools and emit event\nwatch(\n  filteredSelectedToolIds,\n  newFilteredTools => {\n    // Only emit if there's a difference (some tools were filtered out)\n    // Check if selectedToolIds is defined and is an array\n    if (!Array.isArray(props.selectedToolIds)) {\n      return\n    }\n    const selectedLength = props.selectedToolIds.length\n    if (newFilteredTools.length !== selectedLength) {\n      emit('tools-filtered', newFilteredTools)\n    }\n  },\n  { immediate: true }\n)\n\n// Methods\nconst getToolDisplayNameWithGroup = (toolId: string): string => {\n  const tool = availableTools.value.find(t => t.key === toolId)\n  if (!tool) return toolId\n\n  const group = tool.serviceGroup || 'Ungrouped'\n  return `${group}.${tool.name}`\n}\n\nconst getToolDescription = (toolId: string): string => {\n  const tool = availableTools.value.find(t => t.key === toolId)\n  return tool ? tool.description : ''\n}\n</script>\n\n<style scoped>\n.assigned-tools {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 8px;\n}\n\n.section-header span {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: #fff;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.action-btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.action-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.action-btn.small {\n  padding: 6px 10px;\n  font-size: 11px;\n}\n\n.tools-grid {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.tools-grid.grid-layout {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n  gap: 12px;\n  max-height: calc(2 * (var(--tool-item-height, 80px) + 12px));\n  overflow-y: auto;\n  overflow-x: hidden;\n  position: relative;\n  scrollbar-width: thin;\n  scrollbar-color: rgba(102, 126, 234, 0.5) transparent;\n}\n\n.tools-grid.grid-layout::-webkit-scrollbar {\n  width: 6px;\n}\n\n.tools-grid.grid-layout::-webkit-scrollbar-track {\n  background: transparent;\n}\n\n.tools-grid.grid-layout::-webkit-scrollbar-thumb {\n  background: rgba(102, 126, 234, 0.5);\n  border-radius: 3px;\n}\n\n.tools-grid.grid-layout::-webkit-scrollbar-thumb:hover {\n  background: rgba(102, 126, 234, 0.7);\n}\n\n.tools-grid.grid-layout::after {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  height: 20px;\n  background: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.3));\n  pointer-events: none;\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.tools-grid.grid-layout.has-more-items::after {\n  opacity: 1;\n}\n\n.tool-item {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  transition: all 0.3s ease;\n  --tool-item-height: 80px;\n}\n\n.tools-grid.grid-layout .tool-item {\n  padding: 12px;\n  justify-content: flex-start;\n}\n\n.tool-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.tool-item.assigned {\n  border-color: rgba(102, 126, 234, 0.3);\n  background: rgba(102, 126, 234, 0.1);\n}\n\n.tool-info {\n  display: flex;\n  flex-direction: column;\n  gap: 4px;\n  flex: 1;\n}\n\n.tool-name {\n  display: block;\n  font-weight: 500;\n  margin-bottom: 4px;\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n}\n\n.tool-desc {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.6);\n  line-height: 1.3;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  cursor: help;\n  position: relative;\n}\n\n.no-tools {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  padding: 40px;\n  color: rgba(255, 255, 255, 0.4);\n  font-style: italic;\n}\n\n.tools-grid.grid-layout .no-tools {\n  padding: 16px;\n  font-size: 12px;\n  grid-column: 1 / -1;\n}\n\n.no-tools svg {\n  width: 20px;\n  height: 20px;\n  opacity: 0.5;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <Modal\n    v-model=\"visible\"\n    :title=\"$t('toolSelection.title')\"\n    @confirm=\"handleConfirm\"\n    @update:model-value=\"handleCancel\"\n  >\n    <div class=\"tool-selection-content\">\n      <!-- Search and Sort -->\n      <div class=\"tool-controls\">\n        <div class=\"search-container\">\n          <input\n            v-model=\"searchQuery\"\n            type=\"text\"\n            class=\"search-input\"\n            :placeholder=\"$t('toolSelection.searchPlaceholder')\"\n          />\n        </div>\n        <div class=\"sort-container\">\n          <select v-model=\"sortBy\" class=\"sort-select\">\n            <option value=\"group\">{{ $t('toolSelection.sortByGroup') }}</option>\n            <option value=\"name\">{{ $t('toolSelection.sortByName') }}</option>\n            <option value=\"enabled\">{{ $t('toolSelection.sortByStatus') }}</option>\n          </select>\n        </div>\n      </div>\n\n      <!-- Tool Statistics -->\n      <div class=\"tool-summary\">\n        <span class=\"summary-text\">\n          {{\n            $t('toolSelection.summary', {\n              groups: groupedTools.size,\n              tools: totalTools,\n              selected: selectedTools.length,\n            })\n          }}\n        </span>\n      </div>\n\n      <!-- Tool Group List -->\n      <div class=\"tool-groups\" v-if=\"groupedTools.size > 0\">\n        <div v-for=\"[groupName, tools] in groupedTools\" :key=\"groupName\" class=\"tool-group\">\n          <!-- Group Header -->\n          <div\n            class=\"tool-group-header\"\n            :class=\"{ collapsed: collapsedGroups.has(groupName) }\"\n            @click=\"toggleGroupCollapse(groupName)\"\n          >\n            <div class=\"group-title-area\">\n              <Icon\n                :icon=\"\n                  collapsedGroups.has(groupName) ? 'carbon:chevron-right' : 'carbon:chevron-down'\n                \"\n                class=\"collapse-icon\"\n              />\n              <Icon icon=\"carbon:folder\" class=\"group-icon\" />\n              <span class=\"group-name\">{{ groupName }}</span>\n              <span class=\"group-count\">\n                ({{ getSelectedToolsInGroup(tools).length }}/{{ tools.length }})\n              </span>\n            </div>\n            <div class=\"group-actions\" @click.stop>\n              <label class=\"group-enable-all\">\n                <input\n                  type=\"checkbox\"\n                  class=\"group-enable-checkbox\"\n                  :checked=\"isGroupFullySelected(tools)\"\n                  @change=\"toggleGroupSelection(tools, $event)\"\n                  :data-group=\"groupName\"\n                />\n                <span class=\"enable-label\">{{ $t('toolSelection.enableAll') }}</span>\n              </label>\n            </div>\n          </div>\n\n          <!-- Group Content -->\n          <div class=\"tool-group-content\" :class=\"{ collapsed: collapsedGroups.has(groupName) }\">\n            <div v-for=\"tool in tools\" :key=\"tool.key\" class=\"tool-selection-item\">\n              <div class=\"tool-info\">\n                <div class=\"tool-selection-name\">{{ tool.name }}</div>\n                <div v-if=\"tool.description\" class=\"tool-selection-desc\">\n                  {{ tool.description }}\n                </div>\n              </div>\n              <div class=\"tool-actions\">\n                <label class=\"tool-enable-switch\" @click.stop>\n                  <input\n                    type=\"checkbox\"\n                    class=\"tool-enable-checkbox\"\n                    :checked=\"isToolSelected(tool.key)\"\n                    @change=\"toggleToolSelection(tool.key, $event)\"\n                  />\n                  <span class=\"tool-enable-slider\"></span>\n                </label>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- Empty State -->\n      <div v-else class=\"empty-state\">\n        <Icon icon=\"carbon:tools\" class=\"empty-icon\" />\n        <p>{{ $t('toolSelection.noToolsFound') }}</p>\n      </div>\n    </div>\n  </Modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { useAvailableToolsSingleton } from '@/composables/useAvailableTools'\nimport type { Tool } from '@/types/tool'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, ref, watch } from 'vue'\nimport Modal from '../modal/index.vue'\n\ninterface Props {\n  modelValue: boolean\n  selectedToolIds: string[]\n}\n\ninterface Emits {\n  (e: 'update:modelValue', value: boolean): void\n  (e: 'confirm', selectedToolIds: string[]): void\n}\n\nconst props = defineProps<Props>()\nconst emit = defineEmits<Emits>()\n\n// Get available tools from singleton\nconst availableToolsStore = useAvailableToolsSingleton()\nconst tools = computed(() => availableToolsStore.availableTools.value as Tool[])\n\n// Load available tools on mount if not already loaded\nonMounted(() => {\n  if (tools.value.length === 0 && !availableToolsStore.isLoading.value) {\n    availableToolsStore.loadAvailableTools()\n  }\n})\n\n// Also load when modal opens - always refresh to get latest tools\nwatch(\n  () => props.modelValue,\n  isVisible => {\n    if (isVisible && !availableToolsStore.isLoading.value) {\n      // Always refresh tools when modal opens to get newly published tools\n      availableToolsStore.loadAvailableTools()\n    }\n  }\n)\n\n// Reactive state\nconst visible = computed({\n  get: () => props.modelValue,\n  set: value => emit('update:modelValue', value),\n})\n\nconst searchQuery = ref('')\nconst sortBy = ref<'group' | 'name' | 'enabled'>('group')\nconst collapsedGroups = ref(new Set<string>())\nconst selectedTools = ref<string[]>([])\n// Store the collapsed state before search to restore when search is cleared\nconst collapsedGroupsBeforeSearch = ref<Set<string> | null>(null)\n\n// Set group checkbox indeterminate state\nconst updateGroupCheckboxState = (groupName: string, tools: Tool[]) => {\n  const checkbox = document.querySelector(\n    `input[data-group=\"${groupName}\"]`\n  ) as HTMLInputElement | null\n  if (checkbox) {\n    checkbox.indeterminate = isGroupPartiallySelected(tools)\n  }\n}\n\n// Initialize the selected tools\nwatch(\n  () => props.selectedToolIds,\n  newIds => {\n    selectedTools.value = [...newIds]\n  },\n  { immediate: true }\n)\n\n// Filtered and sorted tools\nconst filteredTools = computed(() => {\n  let filtered = tools.value.filter(tool => tool.key) // Filter out invalid tools\n\n  // Filter out non-selectable tools\n  filtered = filtered.filter(tool => tool.selectable === true)\n\n  // Search filter\n  if (searchQuery.value) {\n    const query = searchQuery.value.toLowerCase()\n    filtered = filtered.filter(\n      tool =>\n        tool.name.toLowerCase().includes(query) ||\n        tool.description.toLowerCase().includes(query) ||\n        tool.serviceGroup.toLowerCase().includes(query)\n    )\n  }\n\n  // Sorting\n  switch (sortBy.value) {\n    case 'name':\n      filtered = [...filtered].sort((a, b) => a.name.localeCompare(b.name))\n      break\n    case 'enabled':\n      filtered = [...filtered].sort((a, b) => {\n        const aSelected = selectedTools.value.includes(a.key)\n        const bSelected = selectedTools.value.includes(b.key)\n        if (aSelected && !bSelected) return -1\n        if (!aSelected && bSelected) return 1\n        return a.name.localeCompare(b.name)\n      })\n      break\n    case 'group':\n    default:\n      filtered = [...filtered].sort((a, b) => {\n        const groupA = a.serviceGroup || 'Ungrouped'\n        const groupB = b.serviceGroup || 'Ungrouped'\n        if (groupA !== groupB) {\n          return groupA.localeCompare(groupB)\n        }\n        return a.name.localeCompare(b.name)\n      })\n      break\n  }\n\n  return filtered\n})\n\n// All tools grouped by service group (for checking which groups have matches)\nconst allGroupedTools = computed(() => {\n  const groups = new Map<string, Tool[]>()\n  const allTools = tools.value.filter(tool => tool.key && tool.selectable === true)\n\n  allTools.forEach(tool => {\n    const groupName = tool.serviceGroup || 'Ungrouped'\n    if (!groups.has(groupName)) {\n      groups.set(groupName, [])\n    }\n    groups.get(groupName)!.push(tool)\n  })\n\n  return groups\n})\n\n// Tools grouped by service group (filtered)\nconst groupedTools = computed(() => {\n  const groups = new Map<string, Tool[]>()\n\n  filteredTools.value.forEach(tool => {\n    const groupName = tool.serviceGroup || 'Ungrouped'\n    if (!groups.has(groupName)) {\n      groups.set(groupName, [])\n    }\n    groups.get(groupName)!.push(tool)\n  })\n\n  // Sort the groups\n  return new Map([...groups.entries()].sort())\n})\n\n// Total number of tools\nconst totalTools = computed(() => filteredTools.value.length)\n\n// Watch for changes in the selected state and update the indeterminate state of group checkboxes\nwatch(\n  [selectedTools, groupedTools],\n  () => {\n    nextTick(() => {\n      for (const [groupName, tools] of groupedTools.value) {\n        updateGroupCheckboxState(groupName, tools)\n      }\n    })\n  },\n  { flush: 'post', deep: false }\n)\n\n// Tool selection logic\nconst isToolSelected = (toolKey: string) => {\n  return selectedTools.value.includes(toolKey)\n}\n\nconst toggleToolSelection = (toolKey: string, event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n\n  // Prevent undefined toolKey\n  if (!toolKey) {\n    console.error('toolKey is undefined, cannot proceed')\n    return\n  }\n\n  if (isChecked) {\n    // Add the tool to the selected list\n    if (!selectedTools.value.includes(toolKey)) {\n      selectedTools.value = [...selectedTools.value, toolKey]\n    }\n  } else {\n    // Remove the tool from the selected list\n    selectedTools.value = selectedTools.value.filter(id => id !== toolKey)\n  }\n}\n\n// Group selection logic\nconst getSelectedToolsInGroup = (tools: Tool[]) => {\n  return tools.filter(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupFullySelected = (tools: Tool[]) => {\n  return tools.length > 0 && tools.every(tool => selectedTools.value.includes(tool.key))\n}\n\nconst isGroupPartiallySelected = (tools: Tool[]) => {\n  const selectedCount = getSelectedToolsInGroup(tools).length\n  return selectedCount > 0 && selectedCount < tools.length\n}\n\nconst toggleGroupSelection = (tools: Tool[], event: Event) => {\n  event.stopPropagation()\n  const target = event.target as HTMLInputElement\n  const isChecked = target.checked\n  const toolKeys = tools.map(tool => tool.key)\n\n  if (isChecked) {\n    // Select all tools in the group - Use a new array to avoid reference issues\n    const newSelected = [...selectedTools.value]\n    toolKeys.forEach(key => {\n      if (!newSelected.includes(key)) {\n        newSelected.push(key)\n      }\n    })\n    selectedTools.value = newSelected\n  } else {\n    // Deselect all tools in the group - Create a new array\n    selectedTools.value = selectedTools.value.filter(id => !toolKeys.includes(id))\n  }\n}\n\n// Group collapse logic\nconst toggleGroupCollapse = (groupName: string) => {\n  if (collapsedGroups.value.has(groupName)) {\n    collapsedGroups.value.delete(groupName)\n  } else {\n    collapsedGroups.value.add(groupName)\n  }\n}\n\n// Dialog event handling\nconst handleConfirm = () => {\n  emit('confirm', [...selectedTools.value])\n  emit('update:modelValue', false)\n}\n\nconst handleCancel = () => {\n  // Translate to English and follow frontend terminology\n  selectedTools.value = [...props.selectedToolIds]\n  emit('update:modelValue', false)\n}\n\n// Auto-expand groups that contain matching tools when searching\nwatch(searchQuery, newQuery => {\n  const query = newQuery.trim().toLowerCase()\n\n  if (query) {\n    // Save current collapsed state before search if not already saved\n    if (collapsedGroupsBeforeSearch.value === null) {\n      collapsedGroupsBeforeSearch.value = new Set(collapsedGroups.value)\n    }\n\n    // Expand all groups that contain matching tools (check all original tools, not just filtered)\n    for (const [groupName, tools] of allGroupedTools.value) {\n      const hasMatchingTool = tools.some(\n        tool =>\n          tool.name.toLowerCase().includes(query) ||\n          (tool.description && tool.description.toLowerCase().includes(query)) ||\n          (tool.serviceGroup && tool.serviceGroup.toLowerCase().includes(query))\n      )\n\n      if (hasMatchingTool) {\n        // Expand the group if it contains matching tools\n        collapsedGroups.value.delete(groupName)\n      }\n    }\n  } else {\n    // Restore previous collapsed state when search is cleared\n    if (collapsedGroupsBeforeSearch.value !== null) {\n      collapsedGroups.value = new Set(collapsedGroupsBeforeSearch.value)\n      collapsedGroupsBeforeSearch.value = null\n    }\n  }\n})\n\n// When the modal opens, expand the first group by default and collapse the others\nwatch(visible, newVisible => {\n  if (newVisible) {\n    collapsedGroups.value.clear()\n    collapsedGroupsBeforeSearch.value = null\n    const groupNames = Array.from(groupedTools.value.keys())\n    if (groupNames.length > 1) {\n      // Collapse all groups except the first one by default\n      groupNames.slice(1).forEach(name => {\n        collapsedGroups.value.add(name)\n      })\n    }\n  }\n})\n</script>\n\n<style scoped>\n.tool-selection-content {\n  min-height: 400px;\n  max-height: 600px;\n  overflow-y: auto;\n}\n\n.tool-controls {\n  display: flex;\n  gap: 12px;\n  margin-bottom: 16px;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.search-container {\n  flex: 1;\n}\n\n.search-input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: rgba(102, 126, 234, 0.5);\n  background: rgba(255, 255, 255, 0.1);\n}\n\n.search-input::placeholder {\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.sort-container {\n  min-width: 140px;\n}\n\n.sort-select {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 14px;\n  cursor: pointer;\n}\n\n.tool-summary {\n  margin-bottom: 16px;\n  padding: 8px 0;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.summary-text {\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n}\n\n.tool-group {\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n  margin-bottom: 8px;\n}\n\n.tool-group-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  background: rgba(255, 255, 255, 0.05);\n  cursor: pointer;\n  transition: all 0.3s;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.tool-group-header:hover {\n  background: rgba(255, 255, 255, 0.08);\n}\n\n.tool-group-header.collapsed {\n  border-bottom: none;\n}\n\n.group-title-area {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n}\n\n.collapse-icon {\n  color: rgba(255, 255, 255, 0.6);\n  transition: transform 0.3s;\n}\n\n.group-icon {\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.group-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.group-count {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n}\n\n.group-actions {\n  display: flex;\n  align-items: center;\n}\n\n.group-enable-all {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  cursor: pointer;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 13px;\n}\n\n.group-enable-checkbox {\n  cursor: pointer;\n}\n\n.tool-group-content {\n  max-height: 300px;\n  overflow-y: auto;\n  transition: all 0.3s;\n}\n\n.tool-group-content.collapsed {\n  max-height: 0;\n  overflow: hidden;\n}\n\n.tool-selection-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n  transition: background-color 0.3s;\n}\n\n.tool-selection-item:hover {\n  background: rgba(255, 255, 255, 0.03);\n}\n\n.tool-selection-item:last-child {\n  border-bottom: none;\n}\n\n.tool-info {\n  flex: 1;\n}\n\n.tool-selection-name {\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n  margin-bottom: 4px;\n}\n\n.tool-selection-desc {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 13px;\n  line-height: 1.4;\n}\n\n.tool-actions {\n  margin-left: 12px;\n}\n\n.tool-enable-switch {\n  position: relative;\n  display: inline-block;\n  width: 44px;\n  height: 24px;\n  cursor: pointer;\n}\n\n.tool-enable-checkbox {\n  opacity: 0;\n  width: 0;\n  height: 0;\n}\n\n.tool-enable-slider {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 24px;\n  transition: all 0.3s;\n}\n\n.tool-enable-slider:before {\n  position: absolute;\n  content: '';\n  height: 18px;\n  width: 18px;\n  left: 3px;\n  bottom: 3px;\n  background: white;\n  border-radius: 50%;\n  transition: all 0.3s;\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider {\n  background: rgba(102, 126, 234, 0.8);\n}\n\n.tool-enable-checkbox:checked + .tool-enable-slider:before {\n  transform: translateX(20px);\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 60px 20px;\n  color: rgba(255, 255, 255, 0.5);\n}\n\n.empty-icon {\n  font-size: 48px;\n  margin-bottom: 16px;\n  opacity: 0.6;\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"config-section\">\n    <div class=\"section-header\">\n      <Icon icon=\"carbon:code\" width=\"16\" />\n      <span>{{ $t('sidebar.dynamicAgentPlan') }}</span>\n    </div>\n    <!-- Visual JSON Editor -->\n    <div class=\"visual-editor\">\n      <!-- Plan Basic Info -->\n      <div class=\"plan-basic-info\">\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('sidebar.title') }}</label>\n          <input\n            v-model=\"displayData.title\"\n            type=\"text\"\n            class=\"form-input\"\n            :class=\"{ error: titleError }\"\n            :placeholder=\"$t('sidebar.titlePlaceholder')\"\n            @input=\"handleTitleInput\"\n          />\n          <!-- Inline validation message for title -->\n          <div v-if=\"titleError\" class=\"field-error-message\">\n            <Icon icon=\"carbon:warning\" width=\"12\" />\n            {{ titleError }}\n          </div>\n        </div>\n\n        <!-- Service Group -->\n        <div class=\"form-row\">\n          <label class=\"form-label\">{{ $t('mcpService.serviceGroup') }}</label>\n          <div class=\"service-group-autocomplete\">\n            <input\n              type=\"text\"\n              v-model=\"serviceGroup\"\n              @input=\"handleServiceGroupInputWithEditing\"\n              @focus=\"showGroupSuggestions = true\"\n              @blur=\"handleServiceGroupBlur\"\n              :placeholder=\"$t('mcpService.serviceGroupPlaceholder')\"\n              class=\"form-input\"\n            />\n            <!-- Filtered group suggestions dropdown -->\n            <div\n              v-if=\"showGroupSuggestions && filteredServiceGroups.length > 0\"\n              class=\"service-group-dropdown\"\n            >\n              <div\n                v-for=\"group in filteredServiceGroups\"\n                :key=\"group\"\n                class=\"service-group-option\"\n                @mousedown=\"selectServiceGroup(group)\"\n              >\n                {{ group }}\n              </div>\n            </div>\n          </div>\n          <div class=\"field-description\">{{ $t('mcpService.serviceGroupDescription') }}</div>\n        </div>\n      </div>\n\n      <!-- Steps Editor -->\n      <div class=\"steps-section\">\n        <div class=\"steps-container\">\n          <div v-for=\"(step, index) in displayData.steps\" :key=\"index\" class=\"step-item\">\n            <div class=\"step-content\">\n              <!-- Step Requirement -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.stepRequirement') }}</label>\n                <textarea\n                  :value=\"step.stepRequirement || ''\"\n                  @input=\"e => handleStepRequirementInput(e, index)\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.stepRequirementPlaceholder')\"\n                  rows=\"8\"\n                ></textarea>\n              </div>\n\n              <!-- Terminate Columns -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.terminateColumns') }}</label>\n\n                <textarea\n                  :value=\"step.terminateColumns || ''\"\n                  @input=\"e => handleTerminateColumnsInput(e, index)\"\n                  class=\"form-textarea auto-resize\"\n                  :placeholder=\"$t('sidebar.terminateColumnsPlaceholder')\"\n                  rows=\"1\"\n                ></textarea>\n\n                <!-- Preview Section -->\n                <div\n                  v-if=\"step.terminateColumns && step.terminateColumns.trim()\"\n                  class=\"preview-section\"\n                >\n                  <div class=\"preview-label\">{{ $t('sidebar.preview') }}:</div>\n                  <div class=\"preview-content\">\n                    <div class=\"preview-text\">\n                      {{ $t('sidebar.systemWillReturnListWithTableHeaderFormat') }}:\n                      <span class=\"preview-table-header\">{{\n                        formatTableHeader(step.terminateColumns)\n                      }}</span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <!-- Model Name -->\n              <div class=\"form-row\">\n                <label class=\"form-label\">{{ $t('sidebar.modelName') }}</label>\n                <div class=\"model-selector-wrapper\">\n                  <div\n                    class=\"model-selector\"\n                    :class=\"{\n                      'is-open': isModelDropdownOpenForStep(index),\n                      'is-disabled': isLoadingModels,\n                    }\"\n                  >\n                    <!-- Input field with dropdown arrow -->\n                    <div class=\"model-input-wrapper\">\n                      <input\n                        :value=\"getModelDisplayValue(index)\"\n                        type=\"text\"\n                        class=\"form-input model-search-input\"\n                        :placeholder=\"getModelPlaceholder(index)\"\n                        :disabled=\"isLoadingModels\"\n                        @click.stop=\"openModelDropdown(index)\"\n                        @focus=\"openModelDropdown(index)\"\n                        @input=\"handleModelSearchInput($event, index)\"\n                        @keydown.escape=\"closeModelDropdown(index)\"\n                        @keydown.enter.prevent=\"selectFirstFilteredModel(index)\"\n                        @keydown.down.prevent=\"navigateModelDown(index)\"\n                        @keydown.up.prevent=\"navigateModelUp(index)\"\n                      />\n                      <Icon\n                        icon=\"carbon:chevron-down\"\n                        width=\"14\"\n                        class=\"dropdown-arrow\"\n                        :class=\"{ 'is-open': isModelDropdownOpenForStep(index) }\"\n                        @click.stop=\"toggleModelDropdown(index)\"\n                      />\n                    </div>\n\n                    <!-- Dropdown list -->\n                    <div\n                      v-if=\"isModelDropdownOpenForStep(index)\"\n                      class=\"model-dropdown\"\n                      @click.stop\n                    >\n                      <!-- Loading state -->\n                      <div v-if=\"isLoadingModels\" class=\"dropdown-item disabled\">\n                        {{ $t('sidebar.loading') }}\n                      </div>\n\n                      <!-- Error state -->\n                      <div v-else-if=\"modelsLoadError\" class=\"dropdown-item disabled error\">\n                        {{ $t('sidebar.modelLoadError') }}\n                      </div>\n\n                      <!-- No models found -->\n                      <div\n                        v-else-if=\"getFilteredModelsForStep(index).length === 0\"\n                        class=\"dropdown-item disabled\"\n                      >\n                        {{ $t('sidebar.noModelsFound') }}\n                      </div>\n\n                      <!-- Model options -->\n                      <div\n                        v-for=\"(model, idx) in getFilteredModelsForStep(index)\"\n                        :key=\"model.value\"\n                        class=\"dropdown-item\"\n                        :class=\"{\n                          'is-selected': step.modelName === model.value,\n                          'is-highlighted': getHighlightedIndex(index) === idx,\n                        }\"\n                        @click=\"selectModelForStep(model.value, index)\"\n                        @mouseenter=\"setHighlightedIndex(index, idx)\"\n                      >\n                        {{ model.value }}\n                        <Icon\n                          v-if=\"step.modelName === model.value\"\n                          icon=\"carbon:checkmark\"\n                          width=\"12\"\n                          class=\"check-icon\"\n                        />\n                      </div>\n\n                      <!-- Default empty option -->\n                      <div\n                        class=\"dropdown-item\"\n                        :class=\"{\n                          'is-selected': !step.modelName,\n                          'is-highlighted': getHighlightedIndex(index) === -1,\n                        }\"\n                        @click=\"selectModelForStep('', index)\"\n                        @mouseenter=\"setHighlightedIndex(index, -1)\"\n                      >\n                        {{ $t('sidebar.noModelSelected') }}\n                        <Icon\n                          v-if=\"!step.modelName\"\n                          icon=\"carbon:checkmark\"\n                          width=\"12\"\n                          class=\"check-icon\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Error refresh button -->\n                  <button\n                    v-if=\"modelsLoadError\"\n                    @click=\"loadAvailableModels\"\n                    class=\"btn btn-sm btn-danger\"\n                    :title=\"$t('sidebar.retryLoadModels')\"\n                  >\n                    <Icon icon=\"carbon:warning\" width=\"14\" />\n                    {{ $t('sidebar.retry') }}\n                  </button>\n                </div>\n\n                <!-- Error message -->\n                <div v-if=\"modelsLoadError\" class=\"error-message\">\n                  <Icon icon=\"carbon:warning\" width=\"12\" />\n                  {{ modelsLoadError }}\n                </div>\n              </div>\n\n              <!-- Tool Selection -->\n              <div class=\"form-row\">\n                <AssignedTools\n                  :title=\"$t('sidebar.selectedTools')\"\n                  :selected-tool-ids=\"(step as StepConfigWithTools).selectedToolKeys || []\"\n                  :add-button-text=\"$t('sidebar.addRemoveTools')\"\n                  :empty-text=\"$t('sidebar.noTools')\"\n                  :use-grid-layout=\"true\"\n                  @add-tools=\"showToolSelectionModal(index)\"\n                  @tools-filtered=\"\n                    (filteredTools: string[]) => handleToolsFiltered(index, filteredTools)\n                  \"\n                />\n              </div>\n            </div>\n          </div>\n\n          <!-- Empty State -->\n          <div v-if=\"displayData.steps.length === 0\" class=\"empty-steps\">\n            <Icon icon=\"carbon:add-alt\" width=\"48\" class=\"empty-icon\" />\n            <p class=\"empty-text\">{{ $t('sidebar.noSteps') }}</p>\n            <button class=\"btn btn-primary btn-add-step\" @click=\"handleAddStep\">\n              <Icon icon=\"carbon:add\" width=\"16\" />\n              {{ $t('sidebar.addFirstStep') }}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <!-- JSON Preview (Optional) -->\n      <div class=\"json-preview\" v-if=\"showJsonPreview\">\n        <div class=\"preview-header\">\n          <label class=\"form-label\">{{ $t('sidebar.jsonPreview') }}</label>\n          <button @click=\"closeJsonPreview\" class=\"btn btn-xs\">\n            <Icon icon=\"carbon:close\" width=\"12\" />\n          </button>\n        </div>\n        <pre class=\"json-code\">{{ generatedJsonOutput }}</pre>\n      </div>\n\n      <!-- Toggle JSON Preview -->\n      <div class=\"editor-footer\">\n        <button @click=\"toggleJsonPreview\" class=\"btn btn-sm btn-secondary\">\n          <Icon icon=\"carbon:code\" width=\"14\" />\n          {{ showJsonPreview ? $t('sidebar.hideJson') : $t('sidebar.showJson') }}\n        </button>\n        <div class=\"section-actions\">\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleCopyPlan\"\n            :disabled=\"isGenerating || isExecuting\"\n            :title=\"$t('sidebar.copyPlan')\"\n          >\n            <Icon icon=\"carbon:copy\" width=\"14\" />\n            {{ $t('sidebar.copyPlan') }}\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRollback\"\n            :disabled=\"!templateConfig.canRollback.value\"\n            :title=\"$t('sidebar.rollback')\"\n          >\n            <Icon icon=\"carbon:undo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-sm\"\n            @click=\"handleRestore\"\n            :disabled=\"!templateConfig.canRestore.value\"\n            :title=\"$t('sidebar.restore')\"\n          >\n            <Icon icon=\"carbon:redo\" width=\"14\" />\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"handleSave\"\n            :disabled=\"isGenerating || isExecuting\"\n          >\n            <Icon icon=\"carbon:save\" width=\"14\" />\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Tool Selection Modal -->\n    <ToolSelectionModal\n      v-model=\"showToolModal\"\n      :selected-tool-ids=\"\n        currentStepIndex >= 0\n          ? (displayData.steps[currentStepIndex] as StepConfigWithTools)?.selectedToolKeys || []\n          : []\n      \"\n      @confirm=\"handleToolSelectionConfirm\"\n    />\n\n    <!-- Copy Plan Modal -->\n    <div v-if=\"showCopyPlanModal\" class=\"modal-overlay\" @mousedown=\"handleModalOverlayClick\">\n      <div class=\"modal-content\" @mousedown.stop>\n        <div class=\"modal-header\">\n          <h3>{{ $t('sidebar.copyPlan') }}</h3>\n          <button class=\"close-btn\" @click=\"closeCopyPlanModal\">\n            <Icon icon=\"carbon:close\" width=\"16\" />\n          </button>\n        </div>\n        <div class=\"modal-body\">\n          <div class=\"form-row\">\n            <label class=\"form-label\">{{ $t('sidebar.newPlanTitle') }}</label>\n            <input\n              v-model=\"newPlanTitle\"\n              type=\"text\"\n              class=\"form-input\"\n              :placeholder=\"$t('sidebar.enterNewPlanTitle')\"\n              @keyup.enter=\"confirmCopyPlan\"\n            />\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button class=\"btn btn-secondary\" @click=\"closeCopyPlanModal\">\n            {{ $t('common.cancel') }}\n          </button>\n          <button\n            class=\"btn btn-primary\"\n            @click=\"confirmCopyPlan\"\n            :disabled=\"!newPlanTitle.trim() || isCopyingPlan\"\n          >\n            <Icon v-if=\"isCopyingPlan\" icon=\"carbon:loading\" width=\"16\" class=\"spinning\" />\n            {{ isCopyingPlan ? $t('sidebar.copying') : $t('sidebar.copyPlan') }}\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport { ConfigApiService, type ModelOption } from '@/api/config-api-service'\nimport { PlanTemplateApiService } from '@/api/plan-template-with-tool-api-service'\nimport { ToolApiService } from '@/api/tool-api-service'\nimport AssignedTools from '@/components/shared/AssignedTools.vue'\nimport ToolSelectionModal from '@/components/tool-selection-modal/ToolSelectionModal.vue'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { useToast } from '@/plugins/useToast'\nimport { templateStore } from '@/stores/templateStore'\nimport type { PlanTemplateConfigVO, StepConfig } from '@/types/plan-template'\nimport { Icon } from '@iconify/vue'\nimport { computed, onMounted, onUnmounted, reactive, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\n// Extended StepConfig with selectedToolKeys for UI state\ninterface StepConfigWithTools extends StepConfig {\n  selectedToolKeys?: string[]\n}\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Define props interface specific to JsonEditorV2\ninterface JsonEditorV2Props {\n  isGenerating?: boolean\n  isExecuting?: boolean\n}\n\n// Props\nconst { isGenerating = false, isExecuting = false } = defineProps<JsonEditorV2Props>()\n\n// Get template config singleton\nconst templateConfig = usePlanTemplateConfigSingleton()\n\n// Display data - sync with templateConfig\nconst displayData = reactive<{\n  title: string\n  steps: StepConfigWithTools[]\n}>({\n  title: '',\n  steps: [],\n})\n\n// JSON preview state\nconst showJsonPreview = ref(false)\n\n// Service group autocomplete state\nconst showGroupSuggestions = ref(false)\nconst availableServiceGroups = ref<string[]>([])\nconst isLoadingGroups = ref(false)\nconst serviceGroup = ref('')\n\n// Dynamically generate JSON output from templateConfig (not cached, regenerated each time)\nconst generatedJsonOutput = computed(() => {\n  return templateConfig.generateJsonString()\n})\n\n// Flag to track if we're syncing from config (to avoid setting modification flag during load)\nconst isSyncingFromConfig = ref(false)\n\n// Timeout for resetting editing flag (debounce)\nlet editingTimeout: ReturnType<typeof setTimeout> | null = null\n\n// Helper to set editing flag with debounce (uses templateConfig.isUserUpdating)\nconst setEditingFlag = () => {\n  templateConfig.isUserUpdating.value = true\n  if (editingTimeout) {\n    clearTimeout(editingTimeout)\n  }\n  editingTimeout = setTimeout(() => {\n    templateConfig.isUserUpdating.value = false\n    editingTimeout = null\n  }, 500)\n}\n\n// Sync displayData with templateConfig\nconst syncDisplayDataFromConfig = () => {\n  // Don't sync if user is actively editing to prevent losing unsaved changes\n  if (templateConfig.isUserUpdating.value) {\n    console.log('[JsonEditorV2] syncDisplayDataFromConfig skipped: isUserUpdating is true')\n    return\n  }\n\n  console.log('[JsonEditorV2] syncDisplayDataFromConfig called')\n  isSyncingFromConfig.value = true\n  try {\n    const config = templateConfig.getConfig()\n    console.log('[JsonEditorV2] Syncing displayData with config:', {\n      title: config.title,\n      stepsCount: config.steps?.length || 0,\n      serviceGroup: config.serviceGroup,\n    })\n    // Only update title if:\n    // 1. config.title has a value (not empty), OR\n    // 2. displayData.title is empty (user hasn't started typing)\n    // This prevents resetting the title input when user is typing\n    if (config.title?.trim() || !displayData.title?.trim()) {\n      displayData.title = config.title || ''\n    }\n    // Deep copy steps to avoid reference issues\n    displayData.steps = (config.steps || []).map(step => ({ ...step }))\n    // Sync service group\n    serviceGroup.value = config.serviceGroup || ''\n    console.log('[JsonEditorV2] displayData synced:', {\n      title: displayData.title,\n      stepsCount: displayData.steps.length,\n      serviceGroup: serviceGroup.value,\n    })\n  } finally {\n    // Use nextTick to ensure the watch doesn't trigger during sync\n    setTimeout(() => {\n      isSyncingFromConfig.value = false\n    }, 0)\n  }\n}\n\n// Sync displayData changes back to templateConfig\n// DISABLED: Only sync on save to prevent flickering during input\n// watch(\n//   () => displayData,\n//   () => {\n//     // Skip if we're syncing from config (initial load)\n//     if (isSyncingFromConfig.value) {\n//       return\n//     }\n\n//     // Update templateConfig when displayData changes\n//     templateConfig.setTitle(displayData.title)\n//     templateConfig.setSteps(displayData.steps)\n\n//     // Mark task requirements as modified if there's a selected template\n//     // Note: This is a fallback - the @input handlers should handle most cases\n//     if (templateConfig.currentPlanTemplateId.value) {\n//       templateStore.hasTaskRequirementModified = true\n//       console.log(\n//         '[JsonEditorV2] Task requirements modified (via watch), hasTaskRequirementModified set to true'\n//       )\n//     }\n//   },\n//   { deep: true }\n// )\n\n// Manual sync function to be called on save\nconst syncDisplayDataToTemplateConfig = () => {\n  // Set flag to prevent watcher from syncing back during this update\n  isSyncingFromConfig.value = true\n  try {\n    templateConfig.setTitle(displayData.title)\n    templateConfig.setSteps(displayData.steps)\n    if (templateConfig.currentPlanTemplateId.value) {\n      templateStore.hasTaskRequirementModified = true\n    }\n  } finally {\n    setTimeout(() => {\n      isSyncingFromConfig.value = false\n    }, 0)\n  }\n}\n\n// JSON preview functions\nconst toggleJsonPreview = () => {\n  showJsonPreview.value = !showJsonPreview.value\n}\n\nconst closeJsonPreview = () => {\n  showJsonPreview.value = false\n}\n\n// Action handlers (moved from json-editor-logic.ts to usePlanTemplateConfig)\nconst handleRollback = () => {\n  try {\n    // Clear editing flag and timeout to allow sync\n    if (editingTimeout) {\n      clearTimeout(editingTimeout)\n      editingTimeout = null\n    }\n    templateConfig.isUserUpdating.value = false\n    templateConfig.rollbackVersion()\n  } catch (error) {\n    console.error('Error during rollback operation:', error)\n    toast.error(t('sidebar.rollbackFailed') || 'Rollback failed')\n  }\n}\n\nconst handleRestore = () => {\n  try {\n    // Clear editing flag and timeout to allow sync\n    if (editingTimeout) {\n      clearTimeout(editingTimeout)\n      editingTimeout = null\n    }\n    templateConfig.isUserUpdating.value = false\n    templateConfig.restoreVersion()\n  } catch (error) {\n    console.error('Error during restore operation:', error)\n    toast.error(t('sidebar.restoreFailed') || 'Restore failed')\n  }\n}\n\nconst handleSave = async () => {\n  try {\n    if (!templateConfig.selectedTemplate.value) {\n      toast.error(t('sidebar.selectPlanFirst'))\n      return\n    }\n\n    // Clear editing flag and timeout before saving to ensure proper sync\n    if (editingTimeout) {\n      clearTimeout(editingTimeout)\n      editingTimeout = null\n    }\n    templateConfig.isUserUpdating.value = false\n\n    // Sync displayData to templateConfig before validation and save\n    // This ensures all user input is synchronized before saving\n    syncDisplayDataToTemplateConfig()\n\n    // Validate config\n    const validation = templateConfig.validate()\n    if (!validation.isValid) {\n      toast.error(\n        'Invalid format, please correct and save.\\nErrors: ' + validation.errors.join(', ')\n      )\n      return\n    }\n\n    const planTemplateId = templateConfig.selectedTemplate.value.planTemplateId\n    if (!planTemplateId) {\n      toast.error('Plan template ID is required')\n      return\n    }\n\n    // Save using templateConfig (this already calls PlanTemplateApiService.createOrUpdatePlanTemplateWithTool)\n    // The save() method already calls load() which reloads versions from backend\n    const success = await templateConfig.save()\n    if (!success) {\n      toast.error('Failed to save plan template')\n      return\n    }\n\n    // Update versions after save (adds current content to local version history)\n    const content = templateConfig.generateJsonString().trim()\n    templateConfig.updateVersionsAfterSave(content)\n\n    // Get actual version count after update (save() already reloaded versions from backend, then updateVersionsAfterSave adds one more)\n    const versionCount = templateConfig.planVersions.value.length\n\n    // Reset modification flag after successful save\n    templateStore.hasTaskRequirementModified = false\n\n    // Refresh sidebar template list to reflect the saved changes\n    await templateStore.loadPlanTemplateList()\n\n    toast.success(t('sidebar.saveSuccess', { message: 'Plan saved successfully', versionCount }))\n  } catch (error: unknown) {\n    console.error('Failed to save plan modifications:', error)\n    const message = error instanceof Error ? error.message : t('sidebar.saveFailed')\n    toast.error(message)\n    throw error // Re-throw to allow caller to handle\n  }\n}\n\n// Error state\nconst titleError = ref<string>('')\n\n// Handle step requirement input\nconst handleStepRequirementInput = (e: Event, stepIndex: number) => {\n  setEditingFlag()\n  const step = displayData.steps[stepIndex]\n  if (step) {\n    step.stepRequirement = (e.target as HTMLTextAreaElement).value\n  }\n  autoResizeTextarea(e)\n  // Only update displayData, don't sync to templateConfig or trigger any watchers\n  // Sync will happen on save via syncDisplayDataToTemplateConfig()\n}\n\n// Handle terminate columns input\nconst handleTerminateColumnsInput = (e: Event, stepIndex: number) => {\n  setEditingFlag()\n  const step = displayData.steps[stepIndex]\n  if (step) {\n    step.terminateColumns = (e.target as HTMLTextAreaElement).value\n  }\n  autoResizeTextarea(e)\n  // Only update displayData, don't sync to templateConfig or trigger any watchers\n  // Sync will happen on save via syncDisplayDataToTemplateConfig()\n}\n\n// Add step handler\nconst handleAddStep = () => {\n  const newStep: StepConfigWithTools = {\n    stepRequirement: '',\n    agentName: '',\n    modelName: '',\n    terminateColumns: '',\n    selectedToolKeys: [],\n  }\n  displayData.steps.push(newStep)\n  // Sync to templateConfig - no guard needed since setSteps() doesn't trigger watcher (needsFullRefresh is false)\n  templateConfig.setSteps(displayData.steps)\n  console.log('[JsonEditorV2] Added new step, total steps:', displayData.steps.length)\n}\n\n// Model selection state\nconst availableModels = ref<ModelOption[]>([])\nconst isLoadingModels = ref(false)\nconst modelsLoadError = ref<string>('')\n\n// Per-step state for dropdown (stepIndex -> state)\nconst modelSearchFilters = ref<Map<number, string>>(new Map())\nconst openDropdownSteps = ref<Set<number>>(new Set())\nconst highlightedIndices = ref<Map<number, number>>(new Map())\n\n// Get search filter for a specific step\nconst getSearchFilter = (stepIndex: number): string => {\n  return modelSearchFilters.value.get(stepIndex) ?? ''\n}\n\n// Set search filter for a specific step\nconst setSearchFilter = (stepIndex: number, value: string) => {\n  modelSearchFilters.value.set(stepIndex, value)\n}\n\n// Filtered models based on search for a specific step\nconst getFilteredModelsForStep = (stepIndex: number) => {\n  const filter = getSearchFilter(stepIndex)\n  if (!filter.trim()) {\n    return availableModels.value\n  }\n  const searchTerm = filter.toLowerCase().trim()\n  return availableModels.value.filter(\n    model =>\n      model.value.toLowerCase().includes(searchTerm) ||\n      model.label.toLowerCase().includes(searchTerm)\n  )\n}\n\n// Get display value for a specific step\nconst getModelDisplayValue = (stepIndex: number): string => {\n  const step = displayData.steps[stepIndex]\n  const filter = getSearchFilter(stepIndex)\n  if (openDropdownSteps.value.has(stepIndex) && filter !== '') {\n    return filter\n  }\n  return step.modelName ?? ''\n}\n\n// Get placeholder text based on selected model\nconst getModelPlaceholder = (stepIndex: number) => {\n  if (isLoadingModels.value) {\n    return ''\n  }\n  if (modelsLoadError.value) {\n    return ''\n  }\n  const step = displayData.steps[stepIndex]\n  if (step.modelName) {\n    return ''\n  }\n  return (t('sidebar.modelNameDescription') as string) || ''\n}\n\n// Check if dropdown is open for a specific step\nconst isModelDropdownOpenForStep = (stepIndex: number): boolean => {\n  return openDropdownSteps.value.has(stepIndex)\n}\n\n// Model dropdown functions\nconst openModelDropdown = (stepIndex: number) => {\n  if (!isLoadingModels.value) {\n    openDropdownSteps.value.add(stepIndex)\n  }\n}\n\nconst closeModelDropdown = (stepIndex: number) => {\n  openDropdownSteps.value.delete(stepIndex)\n  highlightedIndices.value.set(stepIndex, -1)\n  // Reset search filter to selected model name\n  const step = displayData.steps[stepIndex]\n  setSearchFilter(stepIndex, step.modelName ?? '')\n}\n\nconst toggleModelDropdown = (stepIndex: number) => {\n  if (isModelDropdownOpenForStep(stepIndex)) {\n    closeModelDropdown(stepIndex)\n  } else {\n    openModelDropdown(stepIndex)\n  }\n}\n\nconst selectModelForStep = (modelName: string, stepIndex: number) => {\n  setEditingFlag()\n  const step = displayData.steps[stepIndex]\n  step.modelName = modelName\n  setSearchFilter(stepIndex, modelName)\n  closeModelDropdown(stepIndex)\n}\n\n// Handle search input\nconst handleModelSearchInput = (event: Event, stepIndex: number) => {\n  setEditingFlag()\n  const target = event.target as HTMLInputElement\n  setSearchFilter(stepIndex, target.value)\n  openModelDropdown(stepIndex)\n}\n\n// Get highlighted index for a step\nconst getHighlightedIndex = (stepIndex: number): number => {\n  return highlightedIndices.value.get(stepIndex) ?? -1\n}\n\n// Set highlighted index for a step\nconst setHighlightedIndex = (stepIndex: number, index: number) => {\n  highlightedIndices.value.set(stepIndex, index)\n}\n\n// Keyboard navigation\nconst selectFirstFilteredModel = (stepIndex: number) => {\n  const highlightedIndex = getHighlightedIndex(stepIndex)\n  const filtered = getFilteredModelsForStep(stepIndex)\n\n  // If a specific item is highlighted, select it\n  if (highlightedIndex >= 0 && highlightedIndex < filtered.length) {\n    selectModelForStep(filtered[highlightedIndex].value, stepIndex)\n  } else if (highlightedIndex === -1) {\n    // Select empty option\n    selectModelForStep('', stepIndex)\n  } else if (filtered.length > 0) {\n    // Fallback to first item\n    selectModelForStep(filtered[0].value, stepIndex)\n  } else {\n    const step = displayData.steps[stepIndex]\n    if (!step.modelName) {\n      selectModelForStep('', stepIndex)\n    }\n  }\n}\n\nconst navigateModelDown = (stepIndex: number) => {\n  if (!isModelDropdownOpenForStep(stepIndex)) {\n    openModelDropdown(stepIndex)\n    setHighlightedIndex(stepIndex, 0)\n    return\n  }\n  const filtered = getFilteredModelsForStep(stepIndex)\n  const totalItems = filtered.length + 1 // +1 for \"no model selected\" option\n  const currentIndex = getHighlightedIndex(stepIndex)\n  const newIndex = Math.min(currentIndex + 1, totalItems - 1)\n  setHighlightedIndex(stepIndex, newIndex)\n}\n\nconst navigateModelUp = (stepIndex: number) => {\n  if (!isModelDropdownOpenForStep(stepIndex)) {\n    openModelDropdown(stepIndex)\n    const filtered = getFilteredModelsForStep(stepIndex)\n    setHighlightedIndex(stepIndex, filtered.length)\n    return\n  }\n  const currentIndex = getHighlightedIndex(stepIndex)\n  const newIndex = Math.max(currentIndex - 1, -1)\n  setHighlightedIndex(stepIndex, newIndex)\n}\n\n// Click outside to close dropdown\nconst handleClickOutside = (event: MouseEvent) => {\n  const target = event.target as HTMLElement\n  // Check if click is inside any model selector\n  const modelSelector = target.closest('.model-selector')\n  if (!modelSelector) {\n    // Close all open dropdowns\n    openDropdownSteps.value.clear()\n  }\n}\n\n// Initialize search filters when steps change\nwatch(\n  () => displayData.steps,\n  newSteps => {\n    newSteps.forEach((step, index) => {\n      if (!modelSearchFilters.value.has(index)) {\n        setSearchFilter(index, step.modelName ?? '')\n      }\n    })\n  },\n  { deep: true, immediate: true }\n)\n\n// Tool selection state\nconst showToolModal = ref(false)\nconst currentStepIndex = ref<number>(-1)\n\n// Load available models\nconst loadAvailableModels = async () => {\n  if (isLoadingModels.value) return\n\n  isLoadingModels.value = true\n  modelsLoadError.value = ''\n\n  try {\n    const response = await ConfigApiService.getAvailableModels()\n    availableModels.value = response.options\n  } catch (error) {\n    console.error('Failed to load models:', error)\n    modelsLoadError.value = error instanceof Error ? error.message : 'Failed to load models'\n    availableModels.value = []\n  } finally {\n    isLoadingModels.value = false\n  }\n}\n\n// Tool selection functions\nconst showToolSelectionModal = (stepIndex: number) => {\n  currentStepIndex.value = stepIndex\n  showToolModal.value = true\n}\n\nconst handleToolSelectionConfirm = (selectedToolIds: string[]) => {\n  setEditingFlag()\n  if (currentStepIndex.value >= 0 && currentStepIndex.value < displayData.steps.length) {\n    // Update the specific step's selected tool keys\n    displayData.steps[currentStepIndex.value].selectedToolKeys = [...selectedToolIds]\n  }\n  showToolModal.value = false\n  currentStepIndex.value = -1\n}\n\nconst handleToolsFiltered = (stepIndex: number, filteredTools: string[]) => {\n  setEditingFlag()\n  if (stepIndex >= 0 && stepIndex < displayData.steps.length) {\n    // Update the step's selected tool keys with filtered tools\n    displayData.steps[stepIndex].selectedToolKeys = [...filteredTools]\n  }\n}\n\n// Copy plan state\nconst showCopyPlanModal = ref(false)\nconst newPlanTitle = ref('')\nconst isCopyingPlan = ref(false)\n\n// Copy plan function\nconst handleCopyPlan = () => {\n  console.log('[JsonEditorV2] Copy plan clicked')\n\n  if (!templateConfig.selectedTemplate.value) {\n    console.log('[JsonEditorV2] No template selected, cannot copy')\n    toast.error(t('sidebar.selectPlanFirst'))\n    return\n  }\n\n  newPlanTitle.value =\n    (templateConfig.selectedTemplate.value.title ?? t('sidebar.unnamedPlan')) + ' (copy)'\n  console.log('[JsonEditorV2] Opening copy plan modal')\n  showCopyPlanModal.value = true\n}\n\nconst closeCopyPlanModal = () => {\n  showCopyPlanModal.value = false\n  newPlanTitle.value = ''\n  isCopyingPlan.value = false\n}\n\n// Handle modal overlay click - only close if clicking directly on overlay\nconst handleModalOverlayClick = (event: MouseEvent) => {\n  // Only close if the click target is the overlay itself, not its children\n  if (event.target === event.currentTarget) {\n    closeCopyPlanModal()\n  }\n}\n\nconst confirmCopyPlan = async () => {\n  if (!newPlanTitle.value.trim()) {\n    toast.error(t('sidebar.titleRequired'))\n    return\n  }\n\n  if (!templateConfig.selectedTemplate.value) {\n    toast.error(t('sidebar.noPlanToCopy'))\n    return\n  }\n\n  isCopyingPlan.value = true\n\n  try {\n    // Get the current plan config\n    const currentConfig = templateConfig.getConfig()\n\n    // Generate a new planTemplateId in the format: planTemplate-{timestamp}\n    const newPlanTemplateId = `planTemplate-${Date.now()}`\n\n    // Exclude toolConfig from the copy to avoid copying service configuration\n    const { toolConfig: _toolConfig, ...configWithoutToolConfig } = currentConfig\n\n    // Create a new plan config with all fields copied, only changing the title and using new ID\n    const newPlanConfig: PlanTemplateConfigVO = {\n      ...configWithoutToolConfig,\n      title: newPlanTitle.value.trim(),\n      planTemplateId: newPlanTemplateId,\n    }\n\n    console.log('[JsonEditorV2] Copying plan without toolConfig:', newPlanConfig)\n\n    const result = await PlanTemplateApiService.createOrUpdatePlanTemplateWithTool(newPlanConfig)\n\n    if (result.success) {\n      toast.success(t('sidebar.copyPlanSuccess', { title: newPlanTitle.value.trim() }))\n      await templateStore.loadPlanTemplateList()\n      closeCopyPlanModal()\n    } else {\n      toast.error(t('sidebar.copyPlanFailed', { message: 'Failed to copy plan' }))\n    }\n  } catch (error: unknown) {\n    console.error('[JsonEditorV2] Error copying plan:', error)\n    // Check if it's a duplicate title error\n    if (\n      error instanceof Error &&\n      (error as Error & { errorCode?: string }).errorCode === 'DUPLICATE_TITLE'\n    ) {\n      toast.error(t('sidebar.duplicatePlanTitle'))\n    } else {\n      const message = error instanceof Error ? error.message : 'Unknown error'\n      toast.error(t('sidebar.copyPlanFailed', { message: message }))\n    }\n  } finally {\n    isCopyingPlan.value = false\n  }\n}\n\n// Watch for displayData changes to validate structure\nwatch(\n  () => displayData.title,\n  newTitle => {\n    // Soft validation for title - show warning but don't block the form\n    if (!newTitle?.trim()) {\n      titleError.value = 'Title is required field'\n    } else {\n      titleError.value = ''\n    }\n  },\n  { immediate: true }\n)\n\n// Load service group from template config\nconst loadServiceGroup = () => {\n  const group = templateConfig.getServiceGroup() || ''\n  serviceGroup.value = group\n}\n\n// Watch for templateConfig changes and sync to displayData\nwatch(\n  () => templateConfig.config,\n  () => {\n    // Only sync when a full refresh is needed (load, setConfig, fromJsonString, reset, version control)\n    // Skip sync for partial updates (setTitle, setSteps, etc.) to avoid unnecessary refreshes\n    // Don't sync if we're already syncing (prevents circular updates)\n    // Don't sync if user is actively editing or programmatic updates are in progress\n    if (\n      templateConfig.needsFullRefresh.value &&\n      !isSyncingFromConfig.value &&\n      !templateConfig.isUserUpdating.value\n    ) {\n      syncDisplayDataFromConfig()\n    }\n  },\n  { deep: true, immediate: true }\n)\n\n// Watch for templateConfig changes (when template is loaded)\nwatch(\n  () => templateConfig.currentPlanTemplateId.value,\n  (newId, oldId) => {\n    console.log('[JsonEditorV2] currentPlanTemplateId changed:', { oldId, newId })\n    // Only reset if template actually changed (not initial load)\n    if (oldId !== null && oldId !== undefined && newId !== oldId) {\n      // Reset UI states when template changes\n      modelSearchFilters.value.clear()\n      openDropdownSteps.value.clear()\n      highlightedIndices.value.clear()\n      showToolModal.value = false\n      showCopyPlanModal.value = false\n      showJsonPreview.value = false\n      currentStepIndex.value = -1\n      newPlanTitle.value = ''\n      isCopyingPlan.value = false\n    }\n    // Sync displayData when template changes (including when reloading same template)\n    // This watch will trigger even when oldId === newId if we temporarily set to null\n    console.log('[JsonEditorV2] Calling syncDisplayDataFromConfig from currentPlanTemplateId watch')\n    syncDisplayDataFromConfig()\n    // Load service group when template changes\n    loadServiceGroup()\n  },\n  { immediate: true }\n)\n\n// Watch service group changes and sync to template config\nwatch(\n  () => serviceGroup.value,\n  newGroup => {\n    // Set a flag to prevent syncDisplayDataFromConfig from running\n    isSyncingFromConfig.value = true\n    try {\n      templateConfig.setServiceGroup(newGroup)\n    } finally {\n      // Reset the flag after a microtask to prevent the templateConfig watcher from syncing back\n      setTimeout(() => {\n        isSyncingFromConfig.value = false\n      }, 0)\n    }\n  }\n)\n\n// Load available service groups\nconst loadAvailableServiceGroups = async () => {\n  if (isLoadingGroups.value) {\n    return\n  }\n\n  isLoadingGroups.value = true\n  try {\n    const groupsSet = new Set<string>()\n\n    // Load service groups from tools\n    try {\n      const tools = await ToolApiService.getAvailableTools()\n      tools.forEach(tool => {\n        if (tool.serviceGroup) {\n          groupsSet.add(tool.serviceGroup)\n        }\n      })\n    } catch (error) {\n      console.error('[JsonEditorV2] Failed to load service groups from tools:', error)\n    }\n\n    // Load service groups from plan templates\n    try {\n      const planTemplates = await PlanTemplateApiService.getAllPlanTemplateConfigVOs()\n      planTemplates.forEach(template => {\n        if (template.serviceGroup) {\n          groupsSet.add(template.serviceGroup)\n        }\n      })\n    } catch (error) {\n      console.error('[JsonEditorV2] Failed to load service groups from plan templates:', error)\n    }\n\n    availableServiceGroups.value = Array.from(groupsSet).sort()\n  } catch (error) {\n    console.error('[JsonEditorV2] Failed to load service groups:', error)\n    availableServiceGroups.value = []\n  } finally {\n    isLoadingGroups.value = false\n  }\n}\n\n// Filtered service groups\nconst filteredServiceGroups = computed(() => {\n  const trimmedGroup = serviceGroup.value.trim()\n  if (!trimmedGroup) {\n    return availableServiceGroups.value\n  }\n\n  const query = trimmedGroup.toLowerCase()\n  return availableServiceGroups.value.filter(group => group.toLowerCase().includes(query))\n})\n\n// Handle title input\nconst handleTitleInput = () => {\n  setEditingFlag()\n}\n\n// Handle service group input\nconst handleServiceGroupInput = () => {\n  showGroupSuggestions.value = true\n}\n\n// Handle service group input with editing flag\nconst handleServiceGroupInputWithEditing = () => {\n  setEditingFlag()\n  handleServiceGroupInput()\n}\n\n// Handle service group blur\nconst handleServiceGroupBlur = () => {\n  setTimeout(() => {\n    showGroupSuggestions.value = false\n  }, 200)\n}\n\n// Select a service group from dropdown\nconst selectServiceGroup = (group: string) => {\n  serviceGroup.value = group\n  showGroupSuggestions.value = false\n}\n\n// Initialize on mount\nonMounted(() => {\n  // Sync displayData from templateConfig\n  syncDisplayDataFromConfig()\n\n  // Load service group\n  loadServiceGroup()\n\n  // Load available service groups\n  loadAvailableServiceGroups()\n\n  loadAvailableModels()\n\n  // Add click outside listener\n  document.addEventListener('click', handleClickOutside)\n})\n\nonUnmounted(() => {\n  // Remove click outside listener\n  document.removeEventListener('click', handleClickOutside)\n\n  // Clean up editing timeout\n  if (editingTimeout) {\n    clearTimeout(editingTimeout)\n    editingTimeout = null\n  }\n})\n\n// Expose save method for parent component to call\ndefineExpose({\n  save: handleSave,\n})\n\nconst autoResizeTextarea = (event: Event) => {\n  const textarea = event.target as HTMLTextAreaElement\n\n  textarea.style.height = 'auto'\n\n  const lineHeight = 20\n  const lines = Math.ceil(textarea.scrollHeight / lineHeight)\n\n  const minRows = 4\n  const maxRows = 12\n  const targetRows = Math.max(minRows, Math.min(maxRows, lines))\n\n  const newHeight = targetRows * lineHeight\n  textarea.style.height = `${newHeight}px`\n  textarea.rows = targetRows\n\n  if (lines > maxRows) {\n    textarea.style.overflowY = 'auto'\n  } else {\n    textarea.style.overflowY = 'hidden'\n  }\n}\n\n// Format table header preview\nconst formatTableHeader = (terminateColumns: string): string => {\n  if (!terminateColumns.trim()) {\n    return ''\n  }\n\n  // Split by comma and clean up each column name\n  const columns = terminateColumns\n    .split(',')\n    .map(col => col.trim())\n    .filter(col => col.length > 0)\n\n  if (columns.length === 0) {\n    return ''\n  }\n\n  // Format as |col1|col2|col3|\n  return `|${columns.join('|')}|`\n}\n</script>\n\n<style scoped>\n.config-section {\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n  color: #667eea;\n  font-size: 13px;\n  font-weight: 600;\n  gap: 8px;\n}\n\n.section-actions {\n  margin-left: auto;\n  display: flex;\n  gap: 6px;\n}\n\n/* Error Section Styles */\n.error-section {\n  margin-bottom: 16px;\n  background: rgba(239, 68, 68, 0.1);\n  border: 1px solid rgba(239, 68, 68, 0.3);\n  border-radius: 8px;\n  padding: 16px;\n}\n\n.error-message {\n  display: flex;\n  align-items: flex-start;\n  gap: 12px;\n  color: #ef4444;\n}\n\n.error-content {\n  flex: 1;\n}\n\n.error-title {\n  font-weight: 600;\n  font-size: 14px;\n  margin-bottom: 4px;\n}\n\n.error-description {\n  font-size: 12px;\n  color: rgba(239, 68, 68, 0.8);\n  line-height: 1.4;\n}\n\n/* Visual Editor Styles */\n.visual-editor {\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 8px;\n  padding: 16px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.plan-basic-info {\n  margin-bottom: 20px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  margin-bottom: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n}\n\n.form-label {\n  font-size: 10px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.field-description {\n  font-size: 9px;\n  color: rgba(255, 255, 255, 0.5);\n  line-height: 1.4;\n  margin-top: 2px;\n}\n\n.form-input,\n.form-textarea {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus,\n.form-textarea:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n/* Error state for form inputs */\n.form-input.error,\n.form-textarea.error {\n  border-color: #ef4444;\n  box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);\n}\n\n/* Field error message */\n.field-error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.readonly-input {\n  background: rgba(255, 255, 255, 0.02);\n  border: 1px solid rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.6);\n  cursor: not-allowed;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 12px;\n}\n\n.readonly-input:focus {\n  border-color: rgba(255, 255, 255, 0.05);\n  box-shadow: none;\n}\n\n.form-textarea {\n  resize: vertical;\n  min-height: 20px;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  line-height: 1.4;\n}\n\n.form-textarea.auto-resize {\n  resize: none;\n  transition: height 0.2s ease;\n  overflow-y: auto;\n  max-height: 240px;\n}\n\n/* Model Selector Styles */\n.model-selector-wrapper {\n  display: flex;\n  gap: 8px;\n  align-items: flex-start;\n}\n\n.model-selector {\n  position: relative;\n  flex: 1;\n}\n\n.model-input-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n}\n\n.model-search-input {\n  flex: 1;\n  padding-right: 32px;\n}\n\n.dropdown-arrow {\n  position: absolute;\n  right: 12px;\n  color: rgba(255, 255, 255, 0.5);\n  pointer-events: none;\n  transition: transform 0.2s ease;\n}\n\n.dropdown-arrow.is-open {\n  transform: rotate(180deg);\n}\n\n.model-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 4px;\n  background: rgba(0, 0, 0, 0.95);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  max-height: 200px;\n  overflow-y: auto;\n  z-index: 1000;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.dropdown-item {\n  padding: 8px 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.dropdown-item:last-child {\n  border-bottom: none;\n}\n\n.dropdown-item:hover,\n.dropdown-item.is-highlighted {\n  background: rgba(102, 126, 234, 0.2);\n  color: white;\n}\n\n.dropdown-item.is-selected {\n  background: rgba(102, 126, 234, 0.15);\n  color: #667eea;\n  font-weight: 500;\n}\n\n.dropdown-item.disabled {\n  color: rgba(255, 255, 255, 0.5);\n  cursor: not-allowed;\n  font-style: italic;\n}\n\n.dropdown-item.disabled.error {\n  color: #ef4444;\n}\n\n.check-icon {\n  color: #667eea;\n  margin-left: 8px;\n}\n\n.model-selector.is-disabled .model-search-input {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Steps Section */\n.steps-section {\n  margin-bottom: 20px;\n}\n\n.error-message {\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-size: 10px;\n  color: #ef4444;\n  margin-top: 4px;\n  padding: 4px 8px;\n  background: rgba(239, 68, 68, 0.1);\n  border-radius: 4px;\n  border: 1px solid rgba(239, 68, 68, 0.2);\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 16px;\n}\n\n.step-item {\n  background: rgba(0, 0, 0, 0.3);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  overflow: hidden;\n}\n\n.step-content {\n  padding: 16px;\n}\n\n/* Empty State */\n.empty-steps {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 40px 20px;\n  text-align: center;\n  gap: 16px;\n  min-height: 200px;\n}\n\n.empty-steps .empty-icon {\n  color: rgba(255, 255, 255, 0.4);\n  margin-bottom: 8px;\n}\n\n.empty-steps .empty-text {\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 14px;\n  margin: 0;\n}\n\n.empty-steps .btn-add-step {\n  margin-top: 8px;\n  padding: 12px 24px;\n  font-size: 14px;\n  font-weight: 600;\n  min-width: 180px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n  transition: all 0.3s ease;\n}\n\n.empty-steps .btn-add-step:hover {\n  transform: translateY(-2px);\n  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);\n}\n\n/* JSON Preview */\n.json-preview {\n  margin-bottom: 16px;\n  background: rgba(0, 0, 0, 0.4);\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n.preview-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 8px 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.json-code {\n  padding: 12px;\n  margin: 0;\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  font-size: 10px;\n  color: rgba(255, 255, 255, 0.8);\n  background: transparent;\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n}\n\n.editor-footer {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding-top: 12px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n/* Button Styles */\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  font-size: 12px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 6px;\n  transition: all 0.2s ease;\n  background: rgba(255, 255, 255, 0.1);\n  color: rgba(255, 255, 255, 0.8);\n}\n\n.btn:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  transform: translateY(-1px);\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n  transform: none !important;\n  box-shadow: none !important;\n}\n\n.btn-sm {\n  padding: 4px 8px;\n  font-size: 11px;\n}\n\n.btn-xs {\n  padding: 2px 4px;\n  font-size: 10px;\n  min-width: auto;\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.05);\n  color: rgba(255, 255, 255, 0.7);\n}\n\n.btn-danger {\n  background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\n  color: white;\n}\n\n.btn-danger:hover:not(:disabled) {\n  background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);\n  box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);\n}\n\n/* Preview Section Styles */\n.preview-section {\n  margin-top: 8px;\n  padding: 8px 12px;\n  background: rgba(102, 126, 234, 0.1);\n  border: 1px solid rgba(102, 126, 234, 0.2);\n  border-radius: 6px;\n  font-size: 10px;\n}\n\n.preview-label {\n  font-weight: 600;\n  color: #667eea;\n  margin-bottom: 4px;\n  font-size: 9px;\n}\n\n.preview-content {\n  color: white;\n}\n\n.preview-text {\n  line-height: 1.4;\n  color: white;\n}\n\n.preview-table-header {\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n  background: rgba(0, 0, 0, 0.3);\n  padding: 2px 6px;\n  border-radius: 3px;\n  color: #ef4444;\n  font-weight: 600;\n  border: 1px solid rgba(239, 68, 68, 0.3);\n}\n\n/* Copy Plan Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-footer .form-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.modal-footer .form-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.modal-footer .form-input {\n  padding: 10px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 13px;\n  transition: all 0.2s ease;\n}\n\n.modal-footer .form-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.modal-footer .btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-footer .btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.modal-footer .btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.modal-footer .btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.modal-footer .btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.modal-footer .spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Service Group Autocomplete Styles */\n.service-group-autocomplete {\n  position: relative;\n  width: 100%;\n}\n\n.service-group-autocomplete .form-input {\n  width: 100%;\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 11px;\n  font-family: inherit;\n  transition: all 0.2s ease;\n}\n\n.service-group-autocomplete .form-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n  background: rgba(0, 0, 0, 0.4);\n}\n\n.service-group-dropdown {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  right: 0;\n  margin-top: 4px;\n  background: rgba(0, 0, 0, 0.95);\n  backdrop-filter: blur(10px);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  max-height: 200px;\n  overflow-y: auto;\n  z-index: 1000;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n}\n\n.service-group-option {\n  padding: 8px 12px;\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.9);\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.05);\n}\n\n.service-group-option:last-child {\n  border-bottom: none;\n}\n\n.service-group-option:hover {\n  background: rgba(102, 126, 234, 0.2);\n  color: white;\n}\n\n.service-group-option:active {\n  background: rgba(102, 126, 234, 0.3);\n}\n</style>\n","import type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\n\nconst API_BASE_URL = '/api/executor'\n\n/**\n * Fetch detailed agent execution record by stepId\n * @param stepId The stepId to query\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function fetchAgentExecutionDetail(\n  stepId: string\n): Promise<AgentExecutionRecordDetail | null> {\n  try {\n    const response = await fetch(`${API_BASE_URL}/agent-execution/${stepId}`)\n\n    if (!response.ok) {\n      if (response.status === 404) {\n        console.warn(`Agent execution detail not found for stepId: ${stepId}`)\n        return null\n      }\n      throw new Error(`HTTP error! status: ${response.status}`)\n    }\n\n    const data = await response.json()\n    return data as AgentExecutionRecordDetail\n  } catch (error) {\n    console.error(`Error fetching agent execution detail for stepId: ${stepId}:`, error)\n    return null\n  }\n}\n\n/**\n * Refresh agent execution detail by stepId\n * This is a wrapper around fetchAgentExecutionDetail for explicit refresh operations\n * @param stepId The stepId to refresh\n * @returns Promise<AgentExecutionRecordDetail | null>\n */\nexport async function refreshAgentExecutionDetail(\n  stepId: string\n): Promise<AgentExecutionRecordDetail | null> {\n  console.log(`Refreshing agent execution detail for stepId: ${stepId}`)\n  return fetchAgentExecutionDetail(stepId)\n}\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { fetchAgentExecutionDetail, refreshAgentExecutionDetail } from '@/api/agent-execution'\nimport { useMessageDialogSingleton } from '@/composables/useMessageDialog'\nimport { usePlanExecutionSingleton } from '@/composables/usePlanExecution'\nimport type { AgentExecutionRecordDetail } from '@/types/agent-execution-detail'\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\nimport { computed, nextTick, readonly, ref } from 'vue'\n\n/**\n * Selected step interface\n */\nexport interface SelectedStep {\n  stepId: string\n  title: string\n  description: string\n  agentExecution?: AgentExecutionRecordDetail\n  completed: boolean\n  current: boolean\n}\n\n/**\n * Composable for managing right panel state and operations\n * Provides methods to manage step selection, file browser, and panel state\n */\nexport function useRightPanel() {\n  // Get messageDialog singleton to access activeRootPlanId\n  const messageDialog = useMessageDialogSingleton()\n  const planExecution = usePlanExecutionSingleton()\n\n  // Step selection state\n  const selectedStep = ref<SelectedStep | null>(null)\n\n  // Root plan ID for the selected step (used for file browser)\n  // When a step is selected, this will be set to the step's rootPlanId\n  const selectedRootPlanId = ref<string | null>(null)\n\n  // Active tab state\n  const activeTab = ref<'config' | 'details' | 'files'>('config')\n\n  // Current root plan ID - reactively derived from useMessageDialog's activeRootPlanId\n  // This gets the planId from the active dialog, ensuring each dialog maintains its own execution tracking\n  const currentRootPlanId = computed(() => {\n    return messageDialog.activeRootPlanId.value\n  })\n\n  /**\n   * Find rootPlanId for a given stepId by searching through planExecutionRecords\n   * @param stepId - The step ID to find rootPlanId for\n   * @returns The rootPlanId if found, null otherwise\n   */\n  const findRootPlanIdForStep = (stepId: string): string | null => {\n    if (!stepId) return null\n\n    // Search through all plan execution records\n    for (const [planId, record] of planExecution.planExecutionRecords.entries()) {\n      // Check if this record's rootPlanId or currentPlanId matches\n      const recordKey = record.rootPlanId || record.currentPlanId\n      if (!recordKey) continue\n\n      // Search in agentExecutionSequence\n      if (record.agentExecutionSequence) {\n        for (const agentExecution of record.agentExecutionSequence) {\n          if (agentExecution.stepId === stepId) {\n            // Found the step, return the rootPlanId (or currentPlanId if rootPlanId is not available)\n            const rootPlanId = record.rootPlanId || record.currentPlanId\n            console.log('[useRightPanel] Found rootPlanId for stepId:', {\n              stepId,\n              rootPlanId,\n              planId,\n            })\n            return rootPlanId || null\n          }\n\n          // Also check in subPlanExecutionRecords recursively\n          if (agentExecution.subPlanExecutionRecords) {\n            for (const subPlan of agentExecution.subPlanExecutionRecords) {\n              // Use type assertion to handle readonly types from reactive Map\n              const subRootPlanId = findRootPlanIdInSubPlan(\n                subPlan as unknown as PlanExecutionRecord,\n                stepId\n              )\n              if (subRootPlanId) {\n                return subRootPlanId\n              }\n            }\n          }\n        }\n      }\n    }\n\n    console.warn('[useRightPanel] Could not find rootPlanId for stepId:', stepId)\n    return null\n  }\n\n  /**\n   * Recursively search for stepId in sub-plan execution records\n   * @param subPlan - The sub-plan record to search\n   * @param stepId - The step ID to find\n   * @returns The rootPlanId if found, null otherwise\n   */\n  const findRootPlanIdInSubPlan = (subPlan: PlanExecutionRecord, stepId: string): string | null => {\n    if (!subPlan || !subPlan.agentExecutionSequence) return null\n\n    for (const agentExecution of subPlan.agentExecutionSequence) {\n      if (agentExecution.stepId === stepId) {\n        return subPlan.rootPlanId || subPlan.currentPlanId || null\n      }\n\n      if (agentExecution.subPlanExecutionRecords) {\n        for (const nestedSubPlan of agentExecution.subPlanExecutionRecords) {\n          const result = findRootPlanIdInSubPlan(nestedSubPlan, stepId)\n          if (result) return result\n        }\n      }\n    }\n\n    return null\n  }\n\n  /**\n   * Computed property to determine which planId to show in file browser\n   * Priority: selectedRootPlanId (when a step is selected) > currentRootPlanId (current active plan)\n   */\n  const fileBrowserPlanId = computed(() => {\n    return selectedRootPlanId.value || currentRootPlanId.value\n  })\n\n  /**\n   * Computed property to determine if we should show the \"no task\" message\n   */\n  const shouldShowNoTaskMessage = computed(() => {\n    return !fileBrowserPlanId.value\n  })\n\n  /**\n   * Handle step selection by stepId\n   * @param stepId - The step ID to display\n   */\n  const handleStepSelected = async (stepId: string): Promise<void> => {\n    console.log('[useRightPanel] Step selected:', { stepId })\n\n    if (!stepId) {\n      console.warn('[useRightPanel] No stepId provided')\n      selectedStep.value = null\n      selectedRootPlanId.value = null\n      return\n    }\n\n    // Switch to 'details' tab when a step is selected\n    setActiveTab('details')\n    console.log('[useRightPanel] Switched to details tab')\n\n    try {\n      // Find the rootPlanId for this step first\n      const rootPlanId = findRootPlanIdForStep(stepId)\n      if (rootPlanId) {\n        selectedRootPlanId.value = rootPlanId\n        console.log('[useRightPanel] Set selectedRootPlanId to:', rootPlanId)\n      } else {\n        // If not found, clear it (will fall back to currentRootPlanId)\n        selectedRootPlanId.value = null\n        console.warn(\n          '[useRightPanel] Could not find rootPlanId for step, will use currentRootPlanId'\n        )\n      }\n\n      // Fetch agent execution detail from API\n      const agentExecutionDetail = await fetchAgentExecutionDetail(stepId)\n\n      if (!agentExecutionDetail) {\n        console.warn('[useRightPanel] Agent execution detail not found for stepId:', stepId)\n        selectedStep.value = null\n        selectedRootPlanId.value = null\n        return\n      }\n\n      // Create step data object\n      const stepData: SelectedStep = {\n        stepId: stepId,\n        title: agentExecutionDetail.agentName ?? `Step ${stepId}`,\n        description: agentExecutionDetail.agentDescription ?? '',\n        agentExecution: agentExecutionDetail,\n        completed: agentExecutionDetail.status === 'FINISHED',\n        current: agentExecutionDetail.status === 'RUNNING',\n      }\n\n      selectedStep.value = stepData\n      console.log('[useRightPanel] Step details updated:', stepData)\n\n      // Force reactivity update\n      await nextTick()\n      console.log('[useRightPanel] After nextTick - selectedStep:', selectedStep.value)\n    } catch (error) {\n      console.error('[useRightPanel] Error fetching step details:', error)\n      selectedStep.value = null\n      selectedRootPlanId.value = null\n    }\n  }\n\n  /**\n   * Refresh the currently selected step\n   */\n  const refreshCurrentStep = async (): Promise<void> => {\n    if (!selectedStep.value?.stepId) {\n      console.warn('[useRightPanel] No step selected for refresh')\n      return\n    }\n\n    console.log('[useRightPanel] Refreshing current step:', selectedStep.value.stepId)\n\n    try {\n      const agentExecutionDetail = await refreshAgentExecutionDetail(selectedStep.value.stepId)\n\n      if (agentExecutionDetail) {\n        // Update the existing step data\n        selectedStep.value.agentExecution = agentExecutionDetail\n        selectedStep.value.completed = agentExecutionDetail.status === 'FINISHED'\n        selectedStep.value.current = agentExecutionDetail.status === 'RUNNING'\n\n        console.log('[useRightPanel] Step refreshed successfully')\n      }\n    } catch (error) {\n      console.error('[useRightPanel] Error refreshing step:', error)\n    }\n  }\n\n  /**\n   * Set active tab\n   * @param tab - The tab to activate ('config', 'details', or 'files')\n   */\n  const setActiveTab = (tab: 'config' | 'details' | 'files'): void => {\n    activeTab.value = tab\n    console.log('[useRightPanel] Active tab set to:', tab)\n  }\n\n  /**\n   * Update displayed plan progress\n   * This method is kept for backward compatibility but no longer needed\n   * since currentRootPlanId is now reactively derived from useMessageDialog\n   * @param rootPlanId - The root plan ID to update (deprecated, kept for compatibility)\n   */\n  const updateDisplayedPlanProgress = (rootPlanId: string): void => {\n    console.log('[useRightPanel] updateDisplayedPlanProgress called with rootPlanId:', rootPlanId)\n    // No-op: currentRootPlanId is now reactively derived from useMessageDialog\n  }\n\n  /**\n   * Clear selected step\n   */\n  const clearSelectedStep = (): void => {\n    selectedStep.value = null\n    selectedRootPlanId.value = null\n    console.log('[useRightPanel] Selected step cleared')\n  }\n\n  /**\n   * Format JSON data for display\n   * @param jsonData - The data to format\n   * @returns Formatted JSON string or 'N/A' if invalid\n   */\n  const formatJson = (jsonData: unknown): string => {\n    // Handle null, undefined, or empty string\n    if (jsonData === null || typeof jsonData === 'undefined' || jsonData === '') {\n      return 'N/A'\n    }\n\n    // If it's already an object, stringify it directly\n    if (typeof jsonData === 'object' && jsonData !== null) {\n      try {\n        return JSON.stringify(jsonData, null, 2)\n      } catch {\n        return String(jsonData)\n      }\n    }\n\n    // If it's a string, try to parse it as JSON\n    if (typeof jsonData === 'string') {\n      const trimmed = jsonData.trim()\n      if (trimmed === '') {\n        return 'N/A'\n      }\n\n      try {\n        // Try to parse as JSON\n        const parsed = JSON.parse(trimmed)\n        // Re-stringify with formatting\n        return JSON.stringify(parsed, null, 2)\n      } catch {\n        // If parsing fails, return the string as-is (might be plain text)\n        return trimmed\n      }\n    }\n\n    // For other types (number, boolean, etc.), convert to string\n    return String(jsonData)\n  }\n\n  /**\n   * Reset state\n   */\n  const reset = (): void => {\n    selectedStep.value = null\n    selectedRootPlanId.value = null\n    activeTab.value = 'config'\n    // Note: currentRootPlanId is computed from useMessageDialog, so no need to reset it\n    console.log('[useRightPanel] State reset')\n  }\n\n  return {\n    // State\n    selectedStep: readonly(selectedStep),\n    activeTab,\n\n    // Computed\n    currentRootPlanId,\n    fileBrowserPlanId,\n    shouldShowNoTaskMessage,\n\n    // Methods\n    handleStepSelected,\n    refreshCurrentStep,\n    setActiveTab,\n    updateDisplayedPlanProgress,\n    clearSelectedStep,\n    formatJson,\n    reset,\n  }\n}\n\n// Singleton instance for global use\nlet singletonInstance: ReturnType<typeof useRightPanel> | null = null\n\n/**\n * Get or create singleton instance of useRightPanel\n */\nexport function useRightPanelSingleton() {\n  if (!singletonInstance) {\n    singletonInstance = useRightPanel()\n  }\n  return singletonInstance\n}\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"right-panel\">\n    <div class=\"preview-header\">\n      <div class=\"preview-tabs\">\n        <!-- Func-Agent Config tab -->\n        <div\n          class=\"tab-item\"\n          :class=\"{ active: activeTab === 'config' }\"\n          @click=\"activeTab = 'config'\"\n        >\n          <Icon icon=\"carbon:settings\" />\n          <span>{{ t('sidebar.configuration') }}</span>\n        </div>\n        <!-- Step Execution Details tab -->\n        <div\n          class=\"tab-item\"\n          :class=\"{ active: activeTab === 'details' }\"\n          @click=\"activeTab = 'details'\"\n        >\n          <Icon icon=\"carbon:events\" />\n          <span>{{ t('rightPanel.stepExecutionDetails') }}</span>\n        </div>\n        <!-- File Browser tab -->\n        <div\n          class=\"tab-item\"\n          :class=\"{ active: activeTab === 'files' }\"\n          @click=\"activeTab = 'files'\"\n        >\n          <Icon icon=\"carbon:folder\" />\n          <span>{{ t('fileBrowser.title') }}</span>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"preview-content\">\n      <!-- Func-Agent Config -->\n      <div v-if=\"activeTab === 'config'\" class=\"config-tab-content\">\n        <div v-if=\"templateConfig.selectedTemplate.value\" class=\"config-container\">\n          <!-- Template Info Header -->\n          <div class=\"template-info-header\">\n            <div class=\"template-info\">\n              <h3>\n                {{ templateConfig.selectedTemplate.value.title || t('sidebar.unnamedPlan') }}\n              </h3>\n              <span class=\"template-id\"\n                >ID: {{ templateConfig.selectedTemplate.value.planTemplateId }}</span\n              >\n            </div>\n            <button class=\"back-to-list-btn\" @click=\"sidebarStore.switchToTab('list')\">\n              <Icon icon=\"carbon:arrow-left\" width=\"16\" />\n            </button>\n          </div>\n\n          <!-- JSON Editor -->\n          <JsonEditorV2 />\n\n          <!-- Execution Controller -->\n          <ExecutionController />\n        </div>\n        <div v-else class=\"no-template-selected\">\n          <div class=\"action-buttons\">\n            <button class=\"new-task-btn\" @click=\"handleCreateNewPlan\">\n              <Icon icon=\"carbon:add\" width=\"16\" />\n              {{ t('rightPanel.newFuncAgentPlan') }}\n            </button>\n            <label class=\"new-task-btn\" :title=\"t('rightPanel.importExistingPlan')\">\n              <Icon icon=\"carbon:import\" width=\"16\" />\n              {{ t('rightPanel.importExistingPlan') }}\n              <input\n                type=\"file\"\n                accept=\".json\"\n                @change=\"handleImportExistingPlan\"\n                style=\"display: none\"\n              />\n            </label>\n          </div>\n          <p class=\"import-description\">\n            {{ t('rightPanel.importDescription') }}\n            <a\n              href=\"https://github.com/Lynxe-public/Lynxe-public-prompts\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              class=\"prompt-library-link\"\n            >\n              {{ t('rightPanel.promptLibrary') }}\n            </a>\n            {{ t('rightPanel.importDescriptionSuffix') }}\n          </p>\n        </div>\n      </div>\n\n      <!-- Step Execution Details -->\n      <div v-if=\"activeTab === 'details'\" class=\"step-details\">\n        <!-- Step basic information -->\n        <div v-if=\"selectedStep\" class=\"step-info\">\n          <h3>\n            {{\n              selectedStep.title ||\n              selectedStep.description ||\n              t('rightPanel.defaultStepTitle', { number: 1 })\n            }}\n          </h3>\n\n          <div class=\"agent-info\" v-if=\"selectedStep.agentExecution\">\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.executingAgent') }}:</span>\n              <span\n                class=\"value\"\n                :title=\"\n                  selectedStep.agentExecution.agentName === 'ConfigurableDynaAgent'\n                    ? t('chat.clickToViewExecutionDetails')\n                    : ''\n                \"\n              >\n                {{\n                  selectedStep.agentExecution.agentName === 'ConfigurableDynaAgent'\n                    ? t('chat.funcAgentExecutionDetails')\n                    : selectedStep.agentExecution.agentName\n                }}\n              </span>\n            </div>\n            <div class=\"info-item\">\n              <span class=\"label\">{{ t('rightPanel.callingModel') }}:</span>\n              <span class=\"value\">{{ selectedStep.agentExecution.modelName }}</span>\n            </div>\n          </div>\n\n          <div class=\"execution-status\">\n            <div class=\"status-item\">\n              <Icon\n                icon=\"carbon:checkmark-filled\"\n                v-if=\"selectedStep.completed\"\n                class=\"status-icon success\"\n              />\n              <Icon\n                icon=\"carbon:in-progress\"\n                v-else-if=\"selectedStep.current\"\n                class=\"status-icon progress\"\n              />\n              <Icon icon=\"carbon:time\" v-else class=\"status-icon pending\" />\n              <span class=\"status-text\">\n                {{ stepStatusText }}\n              </span>\n            </div>\n          </div>\n        </div>\n\n        <!-- Scrollable detailed content area -->\n        <div ref=\"scrollContainer\" class=\"step-details-scroll-container\" @scroll=\"checkScrollState\">\n          <div v-if=\"selectedStep\">\n            <!-- Think and action steps -->\n            <div\n              class=\"think-act-steps\"\n              v-if=\"\n                selectedStep.agentExecution?.thinkActSteps &&\n                selectedStep.agentExecution.thinkActSteps.length > 0\n              \"\n            >\n              <h4>{{ t('rightPanel.thinkAndActionSteps') }}</h4>\n              <div class=\"steps-container\">\n                <div\n                  v-for=\"(tas, index) in selectedStep.agentExecution.thinkActSteps\"\n                  :key=\"index\"\n                  class=\"think-act-step\"\n                >\n                  <div class=\"step-header\">\n                    <span class=\"step-number\">#{{ index + 1 }}</span>\n                    <span class=\"step-status\" :class=\"tas.status\">{{\n                      tas.status || t('rightPanel.executing')\n                    }}</span>\n                  </div>\n\n                  <!-- Think section - strictly follow right-sidebar.js logic -->\n                  <div class=\"think-section\">\n                    <h5>\n                      <Icon icon=\"carbon:thinking\" />\n                      {{ t('rightPanel.thinking') }}\n                    </h5>\n                    <div class=\"think-content\">\n                      <div class=\"input\">\n                        <div class=\"label-row\">\n                          <span class=\"label\">{{ t('rightPanel.input') }}:</span>\n                          <div class=\"label-actions\">\n                            <button\n                              class=\"copy-btn\"\n                              @click=\"copyToClipboard(tas.thinkInput)\"\n                              :title=\"t('rightPanel.copyToClipboard')\"\n                            >\n                              <Icon icon=\"carbon:copy\" />\n                            </button>\n                            <span class=\"char-count-badge\"\n                              >{{ tas.inputCharCount ?? 0 }} chars</span\n                            >\n                          </div>\n                        </div>\n                        <div class=\"pre-container\">\n                          <pre>{{ formatJson(tas.thinkInput) }}</pre>\n                        </div>\n                      </div>\n                      <div class=\"output\">\n                        <div class=\"label-row\">\n                          <span class=\"label\">{{ t('rightPanel.output') }}:</span>\n                          <div class=\"label-actions\">\n                            <button\n                              class=\"copy-btn\"\n                              @click=\"copyToClipboard(tas.thinkOutput)\"\n                              :title=\"t('rightPanel.copyToClipboard')\"\n                            >\n                              <Icon icon=\"carbon:copy\" />\n                            </button>\n                            <span class=\"char-count-badge\"\n                              >{{ tas.outputCharCount ?? 0 }} chars</span\n                            >\n                          </div>\n                        </div>\n                        <div class=\"pre-container\">\n                          <pre>{{ formatJson(tas.thinkOutput) }}</pre>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n\n                  <!-- Action section - strictly follow right-sidebar.js logic -->\n                  <div v-if=\"tas.actionNeeded\" class=\"action-section\">\n                    <h5>\n                      <Icon icon=\"carbon:play\" />\n                      {{ t('rightPanel.action') }}\n                    </h5>\n                    <div class=\"action-content\">\n                      <div\n                        v-for=\"(actToolInfo, index) in tas.actToolInfoList || []\"\n                        :key=\"`tool-${index}-${actToolInfo?.id || actToolInfo?.name || index}`\"\n                        class=\"tool-execution-item\"\n                      >\n                        <div class=\"tool-info\">\n                          <span class=\"label\">{{ t('rightPanel.tool') }}:</span>\n                          <span class=\"value\">{{ actToolInfo?.name || 'N/A' }}</span>\n                        </div>\n                        <div class=\"input\">\n                          <span class=\"label\">{{ t('rightPanel.toolParameters') }}:</span>\n                          <pre>{{ formatJson(actToolInfo?.parameters) }}</pre>\n                        </div>\n                        <div class=\"output\">\n                          <span class=\"label\">{{ t('rightPanel.executionResult') }}:</span>\n                          <pre>{{ formatJson(actToolInfo?.result) }}</pre>\n                        </div>\n                      </div>\n                      <div\n                        v-if=\"!tas.actToolInfoList || tas.actToolInfoList.length === 0\"\n                        class=\"no-tools\"\n                      >\n                        <p>{{ t('rightPanel.noToolsExecuted') }}</p>\n                      </div>\n                    </div>\n\n                    <!-- Sub execution plan section - new feature -->\n                    <div v-if=\"tas.subPlanExecutionRecord\" class=\"sub-plan-section\">\n                      <h5>\n                        <Icon icon=\"carbon:tree-view\" />\n                        {{ t('rightPanel.subPlan') }}\n                      </h5>\n                      <div class=\"sub-plan-content\">\n                        <div class=\"sub-plan-header\">\n                          <div class=\"sub-plan-info\">\n                            <span class=\"label\">{{ $t('rightPanel.subPlanId') }}:</span>\n                            <span class=\"value\">{{\n                              tas.subPlanExecutionRecord.currentPlanId\n                            }}</span>\n                          </div>\n                          <div class=\"sub-plan-info\" v-if=\"tas.subPlanExecutionRecord.title\">\n                            <span class=\"label\">{{ $t('rightPanel.title') }}:</span>\n                            <span class=\"value\">{{ tas.subPlanExecutionRecord.title }}</span>\n                          </div>\n                          <div class=\"sub-plan-status\">\n                            <Icon\n                              icon=\"carbon:checkmark-filled\"\n                              v-if=\"tas.subPlanExecutionRecord.completed\"\n                              class=\"status-icon success\"\n                            />\n                            <Icon icon=\"carbon:in-progress\" v-else class=\"status-icon progress\" />\n                            <span class=\"status-text\">\n                              {{\n                                tas.subPlanExecutionRecord.completed\n                                  ? $t('rightPanel.status.completed')\n                                  : $t('rightPanel.status.executing')\n                              }}\n                            </span>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n\n              <div\n                v-if=\"\n                  selectedStep.agentExecution && !selectedStep.agentExecution.thinkActSteps?.length\n                \"\n                class=\"no-steps-message\"\n              >\n                <p>{{ t('rightPanel.noStepDetails') }}</p>\n              </div>\n\n              <!-- Handle no agentExecution case -->\n              <div v-else-if=\"!selectedStep.agentExecution\" class=\"no-execution-message\">\n                <Icon icon=\"carbon:information\" class=\"info-icon\" />\n                <h4>{{ t('rightPanel.stepInfo') }}</h4>\n                <div class=\"step-basic-info\">\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ t('rightPanel.stepName') }}:</span>\n                    <span class=\"value\">{{\n                      selectedStep.title || selectedStep.description || selectedStep.stepId\n                    }}</span>\n                  </div>\n                  <div class=\"info-item\" v-if=\"selectedStep.description\">\n                    <span class=\"label\">{{ $t('rightPanel.description') }}:</span>\n                    <span class=\"value\">{{ selectedStep.description }}</span>\n                  </div>\n                  <div class=\"info-item\">\n                    <span class=\"label\">{{ $t('rightPanel.status.label') }}:</span>\n                    <span\n                      class=\"value\"\n                      :class=\"{\n                        'status-completed': selectedStep.completed,\n                        'status-current': selectedStep.current,\n                        'status-pending': !selectedStep.completed && !selectedStep.current,\n                      }\"\n                    >\n                      {{\n                        selectedStep.completed\n                          ? $t('rightPanel.status.completed')\n                          : selectedStep.current\n                            ? $t('rightPanel.status.executing')\n                            : $t('rightPanel.status.pending')\n                      }}\n                    </span>\n                  </div>\n                </div>\n                <p class=\"no-execution-hint\">{{ t('rightPanel.noExecutionInfo') }}</p>\n              </div>\n\n              <!-- Dynamic effect during execution -->\n              <div\n                v-if=\"selectedStep.current && !selectedStep.completed\"\n                class=\"execution-indicator\"\n              >\n                <div class=\"execution-waves\">\n                  <div class=\"wave wave-1\"></div>\n                  <div class=\"wave wave-2\"></div>\n                  <div class=\"wave wave-3\"></div>\n                </div>\n                <p class=\"execution-text\">\n                  <Icon icon=\"carbon:in-progress\" class=\"rotating-icon\" />\n                  {{ t('rightPanel.stepExecuting') }}\n                </p>\n              </div>\n            </div>\n\n            <div v-else class=\"no-selection\">\n              <Icon icon=\"carbon:events\" class=\"empty-icon\" />\n              <h3>{{ t('rightPanel.noStepSelected') }}</h3>\n              <p>{{ t('rightPanel.selectStepHint') }}</p>\n            </div>\n          </div>\n\n          <!-- Scroll to bottom button -->\n          <Transition name=\"scroll-button\">\n            <button\n              v-if=\"showScrollToBottomButton\"\n              @click=\"scrollToBottom\"\n              class=\"scroll-to-bottom-btn\"\n              :title=\"t('rightPanel.scrollToBottom')\"\n            >\n              <Icon icon=\"carbon:chevron-down\" />\n            </button>\n          </Transition>\n        </div>\n      </div>\n\n      <!-- File Browser -->\n      <div v-if=\"activeTab === 'files'\" class=\"file-browser-container\">\n        <FileBrowser v-if=\"fileBrowserPlanId\" :plan-id=\"fileBrowserPlanId\" />\n        <div v-else-if=\"shouldShowNoTaskMessage\" class=\"no-plan-message\">\n          <Icon icon=\"carbon:folder-off\" />\n          <div class=\"message-content\">\n            <h3>{{ t('fileBrowser.noFilesYet') }}</h3>\n            <p>{{ t('fileBrowser.noPlanExecuting') }}</p>\n            <div class=\"tips\">\n              <Icon icon=\"carbon:information\" />\n              <span>{{ t('fileBrowser.startTaskTip') }}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport FileBrowser from '@/components/file-browser/index.vue'\nimport ExecutionController from '@/components/sidebar/ExecutionController.vue'\nimport JsonEditorV2 from '@/components/sidebar/JsonEditorV2.vue'\nimport { useAvailableToolsSingleton } from '@/composables/useAvailableTools'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { usePlanTemplateImport } from '@/composables/usePlanTemplateImport'\nimport { useRightPanelSingleton } from '@/composables/useRightPanel'\nimport { useToast } from '@/plugins/useToast'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { templateStore } from '@/stores/templateStore'\nimport { Icon } from '@iconify/vue'\nimport { computed, nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\n\n// Define props interface\ninterface Props {\n  currentRootPlanId?: string | null\n  selectedStepId?: string | null\n}\n\nconst props = defineProps<Props>()\n\nconst { t } = useI18n()\nconst toast = useToast()\n\n// Copy to clipboard function\nconst copyToClipboard = async (text: string | null | undefined) => {\n  if (!text) {\n    toast.error(t('rightPanel.copyFailed') || 'Failed to copy')\n    return\n  }\n  try {\n    await navigator.clipboard.writeText(text)\n    toast.success(t('rightPanel.copySuccess') || 'Copied to clipboard')\n  } catch (error) {\n    console.error('Failed to copy to clipboard:', error)\n    toast.error(t('rightPanel.copyFailed') || 'Failed to copy')\n  }\n}\n\n// Use singleton composable for right panel state\nconst rightPanel = useRightPanelSingleton()\n\n// Template config for Func-Agent Config tab\nconst templateConfig = usePlanTemplateConfigSingleton()\n\n// Available tools management\nconst availableToolsStore = useAvailableToolsSingleton()\n\n// Plan template import composable\nconst { handleImport: handleImportPlanTemplate } = usePlanTemplateImport()\n\n// DOM element reference\nconst scrollContainer = ref<HTMLElement>()\n\n// Scroll-related state (component-specific, not in composable)\nconst showScrollToBottomButton = ref(false)\nconst isNearBottom = ref(true)\nconst shouldAutoScrollToBottom = ref(true)\n\n// Computed properties using composable state\nconst selectedStep = computed(() => rightPanel.selectedStep.value)\nconst activeTab = computed({\n  get: () => rightPanel.activeTab.value,\n  set: (value: 'config' | 'details' | 'files') => rightPanel.setActiveTab(value),\n})\nconst fileBrowserPlanId = computed(() => rightPanel.fileBrowserPlanId.value)\nconst shouldShowNoTaskMessage = computed(() => rightPanel.shouldShowNoTaskMessage.value)\n\nconst stepStatusText = computed(() => {\n  if (!selectedStep.value) return ''\n  if (selectedStep.value.completed) return t('rightPanel.status.completed')\n  if (selectedStep.value.current) return t('rightPanel.status.executing')\n  return t('rightPanel.status.waiting')\n})\n\n// Actions - Template creation and import\n/**\n * Handle creating a new Func-Agent plan\n */\nconst handleCreateNewPlan = async () => {\n  try {\n    // Use default plan type or get from templateConfig\n    const planType = templateConfig.getPlanType() || 'dynamic_agent'\n    await templateStore.createNewTemplate(planType)\n\n    // Load template config for new template\n    const newTemplate = templateConfig.selectedTemplate.value\n    if (newTemplate) {\n      templateConfig.reset()\n      templateConfig.setPlanType(newTemplate.planType || 'dynamic_agent')\n      if (newTemplate.planTemplateId) {\n        templateConfig.setPlanTemplateId(newTemplate.planTemplateId)\n      }\n      templateConfig.setTitle(newTemplate.title || '')\n    }\n\n    // Reload available tools to ensure fresh tool list\n    console.log('[RightPanel]  Reloading available tools for new template')\n    await availableToolsStore.loadAvailableTools()\n  } catch (error) {\n    console.error('[RightPanel] Failed to create new plan:', error)\n    const message = error instanceof Error ? error.message : t('rightPanel.createPlanFailed')\n    toast.error(message)\n  }\n}\n\n/**\n * Handle importing an existing plan\n */\nconst handleImportExistingPlan = async (event: Event) => {\n  await handleImportPlanTemplate(event, {\n    onSuccess: async result => {\n      const successMsg = t('rightPanel.importSuccess', {\n        total: result.total,\n        success: result.successCount,\n        failed: result.failureCount,\n      })\n      toast.success(successMsg)\n    },\n    onError: error => {\n      const errorMessage = error instanceof Error ? error.message : t('rightPanel.importFailed')\n      toast.error(errorMessage)\n    },\n    onReload: async () => {\n      // Reload template list\n      await templateStore.loadPlanTemplateList()\n    },\n    onSingleTemplateImported: async template => {\n      // If only one template was imported, select it\n      if (template.planTemplateId) {\n        templateConfig.setPlanTemplateId(template.planTemplateId)\n        await templateConfig.load(template.planTemplateId)\n      }\n    },\n  })\n}\n\n// Actions - Step selection and refresh control\n\n/**\n * Handle step selection by stepId\n * Wrapper around composable method with scroll management\n * @param stepId - The step ID to display\n */\nconst handleStepSelected = async (stepId: string): Promise<void> => {\n  await rightPanel.handleStepSelected(stepId)\n\n  // Delay scroll state check to ensure DOM is updated\n  setTimeout(() => {\n    checkScrollState()\n  }, 100)\n\n  // Auto-scroll to latest content if previously at bottom\n  autoScrollToBottomIfNeeded()\n}\n\n/**\n * Refresh the currently selected step\n * Wrapper around composable method with scroll management\n */\nconst refreshCurrentStep = async (): Promise<void> => {\n  await rightPanel.refreshCurrentStep()\n\n  // Auto-scroll to latest content if previously at bottom\n  autoScrollToBottomIfNeeded()\n}\n\n// Watch for selectedStepId prop changes\nwatch(\n  () => props.selectedStepId,\n  async newStepId => {\n    if (newStepId) {\n      await handleStepSelected(newStepId)\n    } else {\n      rightPanel.clearSelectedStep()\n    }\n  },\n  { immediate: true }\n)\n\n// Actions - Scroll management\nconst setScrollContainer = (element: HTMLElement | null) => {\n  scrollContainer.value = element ?? undefined\n}\n\nconst checkScrollState = () => {\n  if (!scrollContainer.value) return\n\n  const { scrollTop, scrollHeight, clientHeight } = scrollContainer.value\n  const isAtBottom = scrollHeight - scrollTop - clientHeight < 50\n  const hasScrollableContent = scrollHeight > clientHeight\n\n  isNearBottom.value = isAtBottom\n  showScrollToBottomButton.value = hasScrollableContent && !isAtBottom\n\n  // Update auto-scroll flag: should auto-scroll if user scrolls to bottom\n  // If user actively scrolls up away from bottom, stop auto-scrolling\n  if (isAtBottom) {\n    shouldAutoScrollToBottom.value = true\n  } else if (scrollHeight - scrollTop - clientHeight > 100) {\n    // If user clearly scrolled up (more than 100px from bottom), stop auto-scrolling\n    shouldAutoScrollToBottom.value = false\n  }\n}\n\nconst scrollToBottom = () => {\n  if (!scrollContainer.value) return\n\n  scrollContainer.value.scrollTo({\n    top: scrollContainer.value.scrollHeight,\n    behavior: 'smooth',\n  })\n\n  // Reset state after scrolling\n  nextTick(() => {\n    shouldAutoScrollToBottom.value = true\n    checkScrollState()\n  })\n}\n\nconst autoScrollToBottomIfNeeded = () => {\n  if (!shouldAutoScrollToBottom.value || !scrollContainer.value) return\n\n  nextTick(() => {\n    if (scrollContainer.value) {\n      scrollContainer.value.scrollTop = scrollContainer.value.scrollHeight\n      console.log('[RightPanel] Auto scroll to bottom')\n    }\n  })\n}\n\n// Actions - Utility functions\n// Use formatJson from composable\nconst formatJson = rightPanel.formatJson\n\n// Actions - Resource cleanup\nconst cleanup = () => {\n  shouldAutoScrollToBottom.value = true\n\n  if (scrollContainer.value) {\n    scrollContainer.value.removeEventListener('scroll', checkScrollState)\n  }\n}\n\n// Initialize scroll listener\nconst initScrollListener = () => {\n  const setupScrollListener = () => {\n    const element = scrollContainer.value\n    if (!element) {\n      console.log('[RightPanel] Scroll container not found, retrying...')\n      return false\n    }\n\n    // Set scroll container\n    setScrollContainer(element)\n\n    element.addEventListener('scroll', checkScrollState)\n    // Initial state check\n    shouldAutoScrollToBottom.value = true // Reset to auto scroll state\n    checkScrollState()\n    console.log('[RightPanel] Scroll listener initialized successfully')\n    return true\n  }\n\n  // Use nextTick to ensure DOM is updated\n  nextTick(() => {\n    if (!setupScrollListener()) {\n      // If first attempt fails, try again\n      setTimeout(() => {\n        setupScrollListener()\n      }, 100)\n    }\n  })\n}\n\n// Note: currentRootPlanId is now reactively derived from useMessageDialog\n// No need to watch props.currentRootPlanId anymore\n\n// Lifecycle - initialization on mount\nonMounted(() => {\n  console.log('[RightPanel] Component mounted')\n  // Use nextTick to ensure DOM is rendered\n  nextTick(() => {\n    initScrollListener()\n  })\n})\n\n// Lifecycle - cleanup on unmount\nonUnmounted(() => {\n  console.log('[RightPanel] Component unmounting, cleaning up...')\n  cleanup()\n})\n\n/**\n * Update displayed plan progress\n * This method is called when a plan is updated to refresh the display\n * Wrapper around composable method\n * @param rootPlanId - The root plan ID to update\n */\nconst updateDisplayedPlanProgress = (rootPlanId: string): void => {\n  rightPanel.updateDisplayedPlanProgress(rootPlanId)\n}\n\n// Expose methods to parent component - only keep necessary interfaces\ndefineExpose({\n  handleStepSelected,\n  refreshCurrentStep,\n  updateDisplayedPlanProgress,\n})\n</script>\n\n<style lang=\"less\" scoped>\n.right-panel {\n  width: 50%;\n  display: flex;\n  flex-direction: column;\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n.preview-header {\n  padding: 8px 12px;\n  border-bottom: 1px solid #1a1a1a;\n  background: rgba(255, 255, 255, 0.02);\n\n  .tab-button {\n    padding: 8px 16px;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    border-radius: 6px;\n    background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);\n    border-color: #667eea;\n    color: #667eea;\n    cursor: default;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    font-size: 14px;\n  }\n}\n\n.preview-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n  overflow: hidden; /* Prevent content from overflowing */\n}\n\n/* Step details styles */\n.step-details {\n  flex: 1;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Ensure flex items can shrink */\n  height: 100%; /* Ensure it takes full height */\n}\n\n/* Step basic information */\n.step-info {\n  padding: 20px;\n  margin: 0 20px;\n  background: rgba(41, 42, 45, 0.8);\n  border-radius: 8px;\n  margin-bottom: 16px;\n  min-height: 100px; /* Ensure minimum height */\n\n  h3 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 18px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 2px solid #667eea;\n  }\n}\n\n.step-details-scroll-container {\n  flex: 1;\n  overflow-y: auto;\n  overflow-x: hidden;\n  padding: 0 20px 20px;\n  margin: 0 20px 20px;\n  background: rgba(255, 255, 255, 0.01);\n  border-radius: 8px;\n  min-height: 200px; /* Ensure minimum height */\n\n  /* Custom scrollbar styles */\n  &::-webkit-scrollbar {\n    width: 6px;\n  }\n\n  &::-webkit-scrollbar-track {\n    background: rgba(255, 255, 255, 0.1);\n    border-radius: 3px;\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background: rgba(255, 255, 255, 0.3);\n    border-radius: 3px;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.5);\n    }\n  }\n}\n\n/* Step information styles - for fixed top */\n.agent-info {\n  margin-bottom: 16px;\n\n  .info-item {\n    display: flex;\n    margin-bottom: 8px;\n    font-size: 14px;\n    line-height: 1.4;\n\n    .label {\n      min-width: 100px;\n      font-weight: 600;\n      color: #888888;\n      flex-shrink: 0;\n    }\n\n    .value {\n      flex: 1;\n      color: #cccccc;\n      word-break: break-word;\n\n      &.success {\n        color: #27ae60;\n      }\n    }\n  }\n}\n\n.execution-status {\n  margin-top: 16px;\n  padding-top: 16px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n  .status-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n\n    .status-icon {\n      font-size: 16px;\n\n      &.success {\n        color: #27ae60;\n      }\n\n      &.progress {\n        color: #3498db;\n      }\n\n      &.pending {\n        color: #f39c12;\n      }\n    }\n\n    .status-text {\n      color: #cccccc;\n      font-weight: 500;\n    }\n  }\n}\n\n.no-steps-message {\n  text-align: center;\n  color: #666666;\n  font-style: italic;\n  margin-top: 16px;\n\n  p {\n    margin: 0;\n  }\n}\n\n.no-execution-message {\n  padding: 20px;\n  background: #f8f9fa;\n  border: 1px solid #e9ecef;\n  border-radius: 8px;\n  margin-top: 16px;\n\n  .info-icon {\n    color: #6c757d;\n    font-size: 20px;\n    margin-bottom: 8px;\n  }\n\n  h4 {\n    margin: 0 0 16px 0;\n    color: #495057;\n    font-size: 16px;\n    font-weight: 500;\n  }\n\n  .step-basic-info {\n    .info-item {\n      display: flex;\n      margin-bottom: 8px;\n      font-size: 14px;\n\n      .label {\n        font-weight: 500;\n        color: #6c757d;\n        min-width: 80px;\n        margin-right: 8px;\n      }\n\n      .value {\n        color: #333;\n        flex: 1;\n\n        &.status-completed {\n          color: #28a745;\n          font-weight: 500;\n        }\n\n        &.status-current {\n          color: #007bff;\n          font-weight: 500;\n        }\n\n        &.status-pending {\n          color: #6c757d;\n        }\n      }\n    }\n  }\n\n  .no-execution-hint {\n    margin: 16px 0 0 0;\n    color: #6c757d;\n    font-style: italic;\n    font-size: 13px;\n    text-align: center;\n  }\n}\n\n.execution-indicator {\n  margin-top: 20px;\n  padding: 20px;\n  background: rgba(74, 144, 226, 0.1);\n  border: 1px solid rgba(74, 144, 226, 0.3);\n  border-radius: 8px;\n  text-align: center;\n  position: relative;\n  overflow: hidden;\n}\n\n.execution-waves {\n  position: relative;\n  height: 4px;\n  margin-bottom: 16px;\n  background: rgba(74, 144, 226, 0.2);\n  border-radius: 2px;\n  overflow: hidden;\n}\n\n.wave {\n  position: absolute;\n  top: 0;\n  left: -100%;\n  width: 100%;\n  height: 100%;\n  background: linear-gradient(90deg, transparent, rgba(74, 144, 226, 0.6), transparent);\n  border-radius: 2px;\n}\n\n.wave-1 {\n  animation: wave-animation 2s ease-in-out infinite;\n}\n\n.wave-2 {\n  animation: wave-animation 2s ease-in-out infinite 0.6s;\n}\n\n.wave-3 {\n  animation: wave-animation 2s ease-in-out infinite 1.2s;\n}\n\n@keyframes wave-animation {\n  0% {\n    left: -100%;\n  }\n  50% {\n    left: 100%;\n  }\n  100% {\n    left: 100%;\n  }\n}\n\n.execution-text {\n  color: #4a90e2;\n  font-size: 14px;\n  margin: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n}\n\n.rotating-icon {\n  animation: rotate-animation 1s linear infinite;\n}\n\n@keyframes rotate-animation {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.step-info {\n  h3 {\n    color: #ffffff;\n    margin: 0 0 20px 0;\n    font-size: 18px;\n    font-weight: 600;\n  }\n}\n\n.think-act-steps {\n  margin-top: 20px; /* Increase top spacing since there's no fixed header step info now */\n\n  h4 {\n    color: #ffffff;\n    margin: 0 0 16px 0;\n    font-size: 16px;\n    font-weight: 600;\n    padding-bottom: 8px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n  }\n}\n\n.steps-container {\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.think-act-step {\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  padding: 16px;\n\n  .step-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 16px;\n\n    .step-number {\n      font-weight: 600;\n      color: #667eea;\n      font-size: 14px;\n    }\n\n    .step-status {\n      padding: 4px 8px;\n      border-radius: 4px;\n      font-size: 12px;\n      font-weight: 500;\n\n      &.completed {\n        background: rgba(39, 174, 96, 0.2);\n        color: #27ae60;\n      }\n\n      &.running {\n        background: rgba(52, 152, 219, 0.2);\n        color: #3498db;\n      }\n\n      &.pending {\n        background: rgba(243, 156, 18, 0.2);\n        color: #f39c12;\n      }\n    }\n  }\n\n  .think-section,\n  .action-section,\n  .sub-plan-section {\n    margin-bottom: 16px;\n\n    &:last-child {\n      margin-bottom: 0;\n    }\n\n    h5 {\n      display: flex;\n      align-items: center;\n      gap: 6px;\n      margin: 0 0 12px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: #ffffff;\n    }\n  }\n\n  .think-content,\n  .action-content {\n    .tool-execution-item {\n      margin-bottom: 20px;\n      padding: 12px;\n      background: rgba(0, 0, 0, 0.2);\n      border-radius: 6px;\n      border: 1px solid rgba(255, 255, 255, 0.05);\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n    }\n\n    .no-tools {\n      padding: 12px;\n      text-align: center;\n      color: rgba(255, 255, 255, 0.5);\n      font-size: 13px;\n    }\n\n    .input,\n    .output,\n    .tool-info {\n      margin-bottom: 12px;\n\n      &:last-child {\n        margin-bottom: 0;\n      }\n\n      .label-row {\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        margin-bottom: 4px;\n      }\n\n      .label {\n        font-weight: 600;\n        color: #888888;\n        font-size: 12px;\n      }\n\n      .label-actions {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n      }\n\n      .copy-btn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 4px;\n        padding: 4px 6px;\n        color: rgba(255, 255, 255, 0.7);\n        cursor: pointer;\n        transition: all 0.2s;\n        font-size: 12px;\n\n        &:hover {\n          background: rgba(0, 0, 0, 0.5);\n          border-color: rgba(255, 255, 255, 0.2);\n          color: rgba(255, 255, 255, 0.9);\n        }\n\n        &:active {\n          transform: scale(0.95);\n        }\n      }\n\n      .value {\n        color: #cccccc;\n        font-size: 14px;\n      }\n\n      .pre-container {\n        display: block;\n      }\n\n      pre {\n        background: rgba(0, 0, 0, 0.3);\n        border: 1px solid rgba(255, 255, 255, 0.1);\n        border-radius: 4px;\n        padding: 12px;\n        color: #cccccc;\n        font-size: 12px;\n        overflow-x: auto;\n        white-space: pre-wrap;\n        margin: 0;\n        line-height: 1.4;\n        max-height: 200px;\n        overflow-y: auto;\n      }\n\n      .char-count-badge {\n        background: rgba(0, 0, 0, 0.6);\n        border: 1px solid rgba(255, 255, 255, 0.2);\n        border-radius: 4px;\n        padding: 2px 6px;\n        font-size: 10px;\n        color: rgba(255, 255, 255, 0.7);\n        font-weight: 500;\n      }\n    }\n  }\n\n  /* Sub plan styles */\n  .sub-plan-content {\n    .sub-plan-header {\n      background: rgba(102, 126, 234, 0.1);\n      border: 1px solid rgba(102, 126, 234, 0.3);\n      border-radius: 6px;\n      padding: 12px;\n      margin-bottom: 12px;\n\n      .sub-plan-info {\n        display: flex;\n        margin-bottom: 8px;\n        font-size: 12px;\n\n        &:last-child {\n          margin-bottom: 0;\n        }\n\n        .label {\n          min-width: 80px;\n          font-weight: 600;\n          color: #888888;\n          flex-shrink: 0;\n        }\n\n        .value {\n          flex: 1;\n          color: #cccccc;\n          word-break: break-word;\n        }\n      }\n\n      .sub-plan-status {\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        padding-top: 8px;\n        border-top: 1px solid rgba(255, 255, 255, 0.1);\n\n        .status-icon {\n          font-size: 14px;\n\n          &.success {\n            color: #27ae60;\n          }\n\n          &.progress {\n            color: #3498db;\n          }\n        }\n\n        .status-text {\n          color: #cccccc;\n          font-size: 12px;\n          font-weight: 500;\n        }\n      }\n    }\n  }\n}\n\n.no-selection {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #666666;\n\n  .empty-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    color: #444444;\n  }\n\n  h3 {\n    margin: 0 0 8px 0;\n    font-size: 18px;\n    color: #888888;\n  }\n\n  p {\n    margin: 0;\n    font-size: 14px;\n    text-align: center;\n    max-width: 300px;\n    line-height: 1.5;\n  }\n}\n\n/* Scroll to bottom button */\n.scroll-to-bottom-btn {\n  position: fixed;\n  bottom: 40px;\n  right: 40px;\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  background: rgba(74, 144, 226, 0.9);\n  border: none;\n  color: white;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 18px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  transition: all 0.3s ease;\n  z-index: 100;\n\n  &:hover {\n    background: rgba(74, 144, 226, 1);\n    transform: translateY(-2px);\n    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);\n  }\n\n  &:active {\n    transform: translateY(0);\n  }\n}\n\n/* Scroll button transition animation */\n.scroll-button-enter-active,\n.scroll-button-leave-active {\n  transition: all 0.3s ease;\n}\n\n.scroll-button-enter-from,\n.scroll-button-leave-to {\n  opacity: 0;\n  transform: translateY(20px) scale(0.8);\n}\n\n/* File Browser Container */\n.file-browser-container {\n  height: 100%;\n  padding: 0;\n  overflow: hidden;\n}\n\n.no-plan-message {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n  color: rgba(255, 255, 255, 0.6);\n  gap: 24px;\n  padding: 40px 20px;\n  text-align: center;\n}\n\n.no-plan-message > .iconify {\n  font-size: 64px;\n  color: rgba(255, 255, 255, 0.3);\n}\n\n.message-content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 16px;\n  max-width: 300px;\n}\n\n.message-content h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.message-content p {\n  margin: 0;\n  font-size: 14px;\n  line-height: 1.5;\n  color: rgba(255, 255, 255, 0.6);\n}\n\n.tips {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 12px 16px;\n  background: rgba(103, 126, 234, 0.1);\n  border: 1px solid rgba(103, 126, 234, 0.2);\n  border-radius: 8px;\n  font-size: 12px;\n  color: rgba(103, 126, 234, 0.9);\n}\n\n.tips .iconify {\n  font-size: 14px;\n  flex-shrink: 0;\n}\n\n/* Tab styles */\n.preview-tabs {\n  display: flex;\n  gap: 0;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  padding: 4px;\n}\n\n.tab-item {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 7px 16px;\n  border-radius: 6px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 13px;\n  font-weight: 500;\n  min-width: 0;\n  flex: 1;\n  justify-content: center;\n  position: relative;\n}\n\n.tab-item:hover {\n  background: rgba(255, 255, 255, 0.08);\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.tab-item.active {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: #ffffff;\n  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.tab-item .iconify {\n  font-size: 16px;\n  flex-shrink: 0;\n}\n\n.tab-item span {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n/* Config Tab Styles */\n.config-tab-content {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  min-height: 0;\n  height: 100%;\n  overflow: hidden;\n}\n\n.config-container {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  overflow-y: auto;\n  padding: 20px;\n  gap: 16px;\n}\n\n.template-info-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 16px;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n\n  .template-info {\n    flex: 1;\n    min-width: 0;\n\n    h3 {\n      margin: 0 0 4px 0;\n      font-size: 14px;\n      font-weight: 600;\n      color: white;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n\n    .template-id {\n      font-size: 11px;\n      color: rgba(255, 255, 255, 0.5);\n    }\n  }\n\n  .back-to-list-btn {\n    width: 28px;\n    height: 28px;\n    background: transparent;\n    border: none;\n    border-radius: 4px;\n    color: rgba(255, 255, 255, 0.7);\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all 0.2s ease;\n\n    &:hover {\n      background: rgba(255, 255, 255, 0.1);\n      color: white;\n    }\n  }\n}\n\n.no-template-selected {\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  color: #666666;\n  padding: 40px 20px;\n\n  .action-buttons {\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    width: 100%;\n    max-width: 400px;\n  }\n\n  .new-task-btn {\n    width: 100%;\n    padding: 10px 16px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    border: none;\n    border-radius: 6px;\n    color: white;\n    font-size: 13px;\n    font-weight: 500;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    transition: all 0.2s ease;\n    white-space: nowrap;\n\n    &:hover {\n      transform: translateY(-1px);\n      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n    }\n  }\n\n  .import-description {\n    margin-top: 16px;\n    padding: 0 16px;\n    font-size: 12px;\n    line-height: 1.6;\n    color: rgba(255, 255, 255, 0.7);\n    text-align: center;\n    max-width: 400px;\n\n    .prompt-library-link {\n      color: #667eea;\n      text-decoration: none;\n      transition: color 0.2s ease;\n\n      &:hover {\n        color: #764ba2;\n        text-decoration: underline;\n      }\n    }\n  }\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"template-list-container\">\n    <div class=\"organization-section\">\n      <div class=\"organization-row\">\n        <div class=\"organization-selector\">\n          <label class=\"organization-label\">{{ $t('sidebar.organizationLabel') }}</label>\n          <select\n            :value=\"templateStore.organizationMethod\"\n            @change=\"handleOrganizationChange\"\n            class=\"organization-select\"\n          >\n            <option value=\"by_time\">{{ $t('sidebar.organizationByTime') }}</option>\n            <option value=\"by_abc\">{{ $t('sidebar.organizationByAbc') }}</option>\n            <option value=\"by_group_time\">{{ $t('sidebar.organizationByGroupTime') }}</option>\n            <option value=\"by_group_abc\">{{ $t('sidebar.organizationByGroupAbc') }}</option>\n          </select>\n        </div>\n        <div class=\"search-input-wrapper\">\n          <label class=\"search-label\">{{ $t('sidebar.searchLabel') }}</label>\n          <div class=\"search-input-container\">\n            <Icon icon=\"carbon:search\" width=\"16\" class=\"search-icon\" />\n            <input\n              v-model=\"searchKeyword\"\n              type=\"text\"\n              class=\"search-input\"\n              :placeholder=\"$t('sidebar.searchPlaceholder') || 'Search...'\"\n            />\n            <button\n              v-if=\"searchKeyword\"\n              class=\"search-clear-btn\"\n              @click=\"searchKeyword = ''\"\n              :title=\"$t('sidebar.clearSearch') || 'Clear search'\"\n            >\n              <Icon icon=\"carbon:close\" width=\"14\" />\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"sidebar-content-list\">\n      <!-- Loading state -->\n      <div v-if=\"templateStore.isLoading\" class=\"loading-state\">\n        <Icon icon=\"carbon:circle-dash\" width=\"20\" class=\"spinning\" />\n        <span>{{ $t('sidebar.loading') }}</span>\n      </div>\n\n      <!-- Error state -->\n      <div v-else-if=\"templateStore.errorMessage\" class=\"error-state\">\n        <Icon icon=\"carbon:warning\" width=\"20\" />\n        <span>{{ templateStore.errorMessage }}</span>\n        <button @click=\"templateStore.loadPlanTemplateList\" class=\"retry-btn\">\n          {{ $t('sidebar.retry') }}\n        </button>\n      </div>\n\n      <!-- Empty state -->\n      <div v-else-if=\"templateConfig.planTemplateList.value.length === 0\" class=\"empty-state\">\n        <Icon icon=\"carbon:document\" width=\"32\" />\n        <span>{{ $t('sidebar.noTemplates') }}</span>\n      </div>\n\n      <!-- Plan template list (grouped or ungrouped) -->\n      <template v-else>\n        <template\n          v-for=\"[groupName, templates] in filteredGroupedTemplates\"\n          :key=\"groupName || 'ungrouped'\"\n        >\n          <!-- Group header (only show for grouped methods) -->\n          <div\n            v-if=\"\n              (templateStore.organizationMethod === 'by_group_time' ||\n                templateStore.organizationMethod === 'by_group_abc') &&\n              templates.length > 0\n            \"\n            class=\"group-header\"\n            @click.prevent=\"handleToggleGroupCollapse(groupName)\"\n            :title=\"\n              getGroupCollapseState(groupName)\n                ? $t('sidebar.expandGroup')\n                : $t('sidebar.collapseGroup')\n            \"\n          >\n            <button\n              type=\"button\"\n              class=\"group-toggle-btn\"\n              @click.stop.prevent=\"handleToggleGroupCollapse(groupName)\"\n              :title=\"\n                getGroupCollapseState(groupName)\n                  ? $t('sidebar.expandGroup')\n                  : $t('sidebar.collapseGroup')\n              \"\n            >\n              <Icon\n                :icon=\"\n                  getGroupCollapseState(groupName) ? 'carbon:chevron-right' : 'carbon:chevron-down'\n                \"\n                width=\"14\"\n              />\n            </button>\n            <Icon icon=\"carbon:folder\" width=\"16\" />\n            <span class=\"group-name\">\n              {{\n                groupName === null || groupName === '' ? $t('sidebar.ungroupedMethods') : groupName\n              }}\n            </span>\n            <span class=\"group-count\">({{ templates.length }})</span>\n          </div>\n          <!-- Template items (hidden when group is collapsed) -->\n          <template\n            v-if=\"\n              !(\n                (templateStore.organizationMethod === 'by_group_time' ||\n                  templateStore.organizationMethod === 'by_group_abc') &&\n                getGroupCollapseState(groupName)\n              )\n            \"\n          >\n            <div\n              v-for=\"template in templates\"\n              :key=\"template.planTemplateId || 'unknown'\"\n              class=\"sidebar-content-list-item\"\n              :class=\"{\n                'sidebar-content-list-item-active':\n                  template.planTemplateId === templateConfig.currentPlanTemplateId.value,\n                'grouped-item':\n                  templateStore.organizationMethod === 'by_group_time' ||\n                  templateStore.organizationMethod === 'by_group_abc',\n              }\"\n              @click=\"handleSelectTemplate(template)\"\n            >\n              <div class=\"task-icon\">\n                <Icon icon=\"carbon:document\" width=\"20\" />\n              </div>\n              <div class=\"task-details\">\n                <div class=\"task-title\">{{ template.title || $t('sidebar.unnamedPlan') }}</div>\n              </div>\n              <div class=\"task-time\">\n                {{\n                  getRelativeTimeString(\n                    templateConfig.parseDateTime(template.updateTime || template.createTime)\n                  )\n                }}\n              </div>\n              <div class=\"task-actions\">\n                <button\n                  class=\"delete-task-btn\"\n                  :title=\"$t('sidebar.deleteTemplate')\"\n                  @click.stop=\"showDeleteConfirm(template)\"\n                >\n                  <Icon icon=\"carbon:close\" width=\"16\" />\n                </button>\n              </div>\n            </div>\n          </template>\n        </template>\n      </template>\n    </div>\n  </div>\n\n  <!-- Delete Confirmation Modal -->\n  <Teleport to=\"body\">\n    <Transition name=\"modal\">\n      <div v-if=\"showDeleteConfirmModal\" class=\"modal-overlay\" @click=\"cancelDelete\">\n        <div class=\"confirm-modal\" @click.stop>\n          <div class=\"confirm-header\">\n            <Icon icon=\"carbon:warning\" class=\"warning-icon\" />\n            <h3>{{ $t('sidebar.deleteConfirm') }}</h3>\n          </div>\n          <div class=\"confirm-content\">\n            <p>\n              {{\n                $t('sidebar.deleteConfirmMessage', { templateName: templateToDelete?.title || '' })\n              }}\n            </p>\n          </div>\n          <div class=\"confirm-actions\">\n            <button class=\"confirm-btn cancel-btn\" @click=\"cancelDelete\">\n              {{ $t('common.cancel') }}\n            </button>\n            <button\n              class=\"confirm-btn delete-btn\"\n              @click=\"handleDeleteTemplate\"\n              :disabled=\"deleting\"\n            >\n              <Icon :icon=\"deleting ? 'carbon:loading' : 'carbon:trash-can'\" />\n              {{ $t('common.delete') }}\n            </button>\n          </div>\n        </div>\n      </div>\n    </Transition>\n  </Teleport>\n</template>\n\n<script setup lang=\"ts\">\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { useRightPanelSingleton } from '@/composables/useRightPanel'\nimport { templateStore, type TemplateStoreType } from '@/stores/templateStore'\nimport type { PlanTemplateConfigVO } from '@/types/plan-template'\nimport { Icon } from '@iconify/vue'\nimport { computed, ref, watch } from 'vue'\nimport { useI18n } from 'vue-i18n'\nimport { useToast } from '@/plugins/useToast'\n\nconst { t } = useI18n()\n\n// Template config management\nconst templateConfig = usePlanTemplateConfigSingleton()\n\n// Right panel management\nconst rightPanel = useRightPanelSingleton()\n\n// Toast for notifications\nconst toast = useToast()\n\n// Search functionality\nconst searchKeyword = ref('')\n\n// Delete confirmation state\nconst showDeleteConfirmModal = ref(false)\nconst templateToDelete = ref<PlanTemplateConfigVO | null>(null)\nconst deleting = ref(false)\n\n// Emits\nconst emit = defineEmits<{\n  templateSelected: [template: PlanTemplateConfigVO]\n}>()\n\n// Handle organization method change\nconst handleOrganizationChange = (event: Event) => {\n  const target = event.target as HTMLSelectElement\n  templateStore.setOrganizationMethod(\n    target.value as 'by_time' | 'by_abc' | 'by_group_time' | 'by_group_abc'\n  )\n}\n\n// Utility functions\nconst getRelativeTimeString = (date: Date): string => {\n  // Check if date is valid\n  if (isNaN(date.getTime())) {\n    console.warn('Invalid date received:', date)\n    return t('time.unknown')\n  }\n\n  const now = new Date()\n  const diffMs = now.getTime() - date.getTime()\n  const diffMinutes = Math.floor(diffMs / 60000)\n  const diffHours = Math.floor(diffMs / 3600000)\n  const diffDays = Math.floor(diffMs / 86400000)\n\n  if (diffMinutes < 1) return t('time.now')\n  if (diffMinutes < 60) return t('time.minuteAgo', { count: diffMinutes })\n  if (diffHours < 24) return t('time.hourAgo', { count: diffHours })\n  if (diffDays < 30) return t('time.dayAgo', { count: diffDays })\n\n  return date.toLocaleDateString('zh-CN')\n}\n\n// Filter templates based on search keyword\nconst filteredGroupedTemplates = computed(() => {\n  // Access planTemplateList directly to ensure reactivity\n  // This ensures Vue tracks changes to the list\n  void templateConfig.planTemplateList.value\n\n  const keyword = searchKeyword.value.trim().toLowerCase()\n\n  // Get grouped templates from templateStore\n  const grouped = (templateStore as TemplateStoreType).groupedTemplates\n\n  if (!keyword) {\n    return grouped\n  }\n\n  const filtered = new Map<string | null, PlanTemplateConfigVO[]>()\n\n  // Iterate through all groups\n  for (const [groupName, templates] of grouped) {\n    const matchingTemplates: PlanTemplateConfigVO[] = []\n\n    for (const template of templates) {\n      // Search in title\n      const title = (template.title || '').toLowerCase()\n\n      if (title.includes(keyword)) {\n        matchingTemplates.push(template)\n      }\n    }\n\n    // Only add groups that have matching templates\n    if (matchingTemplates.length > 0) {\n      filtered.set(groupName, matchingTemplates)\n    }\n  }\n\n  return filtered\n})\n\n// Auto-expand groups that contain matching items when searching\nwatch(searchKeyword, newKeyword => {\n  // Access planTemplateList to ensure reactivity\n  void templateConfig.planTemplateList.value\n\n  const keyword = newKeyword.trim().toLowerCase()\n  if (!keyword) {\n    return\n  }\n\n  // Only auto-expand for grouped organization methods\n  if (\n    templateStore.organizationMethod !== 'by_group_time' &&\n    templateStore.organizationMethod !== 'by_group_abc'\n  ) {\n    return\n  }\n\n  // Expand groups that contain matches\n  const grouped = (templateStore as TemplateStoreType).groupedTemplates\n  for (const [groupName, templates] of grouped) {\n    let hasMatch = false\n    for (const template of templates) {\n      const title = (template.title || '').toLowerCase()\n      if (title.includes(keyword)) {\n        hasMatch = true\n        break\n      }\n    }\n\n    if (hasMatch && templateStore.isGroupCollapsed(groupName)) {\n      templateStore.toggleGroupCollapse(groupName)\n    }\n  }\n})\n\n// Get group collapse state - helper function to access reactive property directly\nconst getGroupCollapseState = (groupName: string | null): boolean => {\n  const key = groupName ?? 'null'\n  // Directly access reactive object property so Vue can track it\n  return templateStore.groupCollapseState[key] ?? false\n}\n\n// Handle group collapse toggle\nconst handleToggleGroupCollapse = (groupName: string | null) => {\n  templateStore.toggleGroupCollapse(groupName)\n}\n\n// Handle select template\nconst handleSelectTemplate = async (template: PlanTemplateConfigVO) => {\n  // Switch to 'config' tab immediately when template is clicked\n  // This ensures immediate feedback and prevents the need for double-click\n  rightPanel.setActiveTab('config')\n\n  await templateStore.selectTemplate(template)\n\n  // Load template config using singleton\n  if (template.planTemplateId) {\n    await templateConfig.load(template.planTemplateId)\n    // Reset modification flag when loading new template\n    templateStore.hasTaskRequirementModified = false\n  } else {\n    // Reset config if no template ID\n    templateConfig.reset()\n    templateStore.hasTaskRequirementModified = false\n  }\n\n  // Note: No need to call setActiveTab again after nextTick\n  // The initial call at the beginning is sufficient since activeTab is reactive\n  // and will be maintained throughout the async operations\n\n  emit('templateSelected', template)\n}\n\n/**\n * Show delete confirmation dialog\n * @param template Template to delete\n */\nconst showDeleteConfirm = (template: PlanTemplateConfigVO) => {\n  templateToDelete.value = template\n  showDeleteConfirmModal.value = true\n}\n\n/**\n * Handle template deletion\n */\nconst handleDeleteTemplate = async () => {\n  if (!templateToDelete.value) return\n\n  deleting.value = true\n  try {\n    await templateStore.deleteTemplate(templateToDelete.value)\n    showDeleteConfirmModal.value = false\n    templateToDelete.value = null\n    toast.success(t('sidebar.deleteSuccess') || 'Template deleted successfully')\n  } catch (error) {\n    console.error('Failed to delete template:', error)\n    toast.error(\n      t('sidebar.deleteFailed') ||\n        `Delete failed: ${error instanceof Error ? error.message : String(error)}`\n    )\n  } finally {\n    deleting.value = false\n  }\n}\n\n/**\n * Cancel delete operation\n */\nconst cancelDelete = () => {\n  showDeleteConfirmModal.value = false\n  templateToDelete.value = null\n}\n</script>\n\n<style scoped>\n.template-list-container {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  overflow: hidden;\n  padding: 10px 10px;\n}\n\n.organization-section {\n  margin-bottom: 16px;\n  padding-right: 12px;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.organization-row {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  flex-wrap: wrap;\n}\n\n.organization-selector {\n  flex: 0 0 auto;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.organization-label {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.7);\n  white-space: nowrap;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n}\n\n.organization-select {\n  width: 20ch;\n  max-width: 20ch;\n  padding: 6px 10px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: white;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.organization-select:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.organization-select:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.organization-select option {\n  background: #1a1a1a;\n  color: white;\n  white-space: normal;\n}\n\n.search-input-wrapper {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  min-width: 0;\n}\n\n.search-label {\n  font-size: 12px;\n  color: rgba(255, 255, 255, 0.7);\n  white-space: nowrap;\n  margin: 0;\n  padding: 0;\n  line-height: 1;\n}\n\n.search-input-container {\n  flex: 1;\n  position: relative;\n  display: flex;\n  align-items: center;\n  min-width: 0;\n}\n\n.search-icon {\n  position: absolute;\n  left: 10px;\n  color: rgba(255, 255, 255, 0.5);\n  pointer-events: none;\n  z-index: 1;\n}\n\n.search-input {\n  width: 100%;\n  padding: 6px 10px 6px 32px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  color: white;\n  font-size: 12px;\n  transition: all 0.2s ease;\n}\n\n.search-input::placeholder {\n  color: rgba(255, 255, 255, 0.4);\n}\n\n.search-input:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.search-clear-btn {\n  position: absolute;\n  right: 6px;\n  width: 20px;\n  height: 20px;\n  background: transparent;\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.5);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  z-index: 1;\n}\n\n.search-clear-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.sidebar-content-list {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  min-height: 0;\n  overflow-y: auto;\n  padding-right: 12px;\n  padding-bottom: 40px;\n}\n\n.loading-state,\n.error-state,\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 32px 16px;\n  color: rgba(255, 255, 255, 0.6);\n  font-size: 14px;\n  text-align: center;\n  gap: 12px;\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n.retry-btn {\n  padding: 8px 16px;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 4px;\n  color: white;\n  cursor: pointer;\n  font-size: 12px;\n  transition: background-color 0.2s ease;\n}\n\n.retry-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.group-header {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  padding: 8px 12px;\n  margin-top: 12px;\n  margin-bottom: 6px;\n  color: rgba(255, 255, 255, 0.8);\n  font-size: 13px;\n  font-weight: 600;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n  cursor: pointer;\n  user-select: none;\n  transition: background-color 0.2s ease;\n  position: relative;\n  z-index: 1;\n}\n\n.group-header:hover {\n  background: rgba(255, 255, 255, 0.05);\n}\n\n.group-header:first-child {\n  margin-top: 0;\n}\n\n.group-toggle-btn {\n  width: 20px;\n  height: 20px;\n  background: transparent;\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  flex-shrink: 0;\n  pointer-events: auto;\n  position: relative;\n  z-index: 2;\n}\n\n.group-toggle-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.group-toggle-btn:active {\n  transform: scale(0.95);\n}\n\n.group-name {\n  flex: 1;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.group-count {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.5);\n  flex-shrink: 0;\n}\n\n.sidebar-content-list-item {\n  display: flex;\n  align-items: flex-start;\n  padding: 8px;\n  margin-bottom: 8px;\n  background: rgba(255, 255, 255, 0.05);\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  position: relative;\n}\n\n.sidebar-content-list-item.grouped-item {\n  margin-left: 16px;\n  border-left: 2px solid rgba(102, 126, 234, 0.3);\n}\n\n.sidebar-content-list-item:hover {\n  background: rgba(255, 255, 255, 0.1);\n  border-color: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n\n.sidebar-content-list-item.sidebar-content-list-item-active {\n  border: 2px solid #667eea;\n  background: rgba(102, 126, 234, 0.1);\n}\n\n.task-icon {\n  margin-right: 12px;\n  color: #667eea;\n  flex-shrink: 0;\n  margin-top: 2px;\n}\n\n.task-details {\n  flex: 1;\n  min-width: 0;\n}\n\n.task-title {\n  font-size: 14px;\n  font-weight: 600;\n  color: white;\n  margin-bottom: 4px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n\n.task-time {\n  font-size: 11px;\n  color: rgba(255, 255, 255, 0.5);\n  margin-left: 8px;\n  flex-shrink: 0;\n  position: absolute;\n  top: 12px;\n  right: 40px;\n}\n\n.task-actions {\n  display: flex;\n  align-items: center;\n  margin-left: 8px;\n  flex-shrink: 0;\n}\n\n.delete-task-btn {\n  width: 24px;\n  height: 24px;\n  background: transparent;\n  border: none;\n  border-radius: 4px;\n  color: rgba(255, 255, 255, 0.5);\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  position: absolute;\n  top: 12px;\n  right: 12px;\n}\n\n.delete-task-btn:hover {\n  background: rgba(255, 0, 0, 0.2);\n  color: #ff6b6b;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Delete confirmation modal styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  backdrop-filter: blur(4px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.confirm-modal {\n  background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.15));\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 16px;\n  width: 90%;\n  max-width: 480px;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);\n  overflow: hidden;\n}\n\n.confirm-header {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 24px 24px 16px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.warning-icon {\n  font-size: 24px;\n  color: #f59e0b;\n}\n\n.confirm-header h3 {\n  margin: 0;\n  font-size: 18px;\n  font-weight: 600;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.confirm-content {\n  padding: 20px 24px;\n}\n\n.confirm-content p {\n  margin: 0;\n  color: rgba(255, 255, 255, 0.8);\n  line-height: 1.6;\n  font-size: 14px;\n}\n\n.confirm-actions {\n  display: flex;\n  gap: 12px;\n  padding: 16px 24px 24px;\n  justify-content: flex-end;\n}\n\n.confirm-btn {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  padding: 10px 16px;\n  border-radius: 8px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s;\n  border: 1px solid transparent;\n  min-width: 80px;\n  justify-content: center;\n}\n\n.confirm-btn.cancel-btn {\n  background: rgba(156, 163, 175, 0.1);\n  border-color: rgba(156, 163, 175, 0.2);\n  color: #9ca3af;\n}\n\n.confirm-btn.cancel-btn:hover {\n  background: rgba(156, 163, 175, 0.2);\n  border-color: rgba(156, 163, 175, 0.3);\n}\n\n.confirm-btn.delete-btn {\n  background: rgba(239, 68, 68, 0.1);\n  border-color: rgba(239, 68, 68, 0.2);\n  color: #ef4444;\n}\n\n.confirm-btn.delete-btn:hover:not(:disabled) {\n  background: rgba(239, 68, 68, 0.2);\n  border-color: rgba(239, 68, 68, 0.3);\n}\n\n.confirm-btn.delete-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n/* Modal transition animations */\n.modal-enter-active,\n.modal-leave-active {\n  transition: all 0.3s ease;\n}\n\n.modal-enter-from,\n.modal-leave-to {\n  opacity: 0;\n}\n\n.modal-enter-from .confirm-modal,\n.modal-leave-to .confirm-modal {\n  transform: scale(0.9) translateY(-20px);\n}\n\n.modal-enter-to .confirm-modal,\n.modal-leave-from .confirm-modal {\n  transform: scale(1) translateY(0);\n}\n</style>\n","<!--\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n-->\n<template>\n  <div class=\"sidebar-wrapper\" :style=\"{ width: props.width + '%' }\">\n    <div class=\"sidebar-content\">\n      <div class=\"sidebar-content-header\">\n        <div class=\"sidebar-content-title\">{{ $t('sidebar.title') }}</div>\n        <button class=\"new-task-btn\" @click=\"handleCreateNewTemplate\">\n          <Icon icon=\"carbon:add\" width=\"16\" />\n          {{ $t('sidebar.newPlan') }}\n        </button>\n      </div>\n\n      <!-- Template List Content -->\n      <div class=\"tab-content\">\n        <TemplateList />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\n// Define component name to satisfy Vue linting rules\ndefineOptions({\n  name: 'SidebarPanel',\n})\n\nimport { useAvailableToolsSingleton } from '@/composables/useAvailableTools'\nimport { usePlanTemplateConfigSingleton } from '@/composables/usePlanTemplateConfig'\nimport { useRightPanelSingleton } from '@/composables/useRightPanel'\nimport { sidebarStore } from '@/stores/sidebar'\nimport { templateStore } from '@/stores/templateStore'\nimport { Icon } from '@iconify/vue'\nimport { onMounted } from 'vue'\nimport TemplateList from './TemplateList.vue'\n\n// Props\nconst props = defineProps<{\n  width: number\n}>()\n\n// Available tools management\nconst availableToolsStore = useAvailableToolsSingleton()\n\n// Template config management\nconst templateConfig = usePlanTemplateConfigSingleton()\n\n// Right panel management for tab switching\nconst rightPanel = useRightPanelSingleton()\n\n// Handle create new template\nconst handleCreateNewTemplate = async () => {\n  // Use default plan type or get from templateConfig\n  const planType = templateConfig.getPlanType() || 'dynamic_agent'\n  await templateStore.createNewTemplate(planType)\n\n  // Load template config for new template\n  const newTemplate = templateConfig.selectedTemplate.value\n  if (newTemplate) {\n    templateConfig.reset()\n    templateConfig.setPlanType(newTemplate.planType || 'dynamic_agent')\n    if (newTemplate.planTemplateId) {\n      templateConfig.setPlanTemplateId(newTemplate.planTemplateId)\n    }\n    templateConfig.setTitle(newTemplate.title || '')\n  }\n\n  // Switch to 'config' tab to show Func-Agent configuration\n  rightPanel.setActiveTab('config')\n\n  // Reload available tools to ensure fresh tool list\n  console.log('[Sidebar]  Reloading available tools for new template')\n  await availableToolsStore.loadAvailableTools()\n}\n\n// Lifecycle\nonMounted(async () => {\n  await templateStore.loadPlanTemplateList()\n  availableToolsStore.loadAvailableTools() // Load available tools on sidebar mount\n})\n\n// Expose methods for parent component to call\ndefineExpose({\n  loadPlanTemplateList: templateStore.loadPlanTemplateList,\n  toggleSidebar: sidebarStore.toggleSidebar,\n})\n</script>\n\n<style scoped>\n.sidebar-wrapper {\n  position: relative;\n  height: 100vh;\n  background: rgba(255, 255, 255, 0.05);\n  border-right: 1px solid rgba(255, 255, 255, 0.1);\n  transition: width 0.1s ease;\n  overflow: hidden;\n  display: flex;\n}\n\n.sidebar-content {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  transition: all 0.3s ease-in-out;\n  flex: 1;\n\n  .sidebar-content-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 0px;\n    padding: 12px 10px;\n    border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n    overflow: hidden;\n\n    .sidebar-content-title {\n      font-size: 16px;\n      font-weight: 600;\n      color: #ffffff;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      white-space: nowrap;\n    }\n\n    .new-task-btn {\n      margin: 0px 14px;\n      padding: 7px 14px;\n      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n      border: none;\n      border-radius: 6px;\n      color: white;\n      font-size: 13px;\n      font-weight: 500;\n      cursor: pointer;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      gap: 6px;\n      transition: all 0.2s ease;\n      white-space: nowrap;\n      flex-shrink: 0;\n\n      &:hover {\n        transform: translateY(-1px);\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n      }\n    }\n  }\n\n  .tab-content {\n    display: flex;\n    flex-direction: column;\n    flex: 1;\n    min-height: 0;\n    overflow: hidden;\n  }\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n/* Copy Plan Modal Styles */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background: #1a1a1a;\n  border-radius: 8px;\n  padding: 0;\n  min-width: 400px;\n  max-width: 500px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n}\n\n.modal-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: white;\n  font-size: 16px;\n  font-weight: 600;\n}\n\n.close-btn {\n  background: transparent;\n  border: none;\n  color: rgba(255, 255, 255, 0.7);\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.modal-body {\n  padding: 20px;\n}\n\n.modal-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n  padding: 16px 20px;\n  border-top: 1px solid rgba(255, 255, 255, 0.1);\n}\n\n.form-row {\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n}\n\n.form-label {\n  font-size: 14px;\n  font-weight: 500;\n  color: rgba(255, 255, 255, 0.9);\n}\n\n.form-input {\n  padding: 10px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  font-size: 13px;\n  transition: all 0.2s ease;\n}\n\n.form-input:focus {\n  outline: none;\n  border-color: #667eea;\n  box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);\n}\n\n.btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-secondary {\n  background: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background: rgba(255, 255, 255, 0.2);\n}\n\n.btn-primary {\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background: linear-gradient(135deg, #5566dd 0%, #653b91 100%);\n  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);\n}\n\n.spinning {\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\n</style>\n","/*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MemoryApiService } from '@/api/memory-api-service'\nimport { useMessageDialogSingleton } from '@/composables/useMessageDialog'\nimport { usePlanExecutionSingleton } from '@/composables/usePlanExecution'\nimport { useToast } from '@/composables/useToast'\nimport { memoryStore } from '@/stores/memory'\nimport type { PlanExecutionRecord } from '@/types/plan-execution-record'\nimport { useI18n } from 'vue-i18n'\n\n/**\n * Composable for managing conversation history\n * Handles loading and restoring conversation history from backend\n */\nexport function useConversationHistory() {\n  const messageDialog = useMessageDialogSingleton()\n  const planExecution = usePlanExecutionSingleton()\n  const { showToast } = useToast()\n  const { t } = useI18n()\n\n  /**\n   * Convert API record to plan execution record format\n   */\n  const convertApiRecordToPlanExecutionRecord = (\n    record: PlanExecutionRecord\n  ): Partial<PlanExecutionRecord> => {\n    const planExecutionRecord: Partial<PlanExecutionRecord> = {\n      currentPlanId: record.currentPlanId,\n      status: record.completed ? 'completed' : 'running',\n    }\n\n    // Add optional fields if they exist\n    if (record.rootPlanId) {\n      planExecutionRecord.rootPlanId = record.rootPlanId\n    }\n    if (record.summary) {\n      planExecutionRecord.summary = record.summary\n    }\n    if (record.completed !== undefined) {\n      planExecutionRecord.completed = record.completed\n    }\n    if (record.agentExecutionSequence) {\n      planExecutionRecord.agentExecutionSequence = record.agentExecutionSequence\n    }\n\n    return planExecutionRecord\n  }\n\n  /**\n   * Parse date from backend (handles LocalDateTime format from Java)\n   * Java LocalDateTimeSerializer can serialize as:\n   * - ISO-8601 string: \"2025-01-17T10:30:00\" or \"2025-01-17T10:30:00.123\"\n   * - Array format: [2025, 1, 17, 10, 30, 0] (if WRITE_DATES_AS_TIMESTAMPS is enabled)\n   * @param dateValue Date value from backend (string, array, or number)\n   * @returns Date object or current date if parsing fails\n   */\n  const parseBackendDate = (dateValue: string | number[] | number | null | undefined): Date => {\n    if (!dateValue) {\n      console.warn('[useConversationHistory] Date value is null/undefined, using current time')\n      return new Date()\n    }\n\n    try {\n      // Handle array format: [year, month, day, hour, minute, second, nanosecond]\n      if (Array.isArray(dateValue)) {\n        const [year, month, day, hour = 0, minute = 0, second = 0, nanosecond = 0] = dateValue\n        const date = new Date(\n          year,\n          month - 1, // Month is 0-indexed in JavaScript\n          day,\n          hour,\n          minute,\n          second,\n          Math.floor(nanosecond / 1000000) // Convert nanoseconds to milliseconds\n        )\n        if (!isNaN(date.getTime())) {\n          return date\n        }\n        console.warn('[useConversationHistory] Failed to parse date array:', dateValue)\n        return new Date()\n      }\n\n      // Handle string format\n      if (typeof dateValue === 'string') {\n        // First, try parsing as-is (works in most modern browsers for ISO format)\n        let date = new Date(dateValue)\n\n        // Check if date is valid\n        if (!isNaN(date.getTime())) {\n          return date\n        }\n\n        // If parsing failed, try manual parsing of ISO format\n        // Format: YYYY-MM-DDTHH:mm:ss or YYYY-MM-DDTHH:mm:ss.SSS\n        const isoMatch = dateValue.match(\n          /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d+))?$/\n        )\n        if (isoMatch) {\n          const [, year, month, day, hour, minute, second, millis] = isoMatch\n          date = new Date(\n            parseInt(year),\n            parseInt(month) - 1, // Month is 0-indexed\n            parseInt(day),\n            parseInt(hour),\n            parseInt(minute),\n            parseInt(second),\n            millis ? parseInt(millis.substring(0, 3)) : 0 // Only use first 3 digits of milliseconds\n          )\n          if (!isNaN(date.getTime())) {\n            return date\n          }\n        }\n\n        // Try adding timezone if missing\n        if (!dateValue.includes('Z') && !dateValue.includes('+') && !dateValue.includes('-', 10)) {\n          date = new Date(dateValue + 'Z')\n          if (!isNaN(date.getTime())) {\n            return date\n          }\n        }\n\n        console.warn('[useConversationHistory] Failed to parse date string:', dateValue)\n        return new Date()\n      }\n\n      // Handle number (timestamp in milliseconds or seconds)\n      if (typeof dateValue === 'number') {\n        // If number is less than 13 digits, assume it's in seconds\n        const timestamp = dateValue.toString().length < 13 ? dateValue * 1000 : dateValue\n        const date = new Date(timestamp)\n        if (!isNaN(date.getTime())) {\n          return date\n        }\n        console.warn('[useConversationHistory] Failed to parse date number:', dateValue)\n        return new Date()\n      }\n\n      // Unknown format\n      console.warn('[useConversationHistory] Unknown date format:', dateValue, typeof dateValue)\n      return new Date()\n    } catch (error) {\n      console.warn('[useConversationHistory] Error parsing date:', dateValue, error)\n      return new Date()\n    }\n  }\n\n  /**\n   * Process and add a single history record to the dialog\n   * Each history record should create its own dialog round to maintain proper structure\n   */\n  const processHistoryRecord = (record: PlanExecutionRecord): void => {\n    if (!record) return\n\n    // Debug: Log the actual date values before parsing\n    console.log('[useConversationHistory] Processing record:', {\n      userRequest: record.userRequest,\n      startTime: record.startTime,\n      startTimeType: typeof record.startTime,\n      endTime: record.endTime,\n      endTimeType: typeof record.endTime,\n    })\n\n    // Create a new dialog for this history record (each round gets its own dialog)\n    // Note: createDialog will automatically set conversationId if conversationId.value is set\n    // But since we're loading history, conversationId.value might not be set yet\n    // So we'll create the dialog and then manually set conversationId on it\n    const dialogTitle = record.userRequest || record.title || 'History Round'\n    const historyDialog = messageDialog.createDialog(dialogTitle)\n\n    // Set conversationId and planId on the dialog if available\n    // This ensures the dialog is properly linked to the conversation\n    const conversationId = memoryStore.getConversationId()\n    if (conversationId) {\n      const dialog = messageDialog.getDialog(historyDialog.id)\n      if (dialog) {\n        // Manually set conversationId on the dialog\n        // TypeScript might complain, but this is necessary for history loading\n        ;(dialog as { conversationId?: string }).conversationId = conversationId\n        if (record.rootPlanId) {\n          ;(dialog as { planId?: string }).planId = record.rootPlanId\n        }\n        console.log(\n          '[useConversationHistory] Set conversationId on history dialog:',\n          historyDialog.id,\n          conversationId\n        )\n      }\n    }\n\n    // Add user message (the original query) to the new dialog\n    if (record.userRequest && record.startTime) {\n      const parsedDate = parseBackendDate(record.startTime)\n      console.log('[useConversationHistory] Parsed date:', {\n        original: record.startTime,\n        parsed: parsedDate,\n        parsedISO: parsedDate.toISOString(),\n        isValid: !isNaN(parsedDate.getTime()),\n      })\n\n      const userMessage = {\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        type: 'user' as const,\n        content: record.userRequest,\n        timestamp: parsedDate,\n        isStreaming: false,\n      }\n      messageDialog.addMessageToDialog(historyDialog.id, userMessage)\n    }\n\n    // Add assistant message (the result/summary) to the same dialog\n    if (record.currentPlanId) {\n      const assistantContent =\n        record.summary || record.result || record.message || 'Execution completed'\n\n      // Convert API record to plan execution record format\n      const planExecutionRecord = convertApiRecordToPlanExecutionRecord(record)\n\n      const assistantMessage = {\n        id: `msg_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        type: 'assistant' as const,\n        content: assistantContent,\n        timestamp:\n          record.endTime && record.endTime\n            ? parseBackendDate(record.endTime)\n            : record.startTime\n              ? parseBackendDate(record.startTime)\n              : new Date(),\n        isStreaming: false,\n        planExecution: planExecutionRecord as PlanExecutionRecord,\n      }\n      messageDialog.addMessageToDialog(historyDialog.id, assistantMessage)\n\n      // Store the plan record in the plan execution manager cache for future reference\n      if (record.rootPlanId) {\n        planExecution.setCachedPlanRecord(\n          record.rootPlanId,\n          planExecutionRecord as PlanExecutionRecord\n        )\n      }\n    }\n  }\n\n  /**\n   * Load conversation history from backend and restore it to the dialog\n   * @param conversationId The conversation ID to load\n   * @param clearMessages Whether to clear existing messages before loading (default: false)\n   * @param showErrorToast Whether to show error toast on failure (default: true)\n   * @returns Promise that resolves when history is loaded\n   */\n  const loadConversationHistory = async (\n    conversationId: string,\n    clearMessages: boolean = false,\n    showErrorToast: boolean = true\n  ): Promise<void> => {\n    if (!conversationId) {\n      console.warn('[useConversationHistory] Cannot load history: conversationId is empty')\n      return\n    }\n\n    try {\n      // Clear current chat if requested\n      if (clearMessages) {\n        messageDialog.clearMessages()\n      }\n\n      // Set the conversation ID in memory store\n      memoryStore.setConversationId(conversationId)\n\n      // Also ensure conversationId.value is set in useMessageDialog\n      // This is needed so that createDialog can automatically link new dialogs to the conversation\n      // and so that the messages computed property can merge messages from all dialogs\n      messageDialog.setConversationId(conversationId)\n\n      // Fetch conversation history from backend\n      const historyRecords = await MemoryApiService.getConversationHistory(conversationId)\n      console.log('[useConversationHistory] Loaded conversation history:', historyRecords)\n\n      // Debug: Log date formats to help diagnose parsing issues\n      if (historyRecords.length > 0) {\n        const firstRecord = historyRecords[0]\n        console.log('[useConversationHistory] Sample date formats:', {\n          startTime: firstRecord.startTime,\n          endTime: firstRecord.endTime,\n          startTimeType: typeof firstRecord.startTime,\n        })\n      }\n\n      // Process each record\n      for (const record of historyRecords) {\n        processHistoryRecord(record)\n      }\n\n      console.log(\n        '[useConversationHistory] Successfully loaded conversation history with',\n        historyRecords.length,\n        'dialog rounds'\n      )\n    } catch (error) {\n      console.error('[useConversationHistory] Failed to load conversation history:', error)\n      if (showErrorToast) {\n        showToast(t('memory.loadHistoryFailed'), 'error')\n      }\n      throw error\n    }\n  }\n\n  /**\n   * Restore conversation history on page load (silent mode - no error toast)\n   * @param conversationId The conversation ID to restore\n   * @returns Promise that resolves when history is restored\n   */\n  const restoreConversationHistory = async (conversationId: string): Promise<void> => {\n    return loadConversationHistory(conversationId, false, false)\n  }\n\n  return {\n    loadConversationHistory,\n    restoreConversationHistory,\n    processHistoryRecord,\n  }\n}\n\n// Singleton instance for global use\nlet singletonInstance: ReturnType<typeof useConversationHistory> | null = null\n\n/**\n * Get or create singleton instance of useConversationHistory\n */\nexport function useConversationHistorySingleton() {\n  if (!singletonInstance) {\n    singletonInstance = useConversationHistory()\n  }\n  return singletonInstance\n}\n","<!--\n  /*\n * Copyright 2025 the original author or authors.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n-->\n\n<template>\n  <div class=\"direct-page\">\n    <!-- Branding Header -->\n    <header class=\"branding-header\">\n      <div class=\"branding-content\">\n        <div class=\"branding-logo\">\n          <img src=\"/Java-AI.svg\" alt=\"Lynxe\" class=\"java-logo\" />\n          <h1>Lynxe</h1>\n        </div>\n        <div class=\"branding-actions\">\n          <LanguageSwitcher />\n          <button class=\"back-button\" @click=\"goBack\">\n            <Icon icon=\"carbon:arrow-left\" />\n          </button>\n          <button class=\"config-button\" @click=\"handleConfig\" :title=\"$t('direct.configuration')\">\n            <Icon icon=\"carbon:settings-adjust\" width=\"20\" />\n          </button>\n        </div>\n      </div>\n    </header>\n    <div class=\"direct-chat\">\n      <Sidebar ref=\"sidebarRef\" :width=\"sidebarWidth\" />\n      <!-- Sidebar Resizer -->\n      <div\n        class=\"panel-resizer\"\n        @mousedown=\"startSidebarResize\"\n        @dblclick=\"resetSidebarWidth\"\n        :title=\"$t('sidebar.resizeHint')\"\n      >\n        <div class=\"resizer-line\"></div>\n      </div>\n      <!-- Left Panel - Config/Preview (RightPanel component) -->\n      <RightPanel\n        ref=\"rightPanelRef\"\n        :style=\"{ width: 100 - sidebarWidth - leftPanelWidth + '%' }\"\n        :current-root-plan-id=\"currentRootPlanId\"\n      />\n\n      <!-- Resizer -->\n      <div\n        class=\"panel-resizer\"\n        @mousedown=\"startResize\"\n        @dblclick=\"resetPanelSize\"\n        :title=\"$t('direct.panelResizeHint')\"\n      >\n        <div class=\"resizer-line\"></div>\n      </div>\n\n      <!-- Right Panel - Chat -->\n      <div class=\"left-panel\" :style=\"{ width: leftPanelWidth + '%' }\">\n        <div class=\"chat-header\">\n          <h2>{{ $t('conversation') }}</h2>\n          <div class=\"header-actions\">\n            <button class=\"config-button\" @click=\"newChat\" :title=\"$t('memory.newChat')\">\n              <Icon icon=\"carbon:add\" width=\"20\" />\n            </button>\n            <button\n              class=\"cron-task-btn\"\n              @click=\"memoryStore.toggleSidebar()\"\n              :title=\"$t('memory.selectMemory')\"\n            >\n              <Icon icon=\"carbon:calendar\" width=\"20\" />\n            </button>\n          </div>\n        </div>\n\n        <!-- Chat Container -->\n        <div class=\"chat-content\">\n          <ChatContainer @step-selected=\"handleStepSelected\" />\n        </div>\n\n        <!-- Input Area -->\n        <InputArea :key=\"$i18n.locale\" :initial-value=\"prompt\" />\n      </div>\n    </div>\n\n    <!-- Memory Modal -->\n    <Memory @memory-selected=\"memorySelected\" />\n\n    <!-- Toast notification component -->\n    <div v-if=\"toast.show\" class=\"message-toast\" :class=\"toast.type\">\n      <div class=\"message-content\">\n        <span>{{ toast.text }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport ChatContainer from '@/components/chat/ChatContainer.vue'\nimport InputArea from '@/components/input/InputArea.vue'\nimport LanguageSwitcher from '@/components/language-switcher/LanguageSwitcher.vue'\nimport Memory from '@/components/memory/Memory.vue'\nimport RightPanel from '@/components/right-panel/RightPanel.vue'\nimport Sidebar from '@/components/sidebar/Sidebar.vue'\nimport { useConversationHistorySingleton } from '@/composables/useConversationHistory'\nimport { useMessageDialogSingleton } from '@/composables/useMessageDialog'\nimport { usePlanExecutionSingleton } from '@/composables/usePlanExecution'\nimport { useToast } from '@/composables/useToast'\nimport { memoryStore } from '@/stores/memory'\nimport { useTaskStore } from '@/stores/task'\nimport { templateStore } from '@/stores/templateStore'\nimport { Icon } from '@iconify/vue'\nimport { nextTick, onMounted, onUnmounted, ref, watch } from 'vue'\nimport { useRoute, useRouter } from 'vue-router'\n\n// Define component name for Vue linting rules\ndefineOptions({\n  name: 'DirectIndex',\n})\n\nconst route = useRoute()\nconst router = useRouter()\nconst taskStore = useTaskStore()\nconst { toast } = useToast()\nconst messageDialog = useMessageDialogSingleton()\nconst planExecution = usePlanExecutionSingleton()\nconst conversationHistory = useConversationHistorySingleton()\n\nconst prompt = ref<string>('')\nconst rightPanelRef = ref()\nconst sidebarRef = ref()\nconst currentRootPlanId = ref<string | null>(null)\n\n// Related to panel width\n// Note: leftPanelWidth variable name is kept for backward compatibility\n// It actually controls the chat panel width (which is now on the right side)\nconst leftPanelWidth = ref(50) // Chat panel width percentage\nconst sidebarWidth = ref(80) // Sidebar width percentage\nconst isResizing = ref(false)\nconst startX = ref(0)\nconst startLeftWidth = ref(0)\n// Sidebar resize state\nconst isSidebarResizing = ref(false)\nconst startSidebarX = ref(0)\nconst startSidebarWidth = ref(0)\n\nonMounted(() => {\n  console.log('[Direct] onMounted called')\n  console.log('[Direct] taskStore.currentTask:', taskStore.currentTask)\n  console.log('[Direct] taskStore.hasUnprocessedTask():', taskStore.hasUnprocessedTask())\n\n  // Watch for plan execution record changes (reactive approach)\n  watch(\n    () => planExecution.planExecutionRecords,\n    records => {\n      // Process all records in the map\n      for (const [planId, planDetails] of records.entries()) {\n        // Only process if this is the current root plan\n        if (!shouldProcessEventForCurrentPlan(planId)) {\n          continue\n        }\n\n        // Update config/preview panel progress\n        if (\n          rightPanelRef.value &&\n          typeof rightPanelRef.value.updateDisplayedPlanProgress === 'function'\n        ) {\n          rightPanelRef.value.updateDisplayedPlanProgress(planId)\n        }\n\n        // Handle completion - only clear currentRootPlanId if this is the current plan\n        // and ALL plans are completed\n        if (planDetails.completed && planId === currentRootPlanId.value) {\n          // Check if there are any other running plans\n          const recordsArray = Array.from(records.entries())\n          const hasOtherRunningPlans = recordsArray.some(\n            ([otherPlanId, otherPlanDetails]) =>\n              otherPlanId !== planId &&\n              otherPlanDetails &&\n              !otherPlanDetails.completed &&\n              otherPlanDetails.status !== 'failed'\n          )\n\n          // Only clear currentRootPlanId if no other plans are running\n          if (!hasOtherRunningPlans) {\n            console.log('[Direct] All plans completed, clearing currentRootPlanId')\n            currentRootPlanId.value = null\n          } else {\n            console.log(\n              '[Direct] Current plan completed but other plans are still running, keeping currentRootPlanId'\n            )\n          }\n        }\n      }\n    },\n    { deep: true }\n  )\n\n  // Watch for new tracked plans to set currentRootPlanId\n  watch(\n    () => planExecution.trackedPlanIds,\n    trackedIds => {\n      // When a new plan is tracked, set it as currentRootPlanId if we don't have one\n      if (!currentRootPlanId.value && trackedIds.value.size > 0) {\n        const firstTrackedId = Array.from(trackedIds.value)[0]\n        currentRootPlanId.value = firstTrackedId\n        console.log('[Direct] Set currentRootPlanId to:', firstTrackedId)\n      }\n    },\n    { deep: true }\n  )\n\n  // Restore conversation history if conversationId exists in localStorage\n  const savedConversationId = memoryStore.getConversationId()\n  if (savedConversationId) {\n    console.log('[Direct] Found saved conversationId, restoring conversation:', savedConversationId)\n    nextTick(async () => {\n      try {\n        await conversationHistory.restoreConversationHistory(savedConversationId)\n      } catch (error) {\n        console.error('[DirectView] Failed to restore conversation history:', error)\n        // Don't show error message to user on page load, just log it\n      }\n    })\n  }\n\n  // Initialize sidebar data\n  templateStore.loadPlanTemplateList()\n\n  // Check if there is a task in the store\n  if (taskStore.hasUnprocessedTask() && taskStore.currentTask) {\n    const taskContent = taskStore.currentTask.prompt\n    console.log('[Direct] Found unprocessed task from store:', taskContent)\n\n    // Check if task content is not empty before processing\n    if (taskContent.trim()) {\n      // Mark the task as processed to prevent duplicate responses\n      taskStore.markTaskAsProcessed()\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log('[Direct] Calling messageDialog.sendMessage with taskContent:', taskContent)\n          await messageDialog.sendMessage({\n            input: taskContent,\n          })\n        } catch (error) {\n          console.warn('[Direct] messageDialog.sendMessage failed, falling back to prompt:', error)\n          prompt.value = taskContent\n        }\n      })\n    } else {\n      // Task has empty content, just mark it as processed and don't execute\n      console.log('[Direct] Task has empty content, marking as processed without execution')\n      taskStore.markTaskAsProcessed()\n    }\n  } else {\n    // Check if there is a task to input (for pre-filling input without executing)\n    // Note: InputArea automatically handles taskToInput via watch, so we don't need to clear it here\n    if (taskStore.taskToInput) {\n      console.log('[Direct] taskToInput available, InputArea will handle it automatically')\n    } else {\n      // Degrade to URL parameters (backward compatibility)\n      prompt.value = (route.query.prompt as string) || ''\n      console.log('[Direct] Received task from URL:', prompt.value)\n      console.log('[Direct] No unprocessed task in store')\n    }\n  }\n\n  // Restore panel width from localStorage\n  const savedWidth = localStorage.getItem('directPanelWidth')\n  if (savedWidth) {\n    leftPanelWidth.value = parseFloat(savedWidth)\n  }\n\n  // Restore sidebar width from localStorage\n  const savedSidebarWidth = localStorage.getItem('sidebarWidth')\n  if (savedSidebarWidth) {\n    sidebarWidth.value = parseFloat(savedSidebarWidth)\n  }\n\n  console.log('[Direct] Final prompt value:', prompt.value)\n  // Note: InputArea automatically handles taskToInput via watch\n  // Note: Plan execution is now handled directly by Sidebar.vue using messageDialog.executePlan()\n})\n\n// Listen for changes in the store's task (only handle unprocessed tasks)\nwatch(\n  () => taskStore.currentTask,\n  newTask => {\n    console.log('[Direct] Watch taskStore.currentTask triggered, newTask:', newTask)\n    if (newTask && !newTask.processed && newTask.prompt.trim()) {\n      const taskContent = newTask.prompt\n      taskStore.markTaskAsProcessed()\n      console.log('[Direct] Received new task from store:', taskContent)\n\n      // Execute task directly without showing content in input box\n      nextTick(async () => {\n        try {\n          console.log(\n            '[Direct] Directly executing new task via messageDialog.sendMessage:',\n            taskContent\n          )\n          await messageDialog.sendMessage({ input: taskContent })\n        } catch (error) {\n          console.warn('[Direct] messageDialog.sendMessage failed for new task:', error)\n        }\n      })\n    } else {\n      console.log('[Direct] Task is null, already processed, or has empty prompt - ignoring')\n    }\n  },\n  { immediate: false }\n)\n\n// Listen for changes in prompt value, only for logging purposes\nwatch(\n  () => prompt.value,\n  (newPrompt, oldPrompt) => {\n    console.log('[Direct] prompt value changed from:', oldPrompt, 'to:', newPrompt)\n    // Prompt is now only used for input field initial value, no automatic execution\n  },\n  { immediate: false }\n)\n\n// Note: taskToInput is now handled automatically by InputArea.vue\n\nonUnmounted(() => {\n  console.log('[Direct] onUnmounted called, cleaning up resources')\n\n  // Clear current root plan ID\n  currentRootPlanId.value = null\n\n  // Clean up plan execution resources\n  planExecution.cleanup()\n\n  // Remove event listeners\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.removeEventListener('mousemove', handleSidebarMouseMove)\n  document.removeEventListener('mouseup', handleSidebarMouseUp)\n})\n\n// Methods related to panel size adjustment\nconst startResize = (e: MouseEvent) => {\n  isResizing.value = true\n  startX.value = e.clientX\n  startLeftWidth.value = leftPanelWidth.value\n\n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleMouseMove = (e: MouseEvent) => {\n  if (!isResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startX.value\n  const deltaPercent = (-deltaX / containerWidth) * 100\n\n  let newWidth = startLeftWidth.value + deltaPercent\n\n  // Limit panel width between 20% and 80%\n  newWidth = Math.max(20, Math.min(80, newWidth))\n\n  leftPanelWidth.value = newWidth\n}\n\nconst handleMouseUp = () => {\n  isResizing.value = false\n  document.removeEventListener('mousemove', handleMouseMove)\n  document.removeEventListener('mouseup', handleMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('directPanelWidth', leftPanelWidth.value.toString())\n}\n\nconst resetPanelSize = () => {\n  leftPanelWidth.value = 50\n  localStorage.setItem('directPanelWidth', '50')\n}\n\n// Sidebar resize methods\nconst startSidebarResize = (e: MouseEvent) => {\n  isSidebarResizing.value = true\n  startSidebarX.value = e.clientX\n  startSidebarWidth.value = sidebarWidth.value\n\n  document.addEventListener('mousemove', handleSidebarMouseMove)\n  document.addEventListener('mouseup', handleSidebarMouseUp)\n  document.body.style.cursor = 'col-resize'\n  document.body.style.userSelect = 'none'\n\n  e.preventDefault()\n}\n\nconst handleSidebarMouseMove = (e: MouseEvent) => {\n  if (!isSidebarResizing.value) return\n\n  const containerWidth = window.innerWidth\n  const deltaX = e.clientX - startSidebarX.value\n  const deltaPercent = (deltaX / containerWidth) * 100\n\n  let newWidth = startSidebarWidth.value + deltaPercent\n\n  // Limit sidebar width between 15% and 100%\n  newWidth = Math.max(15, Math.min(100, newWidth))\n\n  sidebarWidth.value = newWidth\n}\n\nconst handleSidebarMouseUp = () => {\n  isSidebarResizing.value = false\n  document.removeEventListener('mousemove', handleSidebarMouseMove)\n  document.removeEventListener('mouseup', handleSidebarMouseUp)\n  document.body.style.cursor = ''\n  document.body.style.userSelect = ''\n\n  // Save to localStorage\n  localStorage.setItem('sidebarWidth', sidebarWidth.value.toString())\n}\n\nconst resetSidebarWidth = () => {\n  sidebarWidth.value = 80\n  localStorage.setItem('sidebarWidth', '80')\n}\n\n// Helper function to check if the event should be processed for the current plan\nconst shouldProcessEventForCurrentPlan = (\n  rootPlanId: string,\n  allowSpecialIds: boolean = false\n): boolean => {\n  // If no current plan is set, allow all events (initial state)\n  if (!currentRootPlanId.value) {\n    return true\n  }\n\n  // Check if this event is for the current active plan\n  if (rootPlanId === currentRootPlanId.value) {\n    return true\n  }\n\n  // Allow special IDs for UI state updates (error handling, etc.)\n  if (allowSpecialIds && (rootPlanId === 'ui-state' || rootPlanId === 'error')) {\n    return true\n  }\n\n  // Otherwise, ignore the event\n  console.log(\n    '[Direct] Ignoring event for non-current rootPlanId:',\n    rootPlanId,\n    'current:',\n    currentRootPlanId.value\n  )\n  return false\n}\n\nconst handleStepSelected = (stepId: string) => {\n  console.log('[DirectView] Step selected:', stepId)\n\n  // Forward step selection to config/preview panel\n  if (rightPanelRef.value && typeof rightPanelRef.value.handleStepSelected === 'function') {\n    console.log('[DirectView] Forwarding step selection to config/preview panel:', stepId)\n    rightPanelRef.value.handleStepSelected(stepId)\n  } else {\n    console.warn('[DirectView] rightPanelRef.handleStepSelected method not available')\n  }\n}\n\nconst goBack = () => {\n  router.push('/home')\n}\n\nconst handleConfig = () => {\n  router.push('/configs')\n}\n\nconst memorySelected = async () => {\n  // Memory sidebar is already closed by selectMemory() calling toggleSidebar()\n  // Load conversation history if a memory is selected\n  if (memoryStore.selectMemoryId) {\n    console.log('[DirectView] Memory selected:', memoryStore.selectMemoryId)\n    try {\n      await conversationHistory.loadConversationHistory(memoryStore.selectMemoryId, true, true)\n    } catch (error) {\n      console.error('[DirectView] Failed to load conversation history:', error)\n      // Error toast is already shown by loadConversationHistory\n    }\n  }\n}\n\nconst newChat = () => {\n  memoryStore.clearMemoryId()\n  memoryStore.clearConversationId()\n  // Reset all dialog state including conversationId to start a fresh conversation\n  messageDialog.reset()\n}\n</script>\n\n<style lang=\"less\" scoped>\n.direct-page {\n  width: 100%;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  overflow: hidden;\n}\n\n.branding-header {\n  width: 100%;\n  padding: 4px 12px;\n  background: rgba(255, 255, 255, 0.02);\n  border-bottom: 1px solid #1a1a1a;\n  flex-shrink: 0;\n  z-index: 200;\n}\n\n.branding-content {\n  max-width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.branding-logo {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n\n  .java-logo {\n    width: 32px;\n    height: 32px;\n    object-fit: contain;\n  }\n\n  h1 {\n    margin: 0;\n    font-size: 20px;\n    font-weight: 600;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n    letter-spacing: 0.5px;\n  }\n}\n\n.branding-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.direct-chat {\n  height: calc(100vh - 65px); /* Subtract branding header height */\n  width: 100%;\n  background: #0a0a0a;\n  display: flex;\n  flex: 1;\n}\n\n.left-panel {\n  position: relative;\n  border-right: none; /* Remove the original border, which will be provided by the resizer */\n  display: flex;\n  flex-direction: column;\n  height: 100%; /* Fit within parent container */\n  overflow: hidden; /* Prevent panel itself overflow */\n  transition: width 0.1s ease; /* Smooth transition */\n}\n\n.panel-resizer {\n  width: 6px;\n  height: 100%; /* Fit within parent container */\n  background: #1a1a1a;\n  cursor: col-resize;\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background-color 0.2s ease;\n  flex-shrink: 0;\n\n  &:hover {\n    background: #2a2a2a;\n\n    .resizer-line {\n      background: #4a90e2;\n      width: 2px;\n    }\n  }\n\n  &:active {\n    background: #3a3a3a;\n  }\n}\n\n.resizer-line {\n  width: 1px;\n  height: 40px;\n  background: #3a3a3a;\n  border-radius: 1px;\n  transition: all 0.2s ease;\n}\n\n/* Adjust config/preview panel styles */\n:deep(.right-panel) {\n  transition: width 0.1s ease;\n}\n\n.chat-header {\n  padding: 12px 10px;\n  border-bottom: 1px solid #1a1a1a;\n  display: flex;\n  align-items: center;\n  gap: 16px;\n  background: rgba(255, 255, 255, 0.02);\n  flex-shrink: 0; /* Ensure the header will not be compressed */\n  position: sticky; /* Fix the header at the top */\n  top: 0;\n  z-index: 100;\n\n  h2 {\n    flex: 1;\n    margin: 0;\n    font-size: 18px;\n    font-weight: 600;\n    color: #ffffff;\n  }\n}\n\n.chat-content {\n  flex: 1; /* Occupy remaining space */\n  display: flex;\n  flex-direction: column;\n  min-height: 0; /* Allow shrink */\n  overflow: hidden; /* Prevent overflow */\n}\n\n.header-actions {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.back-button {\n  padding: 8px 12px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  font-size: 14px;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.config-button {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.cron-task-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  background: rgba(255, 255, 255, 0.05);\n  color: #ffffff;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: rgba(255, 255, 255, 0.1);\n    border-color: rgba(255, 255, 255, 0.2);\n  }\n}\n\n.loading-prompt {\n  flex: 1;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #888888;\n  font-size: 16px;\n  padding: 50px;\n}\n\n/* Message toast styles */\n.message-toast {\n  position: fixed;\n  top: 80px;\n  right: 24px;\n  z-index: 9999;\n  min-width: 320px;\n  max-width: 480px;\n  padding: 16px 20px;\n  border-radius: 8px;\n  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  animation: slideInRight 0.3s ease-out;\n  font-size: 14px;\n  font-weight: 500;\n}\n\n.message-toast.error {\n  color: #fff2f0;\n  background-color: #ff4d4f;\n}\n\n.message-content {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  flex: 1;\n  word-break: break-all;\n}\n\n.message-content i {\n  font-size: 16px;\n}\n</style>\n"],"names":["props","__props","emit","__emit","t","useI18n","getNestingClass","getSubPlanStatusClass","agent","getSubPlanStatusText","getSubPlanStatusIcon","getSubPlanProgress","completedCount","getSubPlanCompletedCount","getAgentPreviewStatusClass","status","getAgentPreviewStatusIcon","getAgentStatusText","hasNestedSubPlans","step","getNestedSubPlans","handleSubPlanClick","handleSubPlanAgentClick","agentIndex","stepId","handleThinkActStepClick","_stepIndex","handleNestedSubPlanSelected","subPlanIndex","subPlan","handleNestedStepSelected","_createElementBlock","_normalizeClass","_createElementVNode","_hoisted_1","_createVNode","_unref","Icon","_hoisted_2","_hoisted_3","$t","_toDisplayString","nestingLevel","_openBlock","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_Fragment","$event","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_renderList","maxVisibleSteps","stepIndex","_hoisted_34","_hoisted_35","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_40","_hoisted_41","nestedStep","nestedStepIndex","_createBlock","_component_RecursiveSubPlan","maxNestingDepth","_hoisted_42","_hoisted_43","_hoisted_44","_hoisted_45","directSubPlan","directIndex","handleAgentClick","agentExecution","getAgentStatusClass","getAgentStatusIcon","handleStepSelected","formatToolParameters","parameters","parsed","planExecution","_hoisted_17","RecursiveSubPlan","useMessageFormatting","text","timestamp","diff","error","message","computed","bytes","k","sizes","i","maxLength","html","CommonApiService","planId","response","errorText","rawText","data","formData","errorData","contentType","formInputsStore","reactive","genericInput","ref","isInitialized","initializationTimeout","initializeFormInputs","formInputs","input","index","onMounted","watch","handleUserInputSubmit","inputData","value","numIndex","label","getOptionsArray","options","opt","isRequired","required","onUnmounted","userInputWaitState","inputIndex","_vModelText","option","_vModelSelect","_vModelCheckbox","_vModelRadio","formatResponseText","formatTimestamp","copyToClipboard","plainText","handleRegenerate","handleRetry","handleUserInputSubmitted","UserInputForm","_mergeProps","content","isStreaming","usePlanExecution","trackedPlanIds","completedPlansPollCount","planPollAttempts","planRetryAttempts","planExecutionRecords","isPolling","pollTimer","getPlanExecutionRecord","setCachedPlanRecord","record","getTrackedPlanIds","trackPlan","startPolling","pollPlanStatus","untrackPlan","stopPolling","details","retryCount","currentAttempts","recordKey","taskStore","useTaskStore","hasSummary","currentPollCount","errorMessage","err","pollAllTrackedPlans","plansToPoll","pollPromises","pollPlanStatusImmediately","handlePlanExecutionRequested","cleanup","readonly","singletonInstance","usePlanExecutionSingleton","useMessageDialog","dialogList","activeDialogId","conversationId","rootPlanId","activeRootPlanId","isLoading","streamingMessageId","inputPlaceholder","activeDialog","dialog","hasDialogs","dialogCount","messages","allMessages","a","b","createDialog","title","getDialog","dialogId","setActiveDialog","d","addMessageToDialog","updateMessageInDialog","messageId","updates","messageIndex","m","deleteDialog","deletedDialog","sameConversationDialogs","deleteConversationRoundByPlanId","dialogsToDelete","deleteConversation","convId","clearAllDialogs","sendMessage","query","targetDialog","assistantMessage","errorMsg","userMessage","file","extendedQuery","DirectApiService","memoryStore","newRootPlanId","executePlan","payload","existingConversationId","planTemplateId","PlanActApiService","newConversationId","currentConversationId","updatePlanExecutionStatus","convertPlanExecutionRecord","converted","convertAgentExecutionRecord","addMessage","type","processedOptions","updateMessage","processedUpdates","findMessage","startStreaming","stopStreaming","clearMessages","updateInputState","enabled","placeholder","setConversationId","id","reset","updateMessageWithPlanRecord","finalResponse","watchEffect","records","recordsSize","recordsArray","dialogs","recordEntry","recordValue","messagePlanExecution","key","readonlyRecord","hasTrackedPlans","hasRunningPlansInRecords","useMessageDialogSingleton","useScrollBehavior","containerRef","showScrollToBottom","isAutoScrollEnabled","scrollThreshold","scrollToBottom","smooth","nextTick","isNearBottom","scrollTop","scrollHeight","clientHeight","checkScrollPosition","nearBottom","handleScroll","autoScrollToBottom","forceScrollToBottom","scrollToMessage","messageElement","getScrollInfo","isAtTop","isAtBottom","scrollPercentage","addScrollListener","removeScrollListener","initializeScrollBehavior","cleanupScrollBehavior","messageDialog","messagesRef","getMessageClasses","formatFileSize","isMessageStreaming","compatibleMessages","handleMessageContainerClick","event","target","handleCopyMessage","handleRegenerateMessage","handleRetryMessage","attachment","ExecutionDetails","ResponseSection","_Transition","FileUploadApiService","files","result","uploadKey","fileName","fileInputRef","uploadedFiles","isUploading","resetSession","newFiles","handleFileUpload","handleFileChange","fileArray","f","uploadFiles","removeFile","fileToRemove","__expose","acceptedFileTypes","HISTORY_STORAGE_KEY","MAX_HISTORY_SIZE","templateConfig","usePlanTemplateConfigSingleton","isTaskRunning","inputRef","fileUploadRef","currentInput","defaultPlaceholder","fileUploadPlaceholder","currentPlaceholder","selectedOption","innerToolOptions","isLoadingTools","isRestoringSelection","inputHistory","historyIndex","originalInputBeforeHistory","isMac","loadInnerTools","allTools","filteredTools","tool","inputSchema","param","e","savedTool","selectionOptions","newValue","loadHistory","stored","saveHistory","saveToHistory","navigateHistory","direction","newIndex","adjustInputHeight","planDetails","newTaskToInput","setInputValue","handleFilesUploaded","handleFilesRemoved","handleUploadKeyChanged","handleUploadStarted","handleUploadCompleted","handleUploadError","isDisabled","handleKeydown","handleSend","historyModifier","finalInput","selectedTool","clearInput","handleStop","updateState","getQuery","FileUploadComponent","_createTextVNode","MemoryApiService","memoryName","showTitleEdit","searchQuery","filteredMessages","showNameModal","currentEditMessageId","nameInput","showDeleteModal","currentDeleteId","expandedMap","handleEscKey","closeDeleteModal","closeNameModal","loadMessages","mes","mesMsg","handleSearch","selectMemory","timestampNum","matchesName","matchesId","matchesContent","bubble","saveName","newName","msg","currentMessage","returnMemory","toggleMessage","filteredIndex","showDeleteConfirm","confirmDelete","_Teleport","_cache","_withModifiers","idx","_hoisted_33","FileBrowserApiService","apiResponse","filePath","blob","url","mimeType","textMimeTypes","textExtensions","lowerFileName","ext","node","isExpanded","showActions","showContextMenu","contextMenuStyle","toggleExpanded","handleClick","handleFileSelect","hideContextMenu","handleDownload","handleRightClick","copyPath","getNodeIcon","level","$emit","child","_component_FileTreeNode","loading","fileTree","selectedFile","fileContent","loadingContent","contentError","autoRefreshTimer","isTextFile","isPlanDirectoryNotFound","clearAutoRefresh","startAutoRefresh","refreshFileTree","handleFileSelected","handleDownloadFile","closeFileViewer","getFileIcon","newPlanId","FileTreeNode","PlanParameterApiService","ToolApiService","useAvailableTools","availableTools","tools","useAvailableToolsSingleton","availableToolsStore","showModal","success","publishing","deleting","publishAsHttpService","publishAsInternalToolcall","parameterRequirements","isLoadingParameters","modalTitle","hasToolConfig","isSaved","initializeFormData","toolConfig","loadParameterRequirements","requirements","existingParamsMap","mergeParametersWithBackend","backendInputSchema","backendParamsMap","merged","paramName","description","p","showMessage","validateForm","handlePublish","mergedParameters","enabledServices","handleDelete","newId","oldId","Modal","isSaving","handleCancel","handleSave","handleContinueWithoutSave","modelValue","toast","useToast","executionParams","showPublishMcpModal","parameterValues","activeTab","parameterErrors","isValidationError","isExecutingPlan","lastPlanId","showPublishButton","showSaveDialog","pendingExecutionPayload","apiTabs","toolName","serviceGroup","replacementParams","detailsPlanId","isAnyServiceEnabled","buttonText","canExecute","handleExecutePlan","templateStore","validateParameters","proceedWithExecution","config","planData","finalPayload","clearExecutionParams","handleSaveAndExecute","validation","versionCount","resolve","refreshParameterRequirements","handleContinueExecution","handlePublishMcpService","s","newValues","updateExecutionParamsFromParameters","updateParameterValue","hasErrors","oldValue","tab","_hoisted_46","_hoisted_47","_hoisted_48","_hoisted_49","_hoisted_50","SaveConfirmationDialog","PublishServiceModal","bind","fn","thisArg","toString","getPrototypeOf","iterator","toStringTag","kindOf","cache","thing","str","kindOfTest","typeOfTest","isArray","isUndefined","isBuffer","val","isFunction","isArrayBuffer","isArrayBufferView","isString","isNumber","isObject","isBoolean","isPlainObject","prototype","isEmptyObject","isDate","isFile","isBlob","isFileList","isStream","isFormData","kind","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","trim","forEach","obj","allOwnKeys","l","keys","len","findKey","_key","_global","isContextDefined","context","merge","caseless","skipUndefined","assignValue","targetKey","extend","stripBOM","inherits","constructor","superConstructor","descriptors","toFlatObject","sourceObj","destObj","filter","propFilter","prop","endsWith","searchString","position","lastIndex","toArray","arr","isTypedArray","TypedArray","forEachEntry","_iterator","pair","matchAll","regExp","matches","isHTMLForm","toCamelCase","p1","p2","hasOwnProperty","isRegExp","reduceDescriptors","reducer","reducedDescriptors","descriptor","name","ret","freezeMethods","toObjectSet","arrayOrString","delimiter","define","noop","toFiniteNumber","defaultValue","isSpecCompliantForm","toJSONObject","stack","visit","source","reducedValue","isAsyncFn","isThenable","_setImmediate","setImmediateSupported","postMessageSupported","token","callbacks","cb","asap","isIterable","utils$1","AxiosError","code","request","utils","customProps","axiosError","errCode","httpAdapter","isVisitable","removeBrackets","renderKey","path","dots","isFlatArray","predicates","toFormData","metaTokens","visitor","defaultVisitor","indexes","useBlob","convertValue","el","exposedHelpers","build","encode","charMap","match","AxiosURLSearchParams","params","encoder","_encode","buildURL","serializeFn","serializedParams","hashmarkIndex","InterceptorManager","fulfilled","rejected","h","transitionalDefaults","URLSearchParams$1","FormData$1","Blob$1","platform$1","URLSearchParams","FormData","Blob","hasBrowserEnv","_navigator","hasStandardBrowserEnv","hasStandardBrowserWebWorkerEnv","origin","platform","toURLEncodedForm","helpers","parsePropPath","arrayToObject","formDataToJSON","buildPath","isNumericKey","isLast","stringifySafely","rawValue","parser","defaults","headers","hasJSONContentType","isObjectPayload","_FormData","transitional","forcedJSONParsing","JSONRequested","strictJSONParsing","method","ignoreDuplicateOf","parseHeaders","rawHeaders","line","$internals","normalizeHeader","header","normalizeValue","parseTokens","tokens","tokensRE","isValidHeaderName","matchHeaderValue","isHeaderNameFilter","formatHeader","w","char","buildAccessors","accessorName","methodName","arg1","arg2","arg3","AxiosHeaders$1","valueOrRewrite","rewrite","self","setHeader","_value","_header","_rewrite","lHeader","setHeaders","dest","entry","matcher","deleted","deleteHeader","format","normalized","targets","asStrings","first","accessors","defineAccessor","AxiosHeaders","mapped","headerValue","transformData","fns","isCancel","CanceledError","settle","reject","validateStatus","parseProtocol","speedometer","samplesCount","min","timestamps","head","tail","firstSampleTS","chunkLength","now","startedAt","bytesCount","passed","throttle","freq","threshold","lastArgs","timer","invoke","args","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","loaded","total","progressBytes","rate","inRange","progressEventDecorator","throttled","lengthComputable","asyncDecorator","isURLSameOrigin","isMSIE","cookies","expires","domain","secure","sameSite","cookie","isAbsoluteURL","combineURLs","baseURL","relativeURL","buildFullPath","requestedURL","allowAbsoluteUrls","isRelativeUrl","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","configValue","resolveConfig","newConfig","withXSRFToken","xsrfHeaderName","xsrfCookieName","auth","formHeaders","allowedHeaders","xsrfValue","isXHRAdapterSupported","xhrAdapter","_config","requestData","requestHeaders","responseType","onUploadProgress","onDownloadProgress","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","done","onloadend","responseHeaders","timeoutErrorMessage","cancel","protocol","composeSignals","signals","timeout","length","controller","aborted","onabort","reason","unsubscribe","signal","streamChunk","chunk","chunkSize","pos","end","readBytes","iterable","readStream","stream","reader","trackStream","onProgress","onFinish","_onFinish","loadedBytes","DEFAULT_CHUNK_SIZE","globalFetchAPI","Request","Response","ReadableStream","TextEncoder","test","factory","env","envFetch","isFetchSupported","isRequestSupported","isResponseSupported","isReadableStreamSupported","encodeText","supportsRequestStream","duplexAccessed","hasContentType","supportsResponseStream","resolvers","res","getBodyLength","body","resolveBodyLength","cancelToken","withCredentials","fetchOptions","_fetch","composedSignal","requestContentLength","_request","contentTypeHeader","flush","isCredentialsSupported","resolvedOptions","isStreamResponse","responseContentLength","responseData","seedCache","getFetch","fetch","seeds","seed","map","knownAdapters","fetchAdapter.getFetch","renderReason","isResolvedHandle","adapter","getAdapter","adapters","nameOrAdapter","rejectedReasons","reasons","state","throwIfCancellationRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","version","formatMessage","desc","opts","correctSpelling","assertOptions","schema","allowUnknown","Axios$1","instanceConfig","configOrUrl","dummy","paramsSerializer","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","responseInterceptorChain","promise","chain","onFulfilled","onRejected","fullPath","Axios","generateHTTPMethod","isForm","CancelToken$1","CancelToken","executor","resolvePromise","onfulfilled","_resolve","abort","c","spread","callback","isAxiosError","HttpStatusCode","createInstance","defaultConfig","instance","axios","promises","all","Cancel","formToJSON","ConfigApiService","filteredSelectedToolIds","toolId","newFilteredTools","selectedLength","getToolDisplayNameWithGroup","getToolDescription","showAddButton","addButtonText","useGridLayout","emptyText","isVisible","visible","sortBy","collapsedGroups","selectedTools","collapsedGroupsBeforeSearch","updateGroupCheckboxState","groupName","checkbox","isGroupPartiallySelected","newIds","filtered","aSelected","bSelected","groupA","groupB","allGroupedTools","groups","groupedTools","totalTools","isToolSelected","toolKey","toggleToolSelection","isChecked","getSelectedToolsInGroup","isGroupFullySelected","selectedCount","toggleGroupSelection","toolKeys","newSelected","toggleGroupCollapse","handleConfirm","newQuery","newVisible","groupNames","displayData","showJsonPreview","showGroupSuggestions","availableServiceGroups","isLoadingGroups","generatedJsonOutput","isSyncingFromConfig","editingTimeout","setEditingFlag","syncDisplayDataFromConfig","syncDisplayDataToTemplateConfig","toggleJsonPreview","closeJsonPreview","handleRollback","handleRestore","titleError","handleStepRequirementInput","autoResizeTextarea","handleTerminateColumnsInput","handleAddStep","newStep","availableModels","isLoadingModels","modelsLoadError","modelSearchFilters","openDropdownSteps","highlightedIndices","getSearchFilter","setSearchFilter","getFilteredModelsForStep","searchTerm","model","getModelDisplayValue","getModelPlaceholder","isModelDropdownOpenForStep","openModelDropdown","closeModelDropdown","toggleModelDropdown","selectModelForStep","modelName","handleModelSearchInput","getHighlightedIndex","setHighlightedIndex","selectFirstFilteredModel","highlightedIndex","navigateModelDown","totalItems","currentIndex","navigateModelUp","handleClickOutside","newSteps","showToolModal","currentStepIndex","loadAvailableModels","showToolSelectionModal","handleToolSelectionConfirm","selectedToolIds","handleToolsFiltered","showCopyPlanModal","newPlanTitle","isCopyingPlan","handleCopyPlan","closeCopyPlanModal","handleModalOverlayClick","confirmCopyPlan","currentConfig","newPlanTemplateId","_toolConfig","configWithoutToolConfig","newPlanConfig","PlanTemplateApiService","newTitle","loadServiceGroup","group","newGroup","loadAvailableServiceGroups","groupsSet","template","filteredServiceGroups","trimmedGroup","handleTitleInput","handleServiceGroupInput","handleServiceGroupInputWithEditing","handleServiceGroupBlur","selectServiceGroup","textarea","lineHeight","lines","minRows","maxRows","targetRows","newHeight","formatTableHeader","terminateColumns","columns","col","_withKeys","AssignedTools","isGenerating","isExecuting","ToolSelectionModal","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_60","API_BASE_URL","fetchAgentExecutionDetail","refreshAgentExecutionDetail","useRightPanel","selectedStep","selectedRootPlanId","currentRootPlanId","findRootPlanIdForStep","subRootPlanId","findRootPlanIdInSubPlan","nestedSubPlan","fileBrowserPlanId","shouldShowNoTaskMessage","setActiveTab","agentExecutionDetail","stepData","refreshCurrentStep","updateDisplayedPlanProgress","clearSelectedStep","formatJson","jsonData","trimmed","useRightPanelSingleton","rightPanel","handleImportPlanTemplate","usePlanTemplateImport","scrollContainer","showScrollToBottomButton","shouldAutoScrollToBottom","stepStatusText","handleCreateNewPlan","planType","newTemplate","handleImportExistingPlan","successMsg","checkScrollState","autoScrollToBottomIfNeeded","newStepId","setScrollContainer","element","hasScrollableContent","initScrollListener","setupScrollListener","sidebarStore","JsonEditorV2","ExecutionController","tas","actToolInfo","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_59","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_65","_hoisted_66","_hoisted_67","_hoisted_68","_hoisted_69","_hoisted_70","_hoisted_71","_hoisted_72","_hoisted_73","_hoisted_74","_hoisted_75","_hoisted_76","_hoisted_77","_hoisted_78","_hoisted_79","_hoisted_80","_hoisted_81","_hoisted_82","_hoisted_83","_hoisted_85","FileBrowser","_hoisted_86","_hoisted_87","_hoisted_88","searchKeyword","showDeleteConfirmModal","templateToDelete","handleOrganizationChange","getRelativeTimeString","date","diffMs","diffMinutes","diffHours","diffDays","filteredGroupedTemplates","keyword","grouped","templates","matchingTemplates","newKeyword","hasMatch","getGroupCollapseState","handleToggleGroupCollapse","handleSelectTemplate","handleDeleteTemplate","cancelDelete","handleCreateNewTemplate","_normalizeStyle","TemplateList","useConversationHistory","showToast","convertApiRecordToPlanExecutionRecord","planExecutionRecord","parseBackendDate","dateValue","year","month","day","hour","minute","second","nanosecond","isoMatch","millis","processHistoryRecord","dialogTitle","historyDialog","parsedDate","assistantContent","loadConversationHistory","showErrorToast","historyRecords","firstRecord","useConversationHistorySingleton","route","useRoute","router","useRouter","conversationHistory","prompt","rightPanelRef","sidebarRef","leftPanelWidth","sidebarWidth","isResizing","startX","startLeftWidth","isSidebarResizing","startSidebarX","startSidebarWidth","shouldProcessEventForCurrentPlan","otherPlanId","otherPlanDetails","trackedIds","firstTrackedId","savedConversationId","taskContent","savedWidth","savedSidebarWidth","newTask","newPrompt","oldPrompt","handleMouseMove","handleMouseUp","handleSidebarMouseMove","handleSidebarMouseUp","startResize","containerWidth","deltaPercent","newWidth","resetPanelSize","startSidebarResize","resetSidebarWidth","allowSpecialIds","goBack","handleConfig","memorySelected","newChat","_imports_0","LanguageSwitcher","Sidebar","RightPanel","ChatContainer","InputArea","$i18n","Memory"],"mappings":"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","x_google_ignoreList":[24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73]}